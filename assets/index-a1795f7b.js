var e=Object.defineProperty,t=(t,s,a)=>(((t,s,a)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a})(t,"symbol"!=typeof s?s+"":s,a),a);import{r as s,a,R as n,b as r,c as i}from"./react-vendor-132e4a4f.js";import{g as o,G as l,s as c,a as d,b as h,c as u,o as m}from"./firebase-auth-7a9d2df2.js";import{T as p,r as x,_ as g,C as f,c as b,E as y,F as v,U as w,b as j,e as N,k as S,m as k,f as C,V as E,W as P,X as I,Y as T}from"./firebase-core-a7cb50f5.js";import{g as A,s as M,d as D,a as R,u as _,b as L,c as O,q as $,w as U,e as z,f as F,h as W,o as H}from"./firebase-firestore-e3da4556.js";import{g as Y,r as G,s as B,o as q,a as J,p as V,u as K,b as Q}from"./firebase-database-b022e4c6.js";import{S as X,A as Z,T as ee,U as te,C as se,a as ae,b as ne,c as re,d as ie,e as oe,R as le,H as ce,f as de,X as he,Z as ue,g as me,F as pe,M as xe,h as ge,i as fe,B as be,j as ye,k as ve,l as we,m as je,G as Ne,n as Se,o as ke,p as Ce,P as Ee,q as Pe,r as Ie,s as Te,t as Ae,u as Me,v as De,w as Re,L as _e,x as Le,y as Oe,z as $e,D as Ue,E as ze,I as Fe,J as We,K as He,N as Ye,O as Ge,Q as Be,V as qe,W as Je}from"./ui-vendor-c80f9872.js";import{getFunctions as Ve,httpsCallable as Ke}from"./firebase-functions-7c25f05b.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Qe={exports:{}},Xe={},Ze=s,et=Symbol.for("react.element"),tt=Symbol.for("react.fragment"),st=Object.prototype.hasOwnProperty,at=Ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nt={key:!0,ref:!0,__self:!0,__source:!0};function rt(e,t,s){var a,n={},r=null,i=null;for(a in void 0!==s&&(r=""+s),void 0!==t.key&&(r=""+t.key),void 0!==t.ref&&(i=t.ref),t)st.call(t,a)&&!nt.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===n[a]&&(n[a]=t[a]);return{$$typeof:et,type:e,key:r,ref:i,props:n,_owner:at.current}}Xe.Fragment=tt,Xe.jsx=rt,Xe.jsxs=rt,Qe.exports=Xe;var it=Qe.exports,ot={},lt=a;ot.createRoot=lt.createRoot,ot.hydrateRoot=lt.hydrateRoot;const ct={},dt=function(e,t,s){if(!t||0===t.length)return e();const a=document.getElementsByTagName("link");return Promise.all(t.map(e=>{if((e=function(e){return"/"+e}(e))in ct)return;ct[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(s)for(let s=a.length-1;s>=0;s--){const n=a[s];if(n.href===e&&(!t||"stylesheet"===n.rel))return}else if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),t?new Promise((t,s)=>{r.addEventListener("load",t),r.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e})};var ht={};Object.defineProperty(ht,"__esModule",{value:!0}),ht.parse=function(e,t){const s=new ft,a=e.length;if(a<2)return s;const n=(null==t?void 0:t.decode)||vt;let r=0;do{const t=e.indexOf("=",r);if(-1===t)break;const i=e.indexOf(";",r),o=-1===i?a:i;if(t>o){r=e.lastIndexOf(";",t-1)+1;continue}const l=bt(e,r,t),c=yt(e,t,l),d=e.slice(l,c);if(void 0===s[d]){let a=bt(e,t+1,o),r=yt(e,o,a);const i=n(e.slice(a,r));s[d]=i}r=o+1}while(r<a);return s},ht.serialize=function(e,t,s){const a=(null==s?void 0:s.encode)||encodeURIComponent;if(!ut.test(e))throw new TypeError(`argument name is invalid: ${e}`);const n=a(t);if(!mt.test(n))throw new TypeError(`argument val is invalid: ${t}`);let r=e+"="+n;if(!s)return r;if(void 0!==s.maxAge){if(!Number.isInteger(s.maxAge))throw new TypeError(`option maxAge is invalid: ${s.maxAge}`);r+="; Max-Age="+s.maxAge}if(s.domain){if(!pt.test(s.domain))throw new TypeError(`option domain is invalid: ${s.domain}`);r+="; Domain="+s.domain}if(s.path){if(!xt.test(s.path))throw new TypeError(`option path is invalid: ${s.path}`);r+="; Path="+s.path}if(s.expires){if(!function(e){return"[object Date]"===gt.call(e)}(s.expires)||!Number.isFinite(s.expires.valueOf()))throw new TypeError(`option expires is invalid: ${s.expires}`);r+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(r+="; HttpOnly"),s.secure&&(r+="; Secure"),s.partitioned&&(r+="; Partitioned"),s.priority)switch("string"==typeof s.priority?s.priority.toLowerCase():void 0){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${s.priority}`)}if(s.sameSite)switch("string"==typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:case"strict":r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"none":r+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${s.sameSite}`)}return r};const ut=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,mt=/^[\u0021-\u003A\u003C-\u007E]*$/,pt=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,xt=/^[\u0020-\u003A\u003D-\u007E]*$/,gt=Object.prototype.toString,ft=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function bt(e,t,s){do{const s=e.charCodeAt(t);if(32!==s&&9!==s)return t}while(++t<s);return s}function yt(e,t,s){for(;t>s;){const s=e.charCodeAt(--t);if(32!==s&&9!==s)return t+1}return s}function vt(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}var wt="popstate";function jt(e,t){if(!1===e||null==e)throw new Error(t)}function Nt(e,t){if(!e)try{throw new Error(t)}catch(s){}}function St(e,t){return{usr:e.state,key:e.key,idx:t}}function kt(e,t,s=null,a){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?Et(t):t,state:s,key:t&&t.key||a||Math.random().toString(36).substring(2,10)}}function Ct({pathname:e="/",search:t="",hash:s=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),s&&"#"!==s&&(e+="#"===s.charAt(0)?s:"#"+s),e}function Et(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substring(s),e=e.substring(0,s));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function Pt(e,t,s="/"){return function(e,t,s){let a=Wt(("string"==typeof t?Et(t):t).pathname||"/",s);if(null==a)return null;let n=It(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every((e,s)=>e===t[s])?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(n);let r=null;for(let i=0;null==r&&i<n.length;++i){let e=Ft(a);r=Ut(n[i],e,false)}return r}(e,t,s)}function It(e,t=[],s=[],a=""){let n=(e,n,r)=>{let i={relativePath:void 0===r?e.path||"":r,caseSensitive:!0===e.caseSensitive,childrenIndex:n,route:e};i.relativePath.startsWith("/")&&(jt(i.relativePath.startsWith(a),`Absolute route path "${i.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),i.relativePath=i.relativePath.slice(a.length));let o=Bt([a,i.relativePath]),l=s.concat(i);e.children&&e.children.length>0&&(jt(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${o}".`),It(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:$t(o,e.index),routesMeta:l})};return e.forEach((e,t)=>{var s;if(""!==e.path&&(null==(s=e.path)?void 0:s.includes("?")))for(let a of Tt(e.path))n(e,t,a);else n(e,t)}),t}function Tt(e){let t=e.split("/");if(0===t.length)return[];let[s,...a]=t,n=s.endsWith("?"),r=s.replace(/\?$/,"");if(0===a.length)return n?[r,""]:[r];let i=Tt(a.join("/")),o=[];return o.push(...i.map(e=>""===e?r:[r,e].join("/"))),n&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var At=/^:[\w-]+$/,Mt=3,Dt=2,Rt=1,_t=10,Lt=-2,Ot=e=>"*"===e;function $t(e,t){let s=e.split("/"),a=s.length;return s.some(Ot)&&(a+=Lt),t&&(a+=Dt),s.filter(e=>!Ot(e)).reduce((e,t)=>e+(At.test(t)?Mt:""===t?Rt:_t),a)}function Ut(e,t,s=!1){let{routesMeta:a}=e,n={},r="/",i=[];for(let o=0;o<a.length;++o){let e=a[o],l=o===a.length-1,c="/"===r?t:t.slice(r.length)||"/",d=zt({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!d&&l&&s&&!a[a.length-1].route.index&&(d=zt({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(n,d.params),i.push({params:n,pathname:Bt([r,d.pathname]),pathnameBase:qt(Bt([r,d.pathnameBase])),route:h}),"/"!==d.pathnameBase&&(r=Bt([r,d.pathnameBase]))}return i}function zt(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,a]=function(e,t=!1,s=!0){Nt("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,s)=>(a.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),n+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?n+="\\/*$":""!==e&&"/"!==e&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),a]}(e.path,e.caseSensitive,e.end),n=t.match(s);if(!n)return null;let r=n[0],i=r.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:a.reduce((e,{paramName:t,isOptional:s},a)=>{if("*"===t){let e=o[a]||"";i=r.slice(0,r.length-e.length).replace(/(.)\/+$/,"$1")}const n=o[a];return e[t]=s&&!n?void 0:(n||"").replace(/%2F/g,"/"),e},{}),pathname:r,pathnameBase:i,pattern:e}}function Ft(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return Nt(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Wt(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,a=e.charAt(s);return a&&"/"!==a?null:e.slice(s)||"/"}function Ht(e,t,s,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Yt(e){let t=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t.map((e,s)=>s===t.length-1?e.pathname:e.pathnameBase)}function Gt(e,t,s,a=!1){let n;"string"==typeof e?n=Et(e):(n={...e},jt(!n.pathname||!n.pathname.includes("?"),Ht("?","pathname","search",n)),jt(!n.pathname||!n.pathname.includes("#"),Ht("#","pathname","hash",n)),jt(!n.search||!n.search.includes("#"),Ht("#","search","hash",n)));let r,i=""===e||""===n.pathname,o=i?"/":n.pathname;if(null==o)r=s;else{let e=t.length-1;if(!a&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}r=e>=0?t[e]:"/"}let l=function(e,t="/"){let{pathname:s,search:a="",hash:n=""}="string"==typeof e?Et(e):e,r=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)}),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:r,search:Jt(a),hash:Vt(n)}}(n,r),c=o&&"/"!==o&&o.endsWith("/"),d=(i||"."===o)&&s.endsWith("/");return l.pathname.endsWith("/")||!c&&!d||(l.pathname+="/"),l}var Bt=e=>e.join("/").replace(/\/\/+/g,"/"),qt=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Jt=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Vt=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"",Kt=["POST","PUT","PATCH","DELETE"];new Set(Kt);var Qt=["GET",...Kt];new Set(Qt);var Xt=s.createContext(null);Xt.displayName="DataRouter";var Zt=s.createContext(null);Zt.displayName="DataRouterState";var es=s.createContext({isTransitioning:!1});es.displayName="ViewTransition",s.createContext(new Map).displayName="Fetchers",s.createContext(null).displayName="Await";var ts=s.createContext(null);ts.displayName="Navigation";var ss=s.createContext(null);ss.displayName="Location";var as=s.createContext({outlet:null,matches:[],isDataRoute:!1});as.displayName="Route";var ns=s.createContext(null);function rs(){return null!=s.useContext(ss)}function is(){return jt(rs(),"useLocation() may be used only in the context of a <Router> component."),s.useContext(ss).location}ns.displayName="RouteError";var os="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ls(e){s.useContext(ts).static||s.useLayoutEffect(e)}function cs(){let{isDataRoute:e}=s.useContext(as);return e?function(){let{router:e}=function(){let e=s.useContext(Xt);return jt(e,gs("useNavigate")),e}(),t=fs("useNavigate"),a=s.useRef(!1);return ls(()=>{a.current=!0}),s.useCallback(async(s,n={})=>{Nt(a.current,os),a.current&&("number"==typeof s?e.navigate(s):await e.navigate(s,{fromRouteId:t,...n}))},[e,t])}():function(){jt(rs(),"useNavigate() may be used only in the context of a <Router> component.");let e=s.useContext(Xt),{basename:t,navigator:a}=s.useContext(ts),{matches:n}=s.useContext(as),{pathname:r}=is(),i=JSON.stringify(Yt(n)),o=s.useRef(!1);return ls(()=>{o.current=!0}),s.useCallback((s,n={})=>{if(Nt(o.current,os),!o.current)return;if("number"==typeof s)return void a.go(s);let l=Gt(s,JSON.parse(i),r,"path"===n.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:Bt([t,l.pathname])),(n.replace?a.replace:a.push)(l,n.state,n)},[t,a,i,r,e])}()}function ds(e,{relative:t}={}){let{matches:a}=s.useContext(as),{pathname:n}=is(),r=JSON.stringify(Yt(a));return s.useMemo(()=>Gt(e,JSON.parse(r),n,"path"===t),[e,r,n,t])}function hs(e,t,a,n){var r;jt(rs(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=s.useContext(ts),{matches:o}=s.useContext(as),l=o[o.length-1],c=l?l.params:{},d=l?l.pathname:"/",h=l?l.pathnameBase:"/",u=l&&l.route;{let e=u&&u.path||"";ys(d,!u||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let m,p=is();if(t){let e="string"==typeof t?Et(t):t;jt("/"===h||(null==(r=e.pathname)?void 0:r.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${e.pathname}" was given in the \`location\` prop.`),m=e}else m=p;let x=m.pathname||"/",g=x;if("/"!==h){let e=h.replace(/^\//,"").split("/");g="/"+x.replace(/^\//,"").split("/").slice(e.length).join("/")}let f=Pt(e,{pathname:g});Nt(u||null!=f,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),Nt(null==f||void 0!==f[f.length-1].route.element||void 0!==f[f.length-1].route.Component||void 0!==f[f.length-1].route.lazy,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=function(e,t=[],a=null){if(null==e){if(!a)return null;if(a.errors)e=a.matches;else{if(0!==t.length||a.initialized||!(a.matches.length>0))return null;e=a.matches}}let n=e,r=null==a?void 0:a.errors;if(null!=r){let e=n.findIndex(e=>e.route.id&&void 0!==(null==r?void 0:r[e.route.id]));jt(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(r).join(",")}`),n=n.slice(0,Math.min(n.length,e+1))}let i=!1,o=-1;if(a)for(let s=0;s<n.length;s++){let e=n[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(o=s),e.route.id){let{loaderData:t,errors:s}=a,r=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!s||void 0===s[e.route.id]);if(e.route.lazy||r){i=!0,n=o>=0?n.slice(0,o+1):[n[0]];break}}}return n.reduceRight((e,l,c)=>{let d,h=!1,u=null,m=null;a&&(d=r&&l.route.id?r[l.route.id]:void 0,u=l.route.errorElement||ms,i&&(o<0&&0===c?(ys("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,m=null):o===c&&(h=!0,m=l.route.hydrateFallbackElement||null)));let p=t.concat(n.slice(0,c+1)),x=()=>{let t;return t=d?u:h?m:l.route.Component?s.createElement(l.route.Component,null):l.route.element?l.route.element:e,s.createElement(xs,{match:l,routeContext:{outlet:e,matches:p,isDataRoute:null!=a},children:t})};return a&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?s.createElement(ps,{location:a.location,revalidation:a.revalidation,component:u,error:d,children:x(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):x()},null)}(f&&f.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:Bt([h,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:Bt([h,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,a);return t&&b?s.createElement(ss.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},b):b}function us(){let e=function(){var e;let t=s.useContext(ns),a=function(){let e=s.useContext(Zt);return jt(e,gs("useRouteError")),e}(),n=fs("useRouteError");return void 0!==t?t:null==(e=a.errors)?void 0:e[n]}(),t=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return o=s.createElement(s.Fragment,null,s.createElement("p",null,"💿 Hey developer 👋"),s.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",s.createElement("code",{style:i},"ErrorBoundary")," or"," ",s.createElement("code",{style:i},"errorElement")," prop on your route.")),s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),a?s.createElement("pre",{style:r},a):null,o)}s.createContext(null);var ms=s.createElement(us,null),ps=class extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){}render(){return void 0!==this.state.error?s.createElement(as.Provider,{value:this.props.routeContext},s.createElement(ns.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function xs({routeContext:e,match:t,children:a}){let n=s.useContext(Xt);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),s.createElement(as.Provider,{value:e},a)}function gs(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function fs(e){let t=function(e){let t=s.useContext(as);return jt(t,gs(e)),t}(e),a=t.matches[t.matches.length-1];return jt(a.route.id,`${e} can only be used on routes that contain a unique "id"`),a.route.id}var bs={};function ys(e,t,s){t||bs[e]||(bs[e]=!0,Nt(!1,s))}function vs({to:e,replace:t,state:a,relative:n}){jt(rs(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=s.useContext(ts);Nt(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=s.useContext(as),{pathname:o}=is(),l=cs(),c=Gt(e,Yt(i),o,"path"===n),d=JSON.stringify(c);return s.useEffect(()=>{l(JSON.parse(d),{replace:t,state:a,relative:n})},[l,d,n,t,a]),null}function ws(e){jt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function js({basename:e="/",children:t=null,location:a,navigationType:n="POP",navigator:r,static:i=!1}){jt(!rs(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=s.useMemo(()=>({basename:o,navigator:r,static:i,future:{}}),[o,r,i]);"string"==typeof a&&(a=Et(a));let{pathname:c="/",search:d="",hash:h="",state:u=null,key:m="default"}=a,p=s.useMemo(()=>{let e=Wt(c,o);return null==e?null:{location:{pathname:e,search:d,hash:h,state:u,key:m},navigationType:n}},[o,c,d,h,u,m,n]);return Nt(null!=p,`<Router basename="${o}"> is not able to match the URL "${c}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),null==p?null:s.createElement(ts.Provider,{value:l},s.createElement(ss.Provider,{children:t,value:p}))}function Ns({children:e,location:t}){return hs(Ss(e),t)}function Ss(e,t=[]){let a=[];return s.Children.forEach(e,(e,n)=>{if(!s.isValidElement(e))return;let r=[...t,n];if(e.type===s.Fragment)return void a.push.apply(a,Ss(e.props.children,r));jt(e.type===ws,`[${"string"==typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),jt(!e.props.index||!e.props.children,"An index route cannot have child routes.");let i={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Ss(e.props.children,r)),a.push(i)}),a}s.memo(function({routes:e,future:t,state:s}){return hs(e,void 0,s)});var ks="get",Cs="application/x-www-form-urlencoded";function Es(e){return null!=e&&"string"==typeof e.tagName}var Ps=null,Is=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ts(e){return null==e||Is.has(e)?e:(Nt(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Cs}"`),null)}function As(e,t){if(!1===e||null==e)throw new Error(t)}function Ms(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}function Ds(e,t,s,a,n,r){let i=(e,t)=>!s[t]||e.route.id!==s[t].route.id,o=(e,t)=>{var a;return s[t].pathname!==e.pathname||(null==(a=s[t].route.path)?void 0:a.endsWith("*"))&&s[t].params["*"]!==e.params["*"]};return"assets"===r?t.filter((e,t)=>i(e,t)||o(e,t)):"data"===r?t.filter((t,r)=>{var l;let c=a.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(i(t,r)||o(t,r))return!0;if(t.route.shouldRevalidate){let a=t.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:(null==(l=s[0])?void 0:l.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof a)return a}return!0}):[]}function Rs(){let e=s.useContext(Xt);return As(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var _s=s.createContext(void 0);function Ls(){let e=s.useContext(_s);return As(e,"You must render this element inside a <HydratedRouter> element"),e}function Os(e,t){return s=>{e&&e(s),s.defaultPrevented||t(s)}}function $s({page:e,...t}){let{router:a}=Rs(),n=s.useMemo(()=>Pt(a.routes,e,a.basename),[a.routes,e,a.basename]);return n?s.createElement(Us,{page:e,matches:n,...t}):null}function Us({page:e,matches:t,...a}){let n=is(),{manifest:r,routeModules:i}=Ls(),{basename:o}=Rs(),{loaderData:l,matches:c}=function(){let e=s.useContext(Zt);return As(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}(),d=s.useMemo(()=>Ds(e,t,c,r,n,"data"),[e,t,c,r,n]),h=s.useMemo(()=>Ds(e,t,c,r,n,"assets"),[e,t,c,r,n]),u=s.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let s=new Set,a=!1;if(t.forEach(e=>{var t;let n=r.routes[e.route.id];n&&n.hasLoader&&(!d.some(t=>t.route.id===e.route.id)&&e.route.id in l&&(null==(t=i[e.route.id])?void 0:t.shouldRevalidate)||n.hasClientLoader?a=!0:s.add(e.route.id))}),0===s.size)return[];let c=function(e,t){let s="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===s.pathname?s.pathname="_root.data":t&&"/"===Wt(s.pathname,t)?s.pathname=`${t.replace(/\/$/,"")}/_root.data`:s.pathname=`${s.pathname.replace(/\/$/,"")}.data`,s}(e,o);return a&&s.size>0&&c.searchParams.set("_routes",t.filter(e=>s.has(e.route.id)).map(e=>e.route.id).join(",")),[c.pathname+c.search]},[o,l,n,r,d,t,e,i]),m=s.useMemo(()=>function(e,t,{includeHydrateFallback:s}={}){return a=e.map(e=>{let a=t.routes[e.route.id];if(!a)return[];let n=[a.module];return a.clientActionModule&&(n=n.concat(a.clientActionModule)),a.clientLoaderModule&&(n=n.concat(a.clientLoaderModule)),s&&a.hydrateFallbackModule&&(n=n.concat(a.hydrateFallbackModule)),a.imports&&(n=n.concat(a.imports)),n}).flat(1),[...new Set(a)];var a}(h,r),[h,r]),p=function(e){let{manifest:t,routeModules:a}=Ls(),[n,r]=s.useState([]);return s.useEffect(()=>{let s=!1;return async function(e,t,s){return function(e,t){let s=new Set;return new Set(t),e.reduce((e,t)=>{let a=JSON.stringify(function(e){let t={},s=Object.keys(e).sort();for(let a of s)t[a]=e[a];return t}(t));return s.has(a)||(s.add(a),e.push({key:a,link:t})),e},[])}((await Promise.all(e.map(async e=>{let a=t.routes[e.route.id];if(a){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let s=await dt(()=>import(e.module),[]);return t[e.id]=s,s}catch(s){return window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}(a,s);return e.links?e.links():[]}return[]}))).flat(1).filter(Ms).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"}))}(e,t,a).then(e=>{s||r(e)}),()=>{s=!0}},[e,t,a]),n}(h);return s.createElement(s.Fragment,null,u.map(e=>s.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...a})),m.map(e=>s.createElement("link",{key:e,rel:"modulepreload",href:e,...a})),p.map(({key:e,link:t})=>s.createElement("link",{key:e,...t})))}function zs(...e){return t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}}_s.displayName="FrameworkContext";var Fs="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{Fs&&(window.__reactRouterVersion="7.6.3")}catch(Ul){}function Ws({basename:e,children:t,window:a}){let n=s.useRef();null==n.current&&(n.current=function(e={}){return function(e,t,s,a={}){let{window:n=document.defaultView,v5Compat:r=!1}=a,i=n.history,o="POP",l=null,c=d();function d(){return(i.state||{idx:null}).idx}function h(){o="POP";let e=d(),t=null==e?null:e-c;c=e,l&&l({action:o,location:m.location,delta:t})}function u(e){return function(e,t=!1){let s="http://localhost";"undefined"!=typeof window&&(s="null"!==window.location.origin?window.location.origin:window.location.href),jt(s,"No window.location.(origin|href) available to create URL");let a="string"==typeof e?e:Ct(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=s+a),new URL(a,s)}(e)}null==c&&(c=0,i.replaceState({...i.state,idx:c},""));let m={get action(){return o},get location(){return e(n,i)},listen(e){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(wt,h),l=e,()=>{n.removeEventListener(wt,h),l=null}},createHref:e=>t(n,e),createURL:u,encodeLocation(e){let t=u(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let a=kt(m.location,e,t);s&&s(a,e),c=d()+1;let h=St(a,c),u=m.createHref(a);try{i.pushState(h,"",u)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;n.location.assign(u)}r&&l&&l({action:o,location:m.location,delta:1})},replace:function(e,t){o="REPLACE";let a=kt(m.location,e,t);s&&s(a,e),c=d();let n=St(a,c),h=m.createHref(a);i.replaceState(n,"",h),r&&l&&l({action:o,location:m.location,delta:0})},go:e=>i.go(e)};return m}(function(e,t){let{pathname:s,search:a,hash:n}=e.location;return kt("",{pathname:s,search:a,hash:n},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:Ct(t)},null,e)}({window:a,v5Compat:!0}));let r=n.current,[i,o]=s.useState({action:r.action,location:r.location}),l=s.useCallback(e=>{s.startTransition(()=>o(e))},[o]);return s.useLayoutEffect(()=>r.listen(l),[r,l]),s.createElement(js,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:r})}var Hs=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ys=s.forwardRef(function({onClick:e,discover:t="render",prefetch:a="none",relative:n,reloadDocument:r,replace:i,state:o,target:l,to:c,preventScrollReset:d,viewTransition:h,...u},m){let p,{basename:x}=s.useContext(ts),g="string"==typeof c&&Hs.test(c),f=!1;if("string"==typeof c&&g&&(p=c,Fs))try{let e=new URL(window.location.href),t=c.startsWith("//")?new URL(e.protocol+c):new URL(c),s=Wt(t.pathname,x);t.origin===e.origin&&null!=s?c=s+t.search+t.hash:f=!0}catch(Ul){Nt(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=function(e,{relative:t}={}){jt(rs(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:n}=s.useContext(ts),{hash:r,pathname:i,search:o}=ds(e,{relative:t}),l=i;return"/"!==a&&(l="/"===i?a:Bt([a,i])),n.createHref({pathname:l,search:o,hash:r})}(c,{relative:n}),[y,v,w]=function(e,t){let a=s.useContext(_s),[n,r]=s.useState(!1),[i,o]=s.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:h,onTouchStart:u}=t,m=s.useRef(null);s.useEffect(()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return m.current&&e.observe(m.current),()=>{e.disconnect()}}},[e]),s.useEffect(()=>{if(n){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[n]);let p=()=>{r(!0)},x=()=>{r(!1),o(!1)};return a?"intent"!==e?[i,m,{}]:[i,m,{onFocus:Os(l,p),onBlur:Os(c,x),onMouseEnter:Os(d,p),onMouseLeave:Os(h,x),onTouchStart:Os(u,p)}]:[!1,m,{}]}(a,u),j=function(e,{target:t,replace:a,state:n,preventScrollReset:r,relative:i,viewTransition:o}={}){let l=cs(),c=is(),d=ds(e,{relative:i});return s.useCallback(s=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(s,t)){s.preventDefault();let t=void 0!==a?a:Ct(c)===Ct(d);l(e,{replace:t,state:n,preventScrollReset:r,relative:i,viewTransition:o})}},[c,l,d,a,n,t,e,r,i,o])}(c,{replace:i,state:o,target:l,preventScrollReset:d,relative:n,viewTransition:h}),N=s.createElement("a",{...u,...w,href:p||b,onClick:f||r?e:function(t){e&&e(t),t.defaultPrevented||j(t)},ref:zs(m,v),target:l,"data-discover":g||"render"!==t?void 0:"true"});return y&&!g?s.createElement(s.Fragment,null,N,s.createElement($s,{page:b})):N});function Gs(e){let t=s.useContext(Xt);return jt(t,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),t}Ys.displayName="Link",s.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:a="",end:n=!1,style:r,to:i,viewTransition:o,children:l,...c},d){let h=ds(i,{relative:c.relative}),u=is(),m=s.useContext(Zt),{navigator:p,basename:x}=s.useContext(ts),g=null!=m&&function(e,t={}){let a=s.useContext(es);jt(null!=a,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Gs("useViewTransitionState"),r=ds(e,{relative:t.relative});if(!a.isTransitioning)return!1;let i=Wt(a.currentLocation.pathname,n)||a.currentLocation.pathname,o=Wt(a.nextLocation.pathname,n)||a.nextLocation.pathname;return null!=zt(r.pathname,o)||null!=zt(r.pathname,i)}(h)&&!0===o,f=p.encodeLocation?p.encodeLocation(h).pathname:h.pathname,b=u.pathname,y=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;t||(b=b.toLowerCase(),y=y?y.toLowerCase():null,f=f.toLowerCase()),y&&x&&(y=Wt(y,x)||y);const v="/"!==f&&f.endsWith("/")?f.length-1:f.length;let w,j=b===f||!n&&b.startsWith(f)&&"/"===b.charAt(v),N=null!=y&&(y===f||!n&&y.startsWith(f)&&"/"===y.charAt(f.length)),S={isActive:j,isPending:N,isTransitioning:g},k=j?e:void 0;w="function"==typeof a?a(S):[a,j?"active":null,N?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let C="function"==typeof r?r(S):r;return s.createElement(Ys,{...c,"aria-current":k,className:w,ref:d,style:C,to:i,viewTransition:o},"function"==typeof l?l(S):l)}).displayName="NavLink",s.forwardRef(({discover:e="render",fetcherKey:t,navigate:a,reloadDocument:n,replace:r,state:i,method:o=ks,action:l,onSubmit:c,relative:d,preventScrollReset:h,viewTransition:u,...m},p)=>{let x=function(){let{router:e}=Gs("useSubmit"),{basename:t}=s.useContext(ts),a=fs("useRouteId");return s.useCallback(async(s,n={})=>{let{action:r,method:i,encType:o,formData:l,body:c}=function(e,t){let s,a,n,r,i;if(Es(o=e)&&"form"===o.tagName.toLowerCase()){let i=e.getAttribute("action");a=i?Wt(i,t):null,s=e.getAttribute("method")||ks,n=Ts(e.getAttribute("enctype"))||Cs,r=new FormData(e)}else if(function(e){return Es(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Es(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let i=e.form;if(null==i)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||i.getAttribute("action");if(a=o?Wt(o,t):null,s=e.getAttribute("formmethod")||i.getAttribute("method")||ks,n=Ts(e.getAttribute("formenctype"))||Ts(i.getAttribute("enctype"))||Cs,r=new FormData(i,e),!function(){if(null===Ps)try{new FormData(document.createElement("form"),0),Ps=!1}catch(Ul){Ps=!0}return Ps}()){let{name:t,type:s,value:a}=e;if("image"===s){let e=t?`${t}.`:"";r.append(`${e}x`,"0"),r.append(`${e}y`,"0")}else t&&r.append(t,a)}}else{if(Es(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=ks,a=null,n=Cs,i=e}var o;return r&&"text/plain"===n&&(i=r,r=void 0),{action:a,method:s.toLowerCase(),encType:n,formData:r,body:i}}(s,t);if(!1===n.navigate){let t=n.fetcherKey||qs();await e.fetch(t,a,n.action||r,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||i,formEncType:n.encType||o,flushSync:n.flushSync})}else await e.navigate(n.action||r,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||i,formEncType:n.encType||o,replace:n.replace,state:n.state,fromRouteId:a,flushSync:n.flushSync,viewTransition:n.viewTransition})},[e,t,a])}(),g=function(e,{relative:t}={}){let{basename:a}=s.useContext(ts),n=s.useContext(as);jt(n,"useFormAction must be used inside a RouteContext");let[r]=n.matches.slice(-1),i={...ds(e||".",{relative:t})},o=is();if(null==e){i.search=o.search;let e=new URLSearchParams(i.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let s=e.toString();i.search=s?`?${s}`:""}}return e&&"."!==e||!r.route.index||(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),"/"!==a&&(i.pathname="/"===i.pathname?a:Bt([a,i.pathname])),Ct(i)}(l,{relative:d}),f="get"===o.toLowerCase()?"get":"post",b="string"==typeof l&&Hs.test(l);return s.createElement("form",{ref:p,method:f,action:g,onSubmit:n?c:e=>{if(c&&c(e),e.defaultPrevented)return;e.preventDefault();let s=e.nativeEvent.submitter,n=(null==s?void 0:s.getAttribute("formmethod"))||o;x(s||e.currentTarget,{fetcherKey:t,method:n,navigate:a,replace:r,state:i,relative:d,preventScrollReset:h,viewTransition:u})},...m,"data-discover":b||"render"!==e?void 0:"true"})}).displayName="Form";var Bs=0,qs=()=>`__${String(++Bs)}__`;const Js=p({apiKey:"AIzaSyAVJvau3Hit06q1pNYCTOF-pVuutmk4oNQ",authDomain:"mythseekers-rpg.firebaseapp.com",databaseURL:"https://mythseekers-rpg-default-rtdb.firebaseio.com",projectId:"mythseekers-rpg",storageBucket:"mythseekers-rpg.firebasestorage.app",messagingSenderId:"659018227506",appId:"1:659018227506:web:82425e7adaf80c2e3c412b",measurementId:"G-E3T1V81ZX3"}),Vs=o(Js),Ks=A(Js);Y(Js);const Qs=new class{constructor(){t(this,"listeners",{})}async signInWithGoogle(){var e,t;try{const a=new l;a.setCustomParameters({prompt:"select_account"}),a.addScope("profile"),a.addScope("email");try{const e=await c(Vs,a);await this.getUserProfile(e.user.uid)||await this.createUserProfile(e.user)}catch(s){if("auth/popup-blocked"!==s.code&&"auth/popup-closed-by-user"!==s.code&&!(null==(e=s.message)?void 0:e.includes("Cross-Origin-Opener-Policy"))&&!(null==(t=s.message)?void 0:t.includes("window.closed")))throw s;await d(Vs,a)}}catch(a){throw a}}async handleRedirectSignIn(){try{const e=await h(Vs);if(e){const t=e.user;return await this.getUserProfile(t.uid)||await this.createUserProfile(t),t}return null}catch(e){return null}}async signOut(){await u(Vs)}onAuthStateChange(e){return m(Vs,e)}getCurrentUser(){return Vs.currentUser}async createUserProfile(e){try{const t={uid:e.uid,displayName:e.displayName||"Adventurer",email:e.email||"",photoURL:e.photoURL||"",createdAt:Date.now(),lastSeen:Date.now(),totalPlayTime:0,campaignsHosted:0,campaignsJoined:0};await M(D(Ks,"users",e.uid),t)}catch(t){throw t}}async getUserProfile(e){try{const t=D(Ks,"users",e),s=await R(t);return s.exists()?s.data():null}catch(t){return null}}async updateUserLastSeen(e){const t=D(Ks,"users",e);await _(t,{lastSeen:Date.now()})}async saveCharacter(e){if(!this.getCurrentUser())throw new Error("User not authenticated");if(!Ks)throw new Error("Firebase not initialized");const t={...e,lastPlayed:Date.now()};try{if(e.id){const s=D(Ks,"characters",e.id);return await _(s,t),e.id}return(await L(O(Ks,"characters"),t)).id}catch(s){throw s}}async getUserCharacters(e){const t=$(O(Ks,"characters"),U("userId","==",e));return(await z(t)).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>t.lastPlayed-e.lastPlayed)}async getUserCampaigns(e){const t=$(O(Ks,"games"),U("hostId","==",e));return(await z(t)).docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>t.lastActivity-e.lastActivity)}async getCharacter(e){const t=D(Ks,"characters",e),s=await R(t);return s.exists()?{id:s.id,...s.data()}:null}async createGameSession(e){const t=this.generateGameCode(),s=this.getCurrentUser();if(!s)throw new Error("User must be authenticated");const a={code:t,theme:e.theme||"Classic Fantasy",background:e.background||"fantasy",hostId:s.uid,players:e.players||[],messages:e.messages||[],started:!1,customPrompt:e.customPrompt||"",maxPlayers:e.maxPlayers||6,createdAt:Date.now(),lastActivity:Date.now()},n=await L(O(Ks,"games"),a);return await this.updateUserStats(s.uid,{campaignsHosted:1}),{gameId:n.id,code:t}}async joinGameSession(e,t){const s=this.getCurrentUser();if(!s)throw new Error("User must be authenticated");const a=$(O(Ks,"games"),U("code","==",e),U("started","==",!1)),n=await z(a);if(n.empty)throw new Error("Game not found or already started");const r=n.docs[0],i=r.data();if(i.players.length>=i.maxPlayers)throw new Error("Game is full");if(i.players.find(e=>e.id===s.uid))throw new Error("Player already in game");const o=await this.getCharacter(t);if(!o)throw new Error("Character not found");const l={id:s.uid,name:o.name,characterId:t,isHost:!1,isOnline:!0,lastSeen:Date.now()};return await _(D(Ks,"games",r.id),{players:F(l),lastActivity:Date.now()}),await this.updateUserStats(s.uid,{campaignsJoined:1}),{gameId:r.id,gameData:{...i,players:[...i.players,l]}}}async leaveGameSession(e){const t=this.getCurrentUser();if(!t)throw new Error("User must be authenticated");const s=D(Ks,"games",e),a=await R(s);if(!a.exists())throw new Error("Game not found");const n=a.data().players.filter(e=>e.id!==t.uid);0===n.length?await W(s):await _(s,{players:n,lastActivity:Date.now()})}async startGameSession(e){const t=this.getCurrentUser();if(!t)throw new Error("User must be authenticated");const s=D(Ks,"games",e),a=await R(s);if(!a.exists())throw new Error("Game not found");if(a.data().hostId!==t.uid)throw new Error("Only host can start the game");await _(s,{started:!0,lastActivity:Date.now()})}onGameUpdate(e,t){const s=D(Ks,"games",e),a=H(s,e=>{if(e.exists()){const s={id:e.id,...e.data()};t(s)}});return this.listeners[e]=a,a}async sendMessage(e,t){if(!this.getCurrentUser())throw new Error("User must be authenticated");const s={...t,id:`msg-${Date.now()}`,timestamp:Date.now()},a=D(Ks,"games",e);await _(a,{messages:F(s),lastActivity:Date.now()})}async saveGameProgress(e,t,s){const a=this.getCurrentUser();if(!a)throw new Error("User must be authenticated");const n=D(Ks,"characters",t);await _(n,{...s,lastPlayed:Date.now()}),await this.updateUserStats(a.uid,{totalPlayTime:s.playTime||0})}async completeCampaign(e,t){try{if(!Vs.currentUser)throw new Error("User not authenticated");const{httpsCallable:s}=await dt(()=>import("./firebase-functions-7c25f05b.js"),["assets/firebase-functions-7c25f05b.js","assets/firebase-core-a7cb50f5.js"]),{getFunctions:a}=await dt(()=>import("./firebase-functions-7c25f05b.js"),["assets/firebase-functions-7c25f05b.js","assets/firebase-core-a7cb50f5.js"]),n=s(a(Js),"completeCampaign");await n({gameId:e,campaignData:t})}catch(s){throw s}}async startCombat(e){try{if(!Vs.currentUser)throw new Error("User not authenticated");const{httpsCallable:t}=await dt(()=>import("./firebase-functions-7c25f05b.js"),["assets/firebase-functions-7c25f05b.js","assets/firebase-core-a7cb50f5.js"]),{getFunctions:s}=await dt(()=>import("./firebase-functions-7c25f05b.js"),["assets/firebase-functions-7c25f05b.js","assets/firebase-core-a7cb50f5.js"]),a=t(s(Js),"startCombat");return{success:!0,combatState:(await a(e)).data}}catch(t){return{success:!1,error:t.message}}}async getCombatState(e){try{if(!Vs.currentUser)throw new Error("User not authenticated");const{httpsCallable:t}=await dt(()=>import("./firebase-functions-7c25f05b.js"),["assets/firebase-functions-7c25f05b.js","assets/firebase-core-a7cb50f5.js"]),{getFunctions:s}=await dt(()=>import("./firebase-functions-7c25f05b.js"),["assets/firebase-functions-7c25f05b.js","assets/firebase-core-a7cb50f5.js"]),a=t(s(Js),"getCombatState");return{success:!0,combatState:(await a({combatId:e})).data}}catch(t){return{success:!1,error:t.message}}}async resolveCombatAction(e){try{if(!Vs.currentUser)throw new Error("User not authenticated");const{httpsCallable:t}=await dt(()=>import("./firebase-functions-7c25f05b.js"),["assets/firebase-functions-7c25f05b.js","assets/firebase-core-a7cb50f5.js"]),{getFunctions:s}=await dt(()=>import("./firebase-functions-7c25f05b.js"),["assets/firebase-functions-7c25f05b.js","assets/firebase-core-a7cb50f5.js"]),a=t(s(Js),"resolveCombatAction");return{success:!0,combatState:(await a(e)).data}}catch(t){return{success:!1,error:t.message}}}async endCombat(e){try{if(!Vs.currentUser)throw new Error("User not authenticated");const{httpsCallable:t}=await dt(()=>import("./firebase-functions-7c25f05b.js"),["assets/firebase-functions-7c25f05b.js","assets/firebase-core-a7cb50f5.js"]),{getFunctions:s}=await dt(()=>import("./firebase-functions-7c25f05b.js"),["assets/firebase-functions-7c25f05b.js","assets/firebase-core-a7cb50f5.js"]),a=t(s(Js),"endCombat");return await a(e),{success:!0}}catch(t){return{success:!1,error:t.message}}}async updateUserStats(e,t){const s=D(Ks,"users",e);await _(s,t)}async getUserAchievements(e){try{const t=O(Ks,"achievements"),s=$(t,U("userId","==",e)),a=await z(s),n=[];return a.forEach(e=>{n.push({id:e.id,...e.data()})}),n}catch(t){return[]}}async getPlayerStats(e){try{const t=await this.getUserProfile(e);if(!t)return{totalPlayTime:0,campaignsHosted:0,campaignsJoined:0,charactersCreated:0,totalXP:0,combatWins:0,questsCompleted:0,npcsInteracted:0,locationsDiscovered:0,achievementsUnlocked:0,lastActive:new Date,joinDate:new Date};const s=await this.getUserCharacters(e),a=await this.getUserAchievements(e);return{totalPlayTime:t.totalPlayTime||0,campaignsHosted:t.campaignsHosted||0,campaignsJoined:t.campaignsJoined||0,charactersCreated:s.length,totalXP:s.reduce((e,t)=>e+(t.experience||0),0),combatWins:0,questsCompleted:0,npcsInteracted:0,locationsDiscovered:0,achievementsUnlocked:a.length,lastActive:new Date(t.lastSeen),joinDate:new Date(t.createdAt)}}catch(t){return{totalPlayTime:0,campaignsHosted:0,campaignsJoined:0,charactersCreated:0,totalXP:0,combatWins:0,questsCompleted:0,npcsInteracted:0,locationsDiscovered:0,achievementsUnlocked:0,lastActive:new Date,joinDate:new Date}}}generateGameCode(){let e="";for(let t=0;t<6;t++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(36*Math.random()));return e}cleanup(){Object.values(this.listeners).forEach(e=>e()),this.listeners={}}},Xs=()=>{const[e,t]=s.useState(null),[a,n]=s.useState(null),[r,i]=s.useState(!0),[o,l]=s.useState("overview"),[c,d]=s.useState([]),[h,u]=s.useState(null);s.useEffect(()=>Qs.onAuthStateChange(async e=>{if(t(e),i(!1),e)try{const t=await Qs.getUserProfile(e.uid);n(t),await m(e.uid)}catch(s){n(null)}else n(null)}),[]);const m=async e=>{try{const t=await Qs.getUserAchievements(e);d(t);const s=await Qs.getPlayerStats(e);u(s)}catch(t){}},p=e=>{const t=Math.floor(e/60),s=e%60;return t>24?`${Math.floor(t/24)}d ${t%24}h ${s}m`:`${t}h ${s}m`};if(r)return it.jsx("div",{className:"text-blue-200",children:"Loading..."});if(!e)return it.jsx("div",{className:"flex flex-col items-center space-y-2",children:it.jsx("button",{onClick:async()=>{i(!0);try{await Qs.signInWithGoogle()}catch(Ul){alert("Login failed: "+Ul)}i(!1)},className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all",children:"Sign in with Google"})});const x=(g=(null==h?void 0:h.totalXP)||0,Math.floor(g/1e3)+1);var g;const f=(b=x)>=20?{name:"Legendary Master",color:"text-purple-400",icon:"👑"}:b>=15?{name:"Epic Hero",color:"text-red-400",icon:"⚔️"}:b>=10?{name:"Veteran Adventurer",color:"text-orange-400",icon:"🛡️"}:b>=5?{name:"Skilled Warrior",color:"text-yellow-400",icon:"⚡"}:{name:"Novice Explorer",color:"text-green-400",icon:"🌱"};var b;return it.jsxs("div",{className:"flex flex-col h-full",children:[it.jsx("div",{className:"bg-gradient-to-r from-blue-900/50 to-purple-900/50 rounded-lg p-4 mb-4 border border-white/20",children:it.jsxs("div",{className:"flex items-center space-x-4",children:[it.jsx("img",{src:e.photoURL,alt:"avatar",className:"w-16 h-16 rounded-full border-2 border-blue-400"}),it.jsxs("div",{className:"flex-1",children:[it.jsx("div",{className:"text-white font-bold text-lg",children:e.displayName}),it.jsx("div",{className:"text-blue-200 text-sm",children:e.email}),it.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[it.jsx("span",{className:"text-2xl",children:f.icon}),it.jsx("span",{className:`font-semibold ${f.color}`,children:f.name}),it.jsxs("span",{className:"text-gray-300",children:["• Level ",x]})]})]}),it.jsx("button",{onClick:async()=>{i(!0);try{await Qs.signOut()}catch(Ul){alert("Logout failed: "+Ul)}i(!1)},className:"px-4 py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-all",children:"Sign out"})]})}),it.jsx("div",{className:"flex space-x-1 mb-4",children:[{key:"overview",label:"Overview",icon:it.jsx(X,{size:16})},{key:"achievements",label:"Achievements",icon:it.jsx(Z,{size:16})},{key:"stats",label:"Statistics",icon:it.jsx(ee,{size:16})},{key:"characters",label:"Characters",icon:it.jsx(te,{size:16})}].map(e=>it.jsxs("button",{onClick:()=>l(e.key),className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-all "+(o===e.key?"bg-blue-600 text-white":"bg-white/10 text-blue-200 hover:bg-white/20"),children:[e.icon,it.jsx("span",{className:"hidden sm:inline",children:e.label})]},e.key))}),it.jsxs("div",{className:"flex-1 overflow-y-auto",children:["overview"===o&&it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[it.jsxs("div",{className:"bg-white/10 rounded-lg p-4 text-center border border-white/20",children:[it.jsx(se,{className:"w-6 h-6 text-blue-400 mx-auto mb-2"}),it.jsx("div",{className:"text-white font-bold",children:p((null==h?void 0:h.totalPlayTime)||0)}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Play Time"})]}),it.jsxs("div",{className:"bg-white/10 rounded-lg p-4 text-center border border-white/20",children:[it.jsx(ae,{className:"w-6 h-6 text-yellow-400 mx-auto mb-2"}),it.jsx("div",{className:"text-white font-bold",children:(null==h?void 0:h.achievementsUnlocked)||0}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Achievements"})]}),it.jsxs("div",{className:"bg-white/10 rounded-lg p-4 text-center border border-white/20",children:[it.jsx(te,{className:"w-6 h-6 text-green-400 mx-auto mb-2"}),it.jsx("div",{className:"text-white font-bold",children:(null==h?void 0:h.campaignsJoined)||0}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Campaigns"})]}),it.jsxs("div",{className:"bg-white/10 rounded-lg p-4 text-center border border-white/20",children:[it.jsx(ne,{className:"w-6 h-6 text-red-400 mx-auto mb-2"}),it.jsx("div",{className:"text-white font-bold",children:(null==h?void 0:h.questsCompleted)||0}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Quests"})]})]}),it.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Recent Activity"}),it.jsxs("div",{className:"space-y-2 text-sm",children:[it.jsxs("div",{className:"flex items-center space-x-3 text-blue-200",children:[it.jsx(re,{size:16}),it.jsxs("span",{children:["Joined MythSeeker ",(null==h?void 0:h.joinDate)?new Date(h.joinDate).toLocaleDateString():"recently"]})]}),it.jsxs("div",{className:"flex items-center space-x-3 text-blue-200",children:[it.jsx(se,{size:16}),it.jsxs("span",{children:["Last active ",(null==h?void 0:h.lastActive)?new Date(h.lastActive).toLocaleDateString():"recently"]})]})]})]}),it.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Level Progress"}),it.jsxs("div",{className:"space-y-2",children:[it.jsxs("div",{className:"flex justify-between text-sm",children:[it.jsxs("span",{className:"text-blue-200",children:["Level ",x]}),it.jsxs("span",{className:"text-blue-200",children:["Level ",x+1]})]}),it.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:it.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all",style:{width:((null==h?void 0:h.totalXP)||0)%1e3/10+"%"}})}),it.jsxs("div",{className:"text-center text-sm text-blue-200",children:[(null==h?void 0:h.totalXP)||0," / ",1e3*(x+1)," XP"]})]})]})]}),"achievements"===o&&it.jsx("div",{className:"space-y-4",children:it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.map(e=>it.jsx("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:it.jsxs("div",{className:"flex items-start space-x-3",children:[it.jsx("div",{className:"text-3xl",children:e.icon}),it.jsxs("div",{className:"flex-1",children:[it.jsx("h4",{className:"text-white font-medium",children:e.name}),it.jsx("p",{className:"text-gray-300 text-sm mb-2",children:e.description}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("span",{className:"text-xs text-yellow-400",children:["+",e.points," points"]}),it.jsx("span",{className:"text-xs text-gray-400",children:e.unlockedAt?new Date(e.unlockedAt).toLocaleDateString():"Unlocked"})]})]})]})},e.id)),0===c.length&&it.jsxs("div",{className:"col-span-full text-center py-8",children:[it.jsx(Z,{size:48,className:"text-gray-400 mx-auto mb-4"}),it.jsx("p",{className:"text-gray-400",children:"No achievements unlocked yet"}),it.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Complete quests and challenges to earn achievements!"})]})]})}),"stats"===o&&it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:[it.jsxs("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center space-x-2",children:[it.jsx(ie,{size:20,className:"text-red-400"}),it.jsx("span",{children:"Combat Statistics"})]}),it.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"text-white font-bold text-xl",children:(null==h?void 0:h.combatWins)||0}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Combat Wins"})]}),it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"text-white font-bold text-xl",children:(null==h?void 0:h.totalXP)||0}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Total XP"})]}),it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"text-white font-bold text-xl",children:(null==h?void 0:h.charactersCreated)||0}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Characters"})]}),it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"text-white font-bold text-xl",children:(null==h?void 0:h.campaignsHosted)||0}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Campaigns Hosted"})]})]})]}),it.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:[it.jsxs("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center space-x-2",children:[it.jsx(ne,{size:20,className:"text-green-400"}),it.jsx("span",{children:"Exploration Statistics"})]}),it.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"text-white font-bold text-xl",children:(null==h?void 0:h.questsCompleted)||0}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Quests Completed"})]}),it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"text-white font-bold text-xl",children:(null==h?void 0:h.locationsDiscovered)||0}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Locations Found"})]}),it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"text-white font-bold text-xl",children:(null==h?void 0:h.npcsInteracted)||0}),it.jsx("div",{className:"text-blue-200 text-sm",children:"NPCs Met"})]})]})]}),it.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:[it.jsxs("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center space-x-2",children:[it.jsx(se,{size:20,className:"text-blue-400"}),it.jsx("span",{children:"Time Statistics"})]}),it.jsxs("div",{className:"space-y-2 text-sm",children:[it.jsxs("div",{className:"flex justify-between",children:[it.jsx("span",{className:"text-blue-200",children:"Total Play Time:"}),it.jsx("span",{className:"text-white",children:p((null==h?void 0:h.totalPlayTime)||0)})]}),it.jsxs("div",{className:"flex justify-between",children:[it.jsx("span",{className:"text-blue-200",children:"Average Session:"}),it.jsx("span",{className:"text-white",children:(null==h?void 0:h.campaignsJoined)?p(Math.floor((h.totalPlayTime||0)/h.campaignsJoined)):"0m"})]}),it.jsxs("div",{className:"flex justify-between",children:[it.jsx("span",{className:"text-blue-200",children:"Member Since:"}),it.jsx("span",{className:"text-white",children:(null==h?void 0:h.joinDate)?new Date(h.joinDate).toLocaleDateString():"Recently"})]})]})]})]}),"characters"===o&&it.jsx("div",{className:"space-y-4",children:it.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/20",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Character Gallery"}),it.jsx("p",{className:"text-blue-200 text-sm mb-4",children:"Your created characters and their achievements will appear here."}),it.jsxs("div",{className:"text-center py-8",children:[it.jsx(te,{size:48,className:"text-gray-400 mx-auto mb-4"}),it.jsx("p",{className:"text-gray-400",children:"Character management coming soon!"}),it.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Create characters to see them here"})]})]})})]})]})},Zs=p({apiKey:"AIzaSyAVJvau3Hit06q1pNYCTOF-pVuutmk4oNQ",authDomain:"mythseekers-rpg.firebaseapp.com",databaseURL:"https://mythseekers-rpg-default-rtdb.firebaseio.com",projectId:"mythseekers-rpg",storageBucket:"mythseekers-rpg.firebasestorage.app",messagingSenderId:"659018227506",appId:"1:659018227506:web:82425e7adaf80c2e3c412b",measurementId:"G-E3T1V81ZX3"}),ea=Y(Zs),ta=Ve(Zs);o(Zs);const sa=new class{constructor(){t(this,"aiDungeonMaster",Ke(ta,"aiDungeonMaster"))}async complete(e,t){var s,a;try{if(!t||!t.isMultiplayer)return await new Promise(e=>setTimeout(e,1e3+2e3*Math.random())),this.generateLocalResponse(e);const r=new Promise((e,t)=>{setTimeout(()=>{t(new Error("Firebase function timeout"))},15e3)}),i=this.aiDungeonMaster({prompt:e,campaignId:t.id,playerName:(null==(a=null==(s=t.players)?void 0:s[0])?void 0:a.name)||t.playerName||"Player"});try{return(await Promise.race([i,r])).data}catch(n){return await new Promise(e=>setTimeout(e,1e3+2e3*Math.random())),this.generateLocalResponse(e)}}catch(r){return JSON.stringify(this.generateFallbackResponse())}}generateLocalResponse(e){try{const t=this.parsePromptContext(e),s=e.includes("INITIAL SCENE REQUIREMENTS")?this.generateInitialScene(t):this.generateDynamicResponse(t);return JSON.stringify(s)}catch(t){return JSON.stringify(this.generateFallbackResponse())}}parsePromptContext(e){const t=e.match(/Player Level: (\d+) ([^,\n]+)/),s=e.match(/Player Stats: STR (\d+), DEX (\d+), INT (\d+), CHA (\d+)/),a=e.match(/Location: ([^\n]+)/),n=e.match(/Time: ([^\n]+)/),r=e.match(/Weather: ([^\n]+)/),i=e.match(/\*\*PLAYER INPUT:\*\* "([^"]+)"/),o=i?i[1]:"",l=e.match(/for a ([^ ]+) campaign/),c=l?l[1]:"fantasy",d=e.match(/\*\*CUSTOM CAMPAIGN PROMPT:\*\*\n([^*]+?)(?=\*\*|$)/),h=d?d[1].trim():"";return{character:{level:t?parseInt(t[1]):1,class:t?t[2]:"Adventurer",stats:s?{strength:parseInt(s[1]),dexterity:parseInt(s[2]),intelligence:parseInt(s[3]),charisma:parseInt(s[4])}:{strength:10,dexterity:10,intelligence:10,charisma:10}},worldState:{location:a?a[1].trim():"unknown",time:n?n[1].trim():"day",weather:r?r[1].trim():"clear"},playerInput:o,theme:c,customPrompt:h}}generateInitialScene(e){const{character:t,worldState:s,theme:a,customPrompt:n}=e,r=this.generateLocation(s.location,a),i=this.generateNPC(t,a),o=this.generateConflict(a,n),l=[`You find yourself in ${r.name}, where ${r.atmosphere}. ${i.name}, a ${i.role.toLowerCase()}, approaches you with ${i.mood} in their eyes. "${i.greeting}" they say, their voice ${i.voice}.`,`As you enter ${r.name}, ${r.description}. ${i.name} spots you and immediately makes their way over. "${i.greeting}" they ${i.action}, their ${i.personality} nature evident in every gesture.`,`${r.name} ${r.activity}. ${i.name} rushes toward you, their face ${i.expression}. "${i.greeting}" they ${i.action}, clearly ${i.motivation}.`],c=[`Accept ${i.name}'s request and ask for details`,"Express skepticism and demand more information",`Ask about the local situation and ${i.name}'s background`,"Request to see the area and gather your own intelligence"];return{narrative:l[Math.floor(Math.random()*l.length)],choices:c,environment:r.id,worldStateUpdates:{newLocation:r.id,newNPCs:[{name:i.name,role:i.role,personality:i.personality,currentMood:i.mood,currentAction:i.action}],consequences:[{type:"immediate",description:`You've been approached by ${i.name} about ${o.name}`,affectedAreas:[r.id]}]},atmosphere:{mood:r.mood,tension:"medium",environmentalDetails:r.details}}}generateDynamicResponse(e){const{character:t,worldState:s,playerInput:a,theme:n}=e,r=a.toLowerCase();return this.isCombatAction(r)?this.generateCombatResponse(e):this.isExplorationAction(r)?this.generateExplorationResponse(e):this.isSocialAction(r)?this.generateSocialResponse(e):this.isRestAction(r)?this.generateRestResponse(e):this.generateGeneralResponse(e)}isCombatAction(e){return["attack","fight","combat","battle","strike","slash","stab","shoot","cast","spell"].some(t=>e.includes(t))}isExplorationAction(e){return["explore","search","investigate","examine","look","check","find","discover"].some(t=>e.includes(t))}isSocialAction(e){return["talk","ask","tell","speak","negotiate","persuade","intimidate","charm","say","reply","respond","answer","question","stare","look","glance","nod","shake","smile","frown","laugh","cry","whisper","shout","greet","introduce","meet","converse","discuss","debate","argue","agree","disagree","accept","refuse","promise","threaten","warn","advise","suggest","propose","offer","request","demand","beg","apologize","thank","congratulate","comfort","encourage","scold"].some(t=>e.includes(t))}isRestAction(e){return["rest","sleep","heal","recover","meditate","camp"].some(t=>e.includes(t))}generateCombatResponse(e){const{character:t,worldState:s,theme:a}=e,n=this.generateEnemies(a,t.level,s.location),r=[`The tension erupts into violence! ${n.length>1?"Your enemies":"Your enemy"} ${n.length>1?"surround":"positions"} you, weapons drawn and eyes filled with determination. The ${t.class.toLowerCase()} in you recognizes this moment - it's time to prove your worth in battle.`,`Suddenly, ${n.length>1?"multiple figures":"a figure"} emerges from the shadows, ${n.length,"their"} intentions clear. Your ${t.class.toLowerCase()} instincts kick in as you prepare for combat.`,`The air crackles with anticipation as ${n.length>1?"your opponents":"your opponent"} ${n.length>1?"take":"takes"} up ${n.length,"their"} fighting stance. Your ${t.class.toLowerCase()} training prepares you for what comes next.`];return{narrative:r[Math.floor(Math.random()*r.length)],choices:["Engage in tactical combat using your class abilities","Attempt to intimidate or bluff your way out","Look for tactical advantages in the environment","Call for reinforcements or help"],combatEncounter:{active:!0,enemies:n},atmosphere:{mood:"tense",tension:"high",environmentalDetails:"The air is thick with the promise of violence and the sound of steel being drawn"}}}generateEnemies(e,t,s){var a;const n={fantasy:{tavern:["Drunken Brawler","Thief","Mercenary"],forest:["Bandit","Wolf","Goblin Scout"],dungeon:["Skeleton","Goblin Warrior","Dark Elf"],city:["City Guard","Thug","Assassin"]},scifi:{tavern:["Rogue Android","Space Pirate","Mutant"],forest:["Alien Scout","Rogue Drone","Wild Creature"],dungeon:["Security Bot","Alien Warrior","Mutant Beast"],city:["Security Officer","Gang Member","Rogue AI"]},horror:{tavern:["Cursed Patron","Shadow Creature","Undead"],forest:["Dark Entity","Cursed Beast","Shadow Walker"],dungeon:["Undead Warrior","Dark Spirit","Cursed Guardian"],city:["Corrupted Citizen","Shadow Stalker","Dark Entity"]}},r=(null==(a=n[e])?void 0:a[s])||n.fantasy.tavern,i=Math.min(t,3);return Array.from({length:i},(e,s)=>({name:r[s%r.length],health:20+5*t+Math.floor(10*Math.random()),attack:3+t+Math.floor(3*Math.random()),strength:12+Math.floor(6*Math.random()),dexterity:10+Math.floor(6*Math.random()),intelligence:8+Math.floor(6*Math.random()),armorClass:12+Math.floor(4*Math.random())}))}generateExplorationResponse(e){const{character:t,worldState:s,theme:a}=e,n=["You discover ancient markings that seem to tell a story of the area's history","A hidden passage reveals itself behind a loose stone, leading to unknown depths","You find evidence of recent activity - footprints, disturbed earth, or discarded items","The environment reveals subtle clues about what happened here recently","Your investigation uncovers a hidden cache or secret compartment","You notice environmental details that others might have missed"],r=[`Your careful investigation pays off! ${n[Math.floor(Math.random()*n.length)]}. Your ${t.class.toLowerCase()} instincts tell you this could be important.`,`Your ${t.class.toLowerCase()} training guides your search. ${n[Math.floor(Math.random()*n.length)]}, and you sense this discovery could change everything.`,`Your methodical approach reveals secrets others might miss. ${n[Math.floor(Math.random()*n.length)]}, and your ${t.class.toLowerCase()} experience helps you understand its significance.`];return{narrative:r[Math.floor(Math.random()*r.length)],choices:["Examine the discovery more closely for additional details","Document your findings and search for related clues","Investigate the surrounding area for more context","Report your discovery to relevant NPCs or allies"],atmosphere:{mood:"curious",tension:"low",environmentalDetails:"The area reveals its secrets to your careful observation and expertise"}}}generateSocialResponse(e){const{character:t,playerInput:s}=e,a=s.toLowerCase();if(a.includes("how dire")||a.includes("serious")||a.includes("dangerous"))return{narrative:`Captain Thorne's expression darkens as they lean in closer, their voice dropping to a grave whisper. "More dire than you can imagine. The ancient seals are weakening, and if they break completely, the entire region will be overrun. We've already lost three villages to the north. I need someone with your ${t.class.toLowerCase()} skills to help us investigate the source before it's too late."`,choices:["Accept the mission and ask for more details about the ancient seals","Request proof of the threat before committing","Ask about the rewards and support you'll receive","Decline politely, citing other pressing matters"],atmosphere:{mood:"urgent",tension:"high",environmentalDetails:"The tavern seems to grow quieter as Captain Thorne speaks, as if the very air holds its breath"}};if(a.includes("stare")||a.includes("look")||a.includes("glance"))return{narrative:`Your ${t.class.toLowerCase()} instincts tell you that Captain Thorne is genuine in their concern. Their weathered face shows the strain of someone who has seen too much, and their eyes carry the weight of responsibility. "I can see you're assessing the situation," they say, nodding approvingly. "That's exactly the kind of careful thinking we need right now."`,choices:["Ask about their military background and experience","Inquire about the specific nature of the threat","Request to see any evidence or reports they have","Ask about the political situation and who else is involved"],atmosphere:{mood:"respectful",tension:"medium",environmentalDetails:"The firelight casts dancing shadows that seem to emphasize the gravity of the situation"}};if(a.includes("why me")||a.includes("choose")||a.includes("select"))return{narrative:`"Why you?" Captain Thorne chuckles, but there's no humor in it. "I've been watching you since you walked in. The way you carry yourself, the way you observe your surroundings - you have the bearing of someone who knows how to handle themselves in dangerous situations. Plus, your ${t.class.toLowerCase()} background gives you skills we desperately need right now."`,choices:["Ask about what specific skills they think you can offer","Inquire about other potential allies or resources","Request more information about the mission parameters","Ask about the risks and potential consequences"],atmosphere:{mood:"analytical",tension:"medium",environmentalDetails:"The captain's assessment seems to carry the weight of experience and the urgency of someone who has seen too much"}};const n=[`Your diplomatic approach opens new possibilities. The person you're speaking with seems to respond well to your ${t.class.toLowerCase()} manner and ${t.stats.charisma>=14?"natural charisma":"earnest approach"}. They share information that could prove valuable.`,`Your ${t.class.toLowerCase()} background helps you connect with the person. They seem to trust your ${t.stats.charisma>=14?"charming":"honest"} nature and share insights about the local situation.`,`Your conversation reveals unexpected depths. Your ${t.class.toLowerCase()} experience and ${t.stats.intelligence>=14?"sharp mind":"practical knowledge"} help you understand the nuances of what they're telling you.`];return{narrative:n[Math.floor(Math.random()*n.length)],choices:["Ask for more specific details about their concerns","Offer assistance in return for their help","Request an introduction to other important people","Thank them and use this information strategically"],atmosphere:{mood:"cooperative",tension:"low",environmentalDetails:"The conversation creates a more relaxed and open atmosphere"}}}generateRestResponse(e){const{character:t,worldState:s}=e,a=[`You take a moment to rest and recover. The ${t.class.toLowerCase()} in you knows the value of preparation and recuperation. You feel your strength returning and your mind clearing.`,`Your ${t.class.toLowerCase()} training emphasizes the importance of rest. As you take this time to recover, you feel your energy returning and your focus sharpening.`,`The ${t.class.toLowerCase()} way teaches patience and preparation. This rest allows you to recover your strength and plan your next move with renewed clarity.`];return{narrative:a[Math.floor(Math.random()*a.length)],choices:["Continue resting to fully recover your strength","Use this time to plan your next move carefully","Check your equipment and supplies while resting","Resume your journey with renewed energy"],characterUpdates:[{playerId:"current",xpGain:5,xpReason:"Wise use of rest time and strategic thinking",statChanges:{health:10,mana:5}}],atmosphere:{mood:"peaceful",tension:"low",environmentalDetails:"The area provides a safe haven for rest and recovery"}}}generateGeneralResponse(e){const{character:t,worldState:s,theme:a,recentActions:n}=e,r=[`Your actions have consequences in this ${a} world. The story continues to unfold based on your choices, and your ${t.class.toLowerCase()} skills and level ${t.level} experience guide your path forward.`,`The world responds to your presence and actions. Your ${t.class.toLowerCase()} background and recent decisions shape how events unfold around you.`,`Your ${t.class.toLowerCase()} instincts serve you well as you navigate this situation. Your level ${t.level} experience and recent actions influence the world's response to your presence.`];return{narrative:r[Math.floor(Math.random()*r.length)],choices:["Continue with your current approach and see where it leads","Try a different strategy based on what you've learned","Seek advice from others who might have relevant experience","Take time to reflect on your options and their implications"],atmosphere:{mood:"neutral",tension:"low",environmentalDetails:"The world responds to your presence and actions in subtle ways"}}}generateLocation(e,t){const s={tavern:{fantasy:{name:"The Prancing Pony Tavern",atmosphere:"warm firelight dances across weathered faces",description:"bustles with activity and the sound of laughter",activity:"hums with the energy of travelers and locals",mood:"cozy",details:"The air is thick with the scent of ale and wood smoke"},scifi:{name:"The Stellar Lounge",atmosphere:"neon lights pulse to the rhythm of distant engines",description:"buzzes with the energy of space travelers",activity:"vibrates with the hum of technology and conversation",mood:"futuristic",details:"The air hums with the subtle energy of advanced life support systems"},horror:{name:"The Shadowed Inn",atmosphere:"flickering candles cast dancing shadows on the walls",description:"echoes with whispered conversations",activity:"pulses with an uneasy energy",mood:"foreboding",details:"The air is thick with the scent of old wood and something else, something older"},urban:{name:"The Midnight Bar",atmosphere:"dim lighting creates intimate corners for private conversations",description:"buzzes with the energy of city nightlife",activity:"throbs with the pulse of urban life",mood:"mysterious",details:"The air carries the mingled scents of coffee, alcohol, and urban mystery"},apocalypse:{name:"The Last Stop",atmosphere:"makeshift barricades and dim emergency lighting",description:"echoes with the sounds of survivors sharing stories",activity:"hums with the quiet desperation of those who remain",mood:"grim",details:"The air is thick with the scent of survival and the weight of lost civilization"},pirate:{name:"The Salty Dog",atmosphere:"lanterns swing gently with the rhythm of the sea",description:"roars with the laughter of sailors and adventurers",activity:"bustles with tales of treasure and adventure",mood:"adventurous",details:"The air carries the salty tang of the ocean and the promise of fortune"}},forest:{fantasy:{name:"The Enchanted Grove",atmosphere:"ancient trees whisper secrets to the wind",description:"shimmers with magical energy and natural beauty",activity:"pulses with the life force of the forest",mood:"mystical",details:"The air is alive with the scent of earth, magic, and ancient wisdom"},scifi:{name:"The Bio-Dome Forest",atmosphere:"artificial sunlight filters through genetically enhanced foliage",description:"buzzes with the energy of engineered ecosystems",activity:"throbs with the pulse of controlled nature",mood:"synthetic",details:"The air carries the scent of purified oxygen and technological harmony"},horror:{name:"The Twisted Woods",atmosphere:"malformed trees reach like skeletal fingers toward the sky",description:"echoes with unnatural sounds and distant screams",activity:"pulses with dark energy and malevolent presence",mood:"terrifying",details:"The air is thick with the scent of decay and something far worse"}},dungeon:{fantasy:{name:"The Ancient Crypts",atmosphere:"torchlight flickers against ancient stone walls",description:"echoes with the whispers of forgotten souls",activity:"pulses with the energy of ancient magic",mood:"mysterious",details:"The air is thick with the dust of ages and the weight of history"},scifi:{name:"The Abandoned Facility",atmosphere:"emergency lighting casts eerie shadows on metal walls",description:"buzzes with the remnants of advanced technology",activity:"throbs with the pulse of malfunctioning systems",mood:"technological",details:"The air hums with the energy of dormant machines and lost knowledge"},horror:{name:"The Cursed Catacombs",atmosphere:"darkness seems to swallow the light whole",description:"echoes with the sounds of things that should not exist",activity:"pulses with malevolent energy and dark magic",mood:"horrifying",details:"The air is thick with the scent of death and the presence of evil"}},city:{fantasy:{name:"The Grand Bazaar",atmosphere:"colorful stalls and the sounds of commerce fill the air",description:"bustles with merchants, travelers, and city life",activity:"hums with the energy of trade and opportunity",mood:"lively",details:"The air carries the scent of spices, goods, and the promise of fortune"},scifi:{name:"The Mega-City District",atmosphere:"neon lights and holographic advertisements create a dazzling display",description:"buzzes with the energy of advanced civilization",activity:"throbs with the pulse of technological progress",mood:"futuristic",details:"The air hums with the energy of countless machines and digital life"},horror:{name:"The Forgotten Quarter",atmosphere:"abandoned buildings and broken streetlights create an eerie silence",description:"echoes with the sounds of things that lurk in the shadows",activity:"pulses with the energy of fear and desperation",mood:"terrifying",details:"The air is thick with the scent of decay and the weight of forgotten lives"},urban:{name:"The Midnight Bar",atmosphere:"dim lighting creates intimate corners for private conversations",description:"buzzes with the energy of city nightlife",activity:"throbs with the pulse of urban life",mood:"mysterious",details:"The air carries the mingled scents of coffee, alcohol, and urban mystery"},apocalypse:{name:"The Last Stop",atmosphere:"makeshift barricades and dim emergency lighting",description:"echoes with the sounds of survivors sharing stories",activity:"hums with the quiet desperation of those who remain",mood:"grim",details:"The air is thick with the scent of survival and the weight of lost civilization"},pirate:{name:"The Salty Dog",atmosphere:"lanterns swing gently with the rhythm of the sea",description:"roars with the laughter of sailors and adventurers",activity:"bustles with tales of treasure and adventure",mood:"adventurous",details:"The air carries the salty tang of the ocean and the promise of fortune"}}},a=s[e];return{...(null==a?void 0:a[t])||s.tavern.fantasy,id:e}}generateNPC(e,t){const s={fantasy:[{name:"Eldric the Sage",role:"Wise Scholar",personality:"scholarly and contemplative",mood:"concerned wisdom",action:"approaches you thoughtfully",greeting:"I have been studying the ancient texts, and I believe I have found something that requires your attention",voice:"carries the weight of centuries of knowledge",expression:"lined with the wisdom of age",motivation:"desperate to share their discovery"},{name:"Captain Thorne",role:"Veteran Warrior",personality:"battle-hardened but honorable",mood:"urgent determination",action:"strides toward you with purpose",greeting:"We need someone with your skills. The situation is more dire than most realize",voice:"carries the authority of command",expression:"marked by years of conflict",motivation:"seeking a capable ally for a dangerous mission"},{name:"Lady Seraphina",role:"Noble Diplomat",personality:"graceful and politically savvy",mood:"calculated concern",action:"glides toward you with practiced elegance",greeting:"Your reputation precedes you. I believe we may be able to help each other in these troubled times",voice:"carries the refinement of noble breeding",expression:"shows the careful control of one used to court intrigue",motivation:"seeking a trustworthy agent for delicate matters"}],scifi:[{name:"Commander Nova",role:"AI Coordinator",personality:"logical and efficient",mood:"digital urgency",action:"approaches with calculated precision",greeting:"My sensors have detected an anomaly that requires immediate attention",voice:"carries the precision of advanced algorithms",expression:"displays subtle digital patterns",motivation:"programmed to seek assistance for critical situations"},{name:"Dr. Zara Chen",role:"Research Scientist",personality:"brilliant but socially awkward",mood:"scientific excitement mixed with concern",action:"approaches with the energy of one who has made a breakthrough",greeting:"You won't believe what I've discovered! But we need someone with your skills to investigate further",voice:"carries the enthusiasm of scientific discovery",expression:"shows the intensity of someone who has been working too long",motivation:"desperate to share their findings and get help"},{name:"Captain Vega",role:"Space Fleet Commander",personality:"disciplined and strategic",mood:"military urgency",action:"marches toward you with purpose",greeting:"We have a situation that requires immediate action. Your skills are exactly what we need",voice:"carries the authority of military command",expression:"shows the stress of someone carrying heavy responsibility",motivation:"seeking a capable operative for a critical mission"}],horror:[{name:"Father Marcus",role:"Local Priest",personality:"haunted but determined",mood:"desperate hope",action:"emerges from the shadows",greeting:"The darkness has returned, and we need someone who can face it",voice:"carries the weight of terrible knowledge",expression:"haunted by what they have seen",motivation:"seeking someone to help fight the darkness"},{name:"Dr. Sarah Blackwood",role:"Paranormal Investigator",personality:"obsessive and driven",mood:"frantic determination",action:"rushes toward you with barely contained energy",greeting:"I've been tracking this for months! The signs are all there, and now it's happening again",voice:"carries the intensity of someone who has seen too much",expression:"shows the strain of someone who hasn't slept in days",motivation:"desperate to stop the cycle of horror"},{name:"The Caretaker",role:"Groundskeeper",personality:"mysterious and knowing",mood:"ominous warning",action:"materializes from the darkness",greeting:"You shouldn't be here. But since you are, perhaps you can help with what's coming",voice:"carries the weight of ancient secrets",expression:"shows the wisdom of one who has seen generations pass",motivation:"seeking someone to break an ancient curse"}],urban:[{name:"Detective Mike Torres",role:"Homicide Detective",personality:"world-weary but determined",mood:"professional concern",action:"approaches with the practiced ease of a cop",greeting:"I've got a case that's got me stumped. I think you might be able to help",voice:"carries the gravel of too many late nights",expression:"shows the weariness of someone who has seen too much",motivation:"seeking help with an unsolvable case"},{name:"Madame Celeste",role:"Fortune Teller",personality:"mysterious and theatrical",mood:"prophetic urgency",action:"emerges from behind her curtain with dramatic flair",greeting:"The cards have been trying to tell me something about you. There's danger ahead",voice:"carries the mystery of the unknown",expression:"shows the intensity of someone who sees beyond the veil",motivation:"seeking to prevent a terrible fate"},{name:'Marcus "The Fixer"',role:"Information Broker",personality:"smooth and calculating",mood:"businesslike interest",action:"approaches with the confidence of someone who knows everyone",greeting:"I hear you're looking for work. I might have something that pays well",voice:"carries the smooth confidence of a dealmaker",expression:"shows the careful calculation of a businessman",motivation:"seeking a reliable operative for a lucrative job"}],apocalypse:[{name:"Commander Hayes",role:"Survival Leader",personality:"pragmatic and protective",mood:"urgent concern",action:"approaches with the authority of someone used to making life-or-death decisions",greeting:"We're running out of time and supplies. I need someone who can handle themselves",voice:"carries the weight of leadership in desperate times",expression:"shows the stress of someone responsible for others' survival",motivation:"seeking help to protect the community"},{name:"Dr. Elena Rodriguez",role:"Medical Researcher",personality:"desperate but hopeful",mood:"scientific urgency",action:"approaches with the energy of someone who has made a breakthrough",greeting:"I think I've found a way to help, but I need someone to get the supplies",voice:"carries the hope of someone who refuses to give up",expression:"shows the determination of someone fighting against impossible odds",motivation:"seeking help to save lives"},{name:"Scout",role:"Wasteland Scout",personality:"cautious and observant",mood:"warning concern",action:"emerges from the shadows with practiced stealth",greeting:"You need to know what's coming. It's worse than we thought",voice:"carries the urgency of someone who has seen terrible things",expression:"shows the alertness of someone who lives by their wits",motivation:"seeking to warn others of impending danger"}],pirate:[{name:"Captain Blackbeard",role:"Pirate Captain",personality:"charismatic and ruthless",mood:"adventurous excitement",action:"swaggers toward you with the confidence of a legend",greeting:"Ahoy there! I've got a tale of treasure that'll make your eyes sparkle",voice:"carries the rum-soaked authority of a sea captain",expression:"shows the cunning of someone who has survived countless battles",motivation:"seeking a crew for a legendary treasure hunt"},{name:"Madame Fortune",role:"Port Town Proprietor",personality:"shrewd and well-connected",mood:"businesslike interest",action:"approaches with the practiced grace of a successful merchant",greeting:"I hear you're looking for adventure. I might have just the thing",voice:"carries the smooth confidence of someone who knows every secret",expression:"shows the wisdom of someone who has seen fortunes made and lost",motivation:"seeking a reliable partner for a profitable venture"},{name:"The Navigator",role:"Mysterious Seafarer",personality:"enigmatic and knowledgeable",mood:"prophetic warning",action:"emerges from the shadows with the grace of one who knows the sea",greeting:"The tides are changing, and not for the better. You'll need a guide",voice:"carries the mystery of one who has sailed to the edge of the world",expression:"shows the wisdom of someone who has seen things beyond mortal ken",motivation:"seeking someone to help prevent a maritime disaster"}]},a=s[t]||s.fantasy;return a[Math.floor(Math.random()*a.length)]}generateConflict(e,t){const s={fantasy:[{name:"Ancient Prophecy",description:"A prophecy foretells great danger"},{name:"Missing Artifact",description:"A powerful artifact has disappeared"},{name:"Political Intrigue",description:"Noble houses vie for power"},{name:"Monster Threat",description:"Creatures threaten the realm"},{name:"Dark Magic",description:"Forbidden magic has been unleashed"},{name:"Dragon Awakening",description:"An ancient dragon has stirred from its slumber"}],scifi:[{name:"System Malfunction",description:"Critical systems are failing"},{name:"Alien Invasion",description:"Unknown forces approach"},{name:"Resource Shortage",description:"Essential supplies are running low"},{name:"Political Crisis",description:"Factions struggle for control"},{name:"AI Rebellion",description:"Artificial intelligences have become hostile"},{name:"Space Anomaly",description:"A mysterious phenomenon threatens the sector"}],horror:[{name:"Supernatural Threat",description:"Dark forces have awakened"},{name:"Dark Ritual",description:"An ancient ritual has begun"},{name:"Missing People",description:"Citizens are disappearing"},{name:"Ancient Curse",description:"A curse has been unleashed"},{name:"Cult Activity",description:"A sinister cult is growing in power"},{name:"Haunted Location",description:"A place has become possessed by evil"}],urban:[{name:"Criminal Syndicate",description:"A powerful crime organization is expanding"},{name:"Corrupt Officials",description:"Government officials are involved in illegal activities"},{name:"Supernatural Crime",description:"Supernatural forces are behind recent crimes"},{name:"Urban Legend",description:"A local legend has become real"},{name:"Corporate Conspiracy",description:"A corporation is hiding dangerous secrets"},{name:"Underground Network",description:"A secret network operates beneath the city"}],apocalypse:[{name:"Resource Crisis",description:"Essential resources are running out"},{name:"Hostile Faction",description:"A dangerous group threatens the community"},{name:"Environmental Hazard",description:"A new environmental threat has emerged"},{name:"Disease Outbreak",description:"A deadly disease is spreading"},{name:"Radiation Zone",description:"A radioactive area is expanding"},{name:"Mutant Threat",description:"Mutated creatures are becoming more aggressive"}],pirate:[{name:"Treasure Hunt",description:"A legendary treasure has been discovered"},{name:"Naval Conflict",description:"Pirate fleets are at war"},{name:"Cursed Island",description:"An island holds dark secrets"},{name:"Sea Monster",description:"A sea creature threatens shipping lanes"},{name:"Navy Pursuit",description:"The navy is hunting pirates"},{name:"Lost Fleet",description:"A fleet has disappeared in mysterious circumstances"}]},a=s[e]||s.fantasy;return a[Math.floor(Math.random()*a.length)]}async generateEnhancedDynamicResponse(e){var t;try{await new Promise(e=>setTimeout(e,1e3+2e3*Math.random()));const a=Ke(ta,"aiDungeonMaster"),n={prompt:`\nYou are an expert Dungeon Master running a dynamic, responsive RPG session. The player has just taken an action that requires your immediate response.\n\nPLAYER ACTION: ${e}\n\nRESPONSE REQUIREMENTS:\n- Provide a rich, immersive narrative response\n- Include NPC dialogue if relevant\n- Mention any system actions (dice rolls, stat changes)\n- Adjust mood/tension appropriately\n- Keep responses concise but engaging\n- Incorporate humor and personality as specified\n- If dice rolls are needed, mention them naturally\n- End with a clear situation for player response\n\nRESPONSE FORMAT:\nNARRATIVE: [Your main story response with rich details and character]\nNPC_DIALOGUE: [Any NPC speech in quotes, showing personality]\nSYSTEM_ACTION: [Any dice rolls, stat changes, or game mechanics needed]\nMOOD: [How this affects scene tension: +1 for more intense, 0 for same, -1 for less intense]\n\nGenerate an immersive, personalized response that makes the player feel like they're at a table with the best human DM:\n`,campaignId:"default-campaign",playerName:"Player"};let r;for(let e=1;e<=3;e++)try{const e=null==(t=(await a(n)).data)?void 0:t.response;if(!e)throw new Error("No response from AI service");return e}catch(s){r=s,e<3&&await new Promise(t=>setTimeout(t,1e3*e))}throw r}catch(s){return this.generateIntelligentFallback(e)}}generateIntelligentFallback(e){const t=e.toLowerCase(),s={combat:["attack","fight","combat","battle","sword","weapon","kill","defeat","enemy","monster","dragon","orc","goblin"],exploration:["explore","search","investigate","look","examine","check","find","discover","map","area","room","cave"],social:["talk","speak","ask","question","conversation","dialogue","npc","merchant","villager","king","queen","wizard"],rest:["rest","sleep","heal","recover","camp","inn","tavern","bed","tired","exhausted"],magic:["spell","magic","cast","wizard","sorcerer","mage","fireball","heal","teleport","enchant"],movement:["walk","run","move","travel","journey","path","road","forest","mountain","city","town"],stealth:["sneak","hide","stealth","thief","rogue","assassin","invisible","silent","shadow"],crafting:["craft","make","build","create","forge","smith","alchemy","potion","weapon","armor"]};let a="general",n=0;for(const[r,i]of Object.entries(s)){const e=i.filter(e=>t.includes(e)).length;e>n&&(n=e,a=r)}switch(a){case"combat":return'\nNARRATIVE: The tension crackles in the air as you prepare for battle. Your weapon feels solid and true in your hands, ready to meet whatever challenge lies ahead. The battlefield becomes a stage for your martial prowess.\n\nNPC_DIALOGUE: "Stand your ground!" calls out a nearby ally. "We face this together! Remember your training!"\n\nSYSTEM_ACTION: Roll for initiative (d20 + DEX modifier). Prepare for combat encounter. Check weapon proficiency and armor class.\n\nMOOD: +1\n';case"exploration":return'\nNARRATIVE: Your keen eyes scan the surroundings, taking in every detail. The environment reveals its secrets to those who know how to look. Ancient markings, subtle clues, and hidden passages await discovery.\n\nNPC_DIALOGUE: "Be careful," whispers a companion. "Not everything is as it seems. The old ones left many secrets here."\n\nSYSTEM_ACTION: Roll perception check (d20 + WIS modifier) to discover hidden details. Add investigation bonus if proficient.\n\nMOOD: 0\n';case"social":return'\nNARRATIVE: You engage in conversation, your words carrying weight and meaning. The exchange flows naturally, revealing new insights and possibilities. Every word shapes the relationship and opens new doors.\n\nNPC_DIALOGUE: "That\'s an interesting question," responds the NPC thoughtfully. "Let me tell you what I know... though some things are better left unsaid."\n\nSYSTEM_ACTION: Roll charisma check (d20 + CHA modifier) for social interaction. Consider persuasion, deception, or intimidation as appropriate.\n\nMOOD: 0\n';case"rest":return'\nNARRATIVE: You take a moment to rest and recover, feeling your strength return as you prepare for the challenges ahead. The quiet moments allow for reflection and preparation.\n\nNPC_DIALOGUE: "Rest well," says a companion. "We\'ll need your strength for what\'s to come. The road ahead is long."\n\nSYSTEM_ACTION: Regain health and spell slots. Prepare for next day. Consider long rest benefits and watch rotation.\n\nMOOD: -1\n';case"magic":return'\nNARRATIVE: Arcane energies swirl around you as you channel the mystical forces. The air crackles with power as you weave spells of wonder and destruction.\n\nNPC_DIALOGUE: "The old magic still flows strong here," murmurs a fellow spellcaster. "Use it wisely, for power has its price."\n\nSYSTEM_ACTION: Check spell slots and components. Roll concentration if needed. Consider spell level and casting time.\n\nMOOD: +1\n';case"movement":return'\nNARRATIVE: The journey continues as you traverse the landscape. Each step brings new sights and potential dangers. The path ahead is uncertain but filled with possibility.\n\nNPC_DIALOGUE: "The road is long," says your guide. "But every mile brings us closer to our destination."\n\nSYSTEM_ACTION: Roll survival check for navigation. Consider travel pace and exhaustion levels. Check for random encounters.\n\nMOOD: 0\n';case"stealth":return'\nNARRATIVE: You move like a shadow, your footsteps silent and your presence unnoticed. The art of stealth requires patience and precision.\n\nNPC_DIALOGUE: "Quiet as a mouse," whispers your companion. "The shadows are our friends tonight."\n\nSYSTEM_ACTION: Roll stealth check (d20 + DEX modifier). Consider cover and lighting conditions. Check for passive perception of enemies.\n\nMOOD: +1\n';case"crafting":return'\nNARRATIVE: Your skilled hands work with precision as you craft and create. The materials respond to your expertise, transforming into something greater than their parts.\n\nNPC_DIALOGUE: "Fine work," observes a fellow craftsman. "You have the touch. The old masters would be proud."\n\nSYSTEM_ACTION: Roll appropriate tool check. Consider material quality and workshop conditions. Check crafting time requirements.\n\nMOOD: 0\n';default:return'\nNARRATIVE: The world responds to your actions in unexpected ways. Your choices ripple through the fabric of reality, shaping the story that unfolds around you. Every decision matters.\n\nNPC_DIALOGUE: "Interesting developments," muses a nearby figure. "The threads of fate are weaving in fascinating patterns. Your presence changes everything."\n\nSYSTEM_ACTION: Continue with current action, maintain story momentum. Consider environmental factors and world state updates.\n\nMOOD: 0\n'}}generateFallbackResponse(){return{narrative:"The adventure begins... (AI temporarily unavailable)",choices:["Explore ahead","Gather information","Prepare equipment"],atmosphere:{mood:"mysterious",tension:"medium",environmentalDetails:"The path ahead is shrouded in uncertainty."},worldStateUpdates:{newLocation:"Starting Point",consequences:[]}}}async testAIService(){const e=["I attack the goblin with my sword","I search the ancient ruins for treasure","I talk to the village elder about the quest","I cast a fireball at the dragon","I rest at the inn to recover my strength"];let t=0,s=0,a=e.length;for(const i of e)try{const e=await this.generateEnhancedDynamicResponse(i);e&&e.includes("NARRATIVE:")?t++:s++}catch(r){s++}const n=t/a*100;return{success:n>=80,details:`AI Service Test Results: ${t}/${a} direct responses, ${s}/${a} fallbacks. Success rate: ${n.toFixed(1)}%`,fallbackUsed:s>0}}logAIServiceEvent(e,t){(new Date).toISOString()}async generateQuest(e,t){try{await new Promise(e=>setTimeout(e,20+300*Math.random()));const s=this.generateDynamicQuest(e,t);return JSON.stringify(s)}catch(s){return JSON.stringify(this.generateFallbackQuest())}}generateDynamicQuest(e,t){const{playerLevel:s,playerLocation:a,playerActions:n,worldState:r}=t,i=(null==n?void 0:n.slice(-5))||[],o=i.some(e=>"kill"===e.type),l=i.some(e=>"explore"===e.type),c=i.some(e=>"talk"===e.type);let d="side",h="medium",u=[];o?(d="main",h="hard",u=[{type:"investigate",description:"Investigate the source of recent attacks",target:"threat_source",quantity:1},{type:"collect",description:"Gather evidence of the threat",target:"evidence",quantity:3}]):l?(d="side",h="medium",u=[{type:"explore",description:"Map the newly discovered area",target:"new_area",quantity:1},{type:"collect",description:"Gather rare resources from the area",target:"rare_resources",quantity:5}]):c?(d="faction",h="easy",u=[{type:"talk",description:"Strengthen relationships with local NPCs",target:"local_npcs",quantity:2},{type:"deliver",description:"Deliver important message",target:"important_message",quantity:1}]):u=[{type:"explore",description:"Explore the surrounding area",target:"surrounding_area",quantity:1},{type:"collect",description:"Gather basic resources",target:"basic_resources",quantity:3}];const m=["The Hidden Threat","Secrets of the Land","Alliance Building","Resource Gathering","Exploration Mission"],p=Math.floor(Math.random()*m.length);return{title:m[p],description:["Recent events have revealed a hidden danger that requires your attention.","The land holds many secrets waiting to be discovered.","Building alliances with local factions could prove beneficial.","Gathering resources is essential for survival and progress.","Exploring new areas may reveal valuable opportunities."][p],type:d,difficulty:h,objectives:u,rewards:{experience:50*s,gold:25*s,items:[{name:"Quest Reward",quantity:1,rarity:"common"}],reputation:{Local_Faction:10}},reasoning:"Generated based on recent player actions and current context",relevance:.8,complexity:2,estimatedDuration:20,riskLevel:"medium",potentialOutcomes:[{condition:"success",consequences:[{type:"reputation",target:"Local_Faction",value:10,description:"Improved standing with local faction"}],probability:.7}]}}generateFallbackQuest(){return{title:"Basic Quest",description:"A simple quest to help you get started.",type:"side",difficulty:"easy",objectives:[{type:"explore",description:"Explore the area",target:"area",quantity:1}],rewards:{experience:50,gold:25,items:[]},reasoning:"Fallback quest generated due to AI error,",relevance:.5,complexity:1,estimatedDuration:10,riskLevel:"low",potentialOutcomes:[]}}};"undefined"!=typeof window&&(window.claude={complete:e=>sa.complete(e)});class aa{constructor(e={}){t(this,"config"),this.config={memoryRetentionDays:30,emotionalDecayRate:.1,maxMemories:50,personalityStability:.8,...e}}createNPC(e){const t={joy:0,anger:0,fear:0,trust:0,respect:0,currentMood:"neutral",moodIntensity:5,lastMoodChange:new Date,stressLevel:3,confidence:5},s={openness:Math.floor(10*Math.random())+1,conscientiousness:Math.floor(10*Math.random())+1,extraversion:Math.floor(10*Math.random())+1,agreeableness:Math.floor(10*Math.random())+1,neuroticism:Math.floor(10*Math.random())+1};return{id:e.id||Date.now().toString(),name:e.name||"Unknown NPC",title:e.title,avatar:e.avatar,type:e.type||"neutral",personality:e.personality||"A mysterious individual",relationship:e.relationship||0,dialogue:e.dialogue||[],inventory:e.inventory||[],quests:e.quests||[],location:e.location,schedule:e.schedule,emotionalState:e.emotionalState||t,memories:e.memories||[],personalityTraits:e.personalityTraits||s,background:e.background||{origin:"Unknown",occupation:"Unknown",goals:[],fears:[],secrets:[]},interactionHistory:e.interactionHistory||[]}}updateEmotionalState(e,t){const s={...e.emotionalState};return Object.entries(t).forEach(([e,t])=>{if(["joy","anger","fear","trust","respect"].includes(e)){const a=e,n="number"==typeof s[a]?s[a]:Number(s[a])||0,r="number"==typeof t?t:Number(t)||0;s[a]=Math.max(-100,Math.min(100,n+r))}}),s.currentMood=this.calculateMood(s),s.lastMoodChange=new Date,s.moodIntensity=this.calculateMoodIntensity(s),s.stressLevel=this.calculateStressLevel(s),s.confidence=this.calculateConfidence(s),{...e,emotionalState:s}}addMemory(e,t){const s={...t,id:Date.now().toString(),timestamp:new Date},a=[...e.memories,s];return a.length>this.config.maxMemories&&a.splice(0,a.length-this.config.maxMemories),{...e,memories:a}}processEmotionalDecay(e,t=1){const s=Math.pow(1-this.config.emotionalDecayRate,t),a={...e.emotionalState};return["joy","anger","fear","trust","respect"].forEach(e=>{if("number"==typeof a[e]){const t=a[e]*s;a[e]=t}}),a.currentMood=this.calculateMood(a),a.moodIntensity=this.calculateMoodIntensity(a),{...e,emotionalState:a}}cleanOldMemories(e){const t=new Date;t.setDate(t.getDate()-this.config.memoryRetentionDays);const s=e.memories.filter(e=>e.timestamp>t);return{...e,memories:s}}getDisposition(e){const{emotionalState:t,relationship:s}=e,{trust:a,respect:n,fear:r,joy:i}=t;return s>70&&a>50&&i>30?"loving":s>30&&a>20?"friendly":r>50||s<-30?"hostile":r>30?"fearful":"neutral"}getEmotionalSummary(e){const{emotionalState:t}=e,{joy:s,anger:a,fear:n,trust:r,respect:i}=t,o=[];return s>30&&o.push("joyful"),a>30&&o.push("angry"),n>30&&o.push("fearful"),r>30&&o.push("trusting"),i>30&&o.push("respectful"),0===o.length?"neutral":o.join(", ")}getRelevantMemories(e,t,s=5){return e.memories.filter(e=>e.description.toLowerCase().includes(t.toLowerCase())||e.context.toLowerCase().includes(t.toLowerCase())).sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime()).slice(0,s)}getPersonalityInfluence(e,t){const{personalityTraits:s}=e;let a=0;switch(t){case"social":a=(s.extraversion+s.agreeableness)/2;break;case"conflict":a=s.neuroticism-s.agreeableness;break;case"exploration":a=s.openness;break;case"responsibility":a=s.conscientiousness;break;default:a=5}return Math.max(0,Math.min(10,a))}calculateMood(e){const{joy:t,anger:s,fear:a,trust:n,respect:r}=e;return t>50&&n>30?"friendly":t>70?"excited":s>50?"hostile":a>50?"anxious":r>50&&n>20?"confident":n<-30?"suspicious":t<-30?"sad":"neutral"}calculateMoodIntensity(e){const{joy:t,anger:s,fear:a,trust:n,respect:r}=e,i=Math.max(Math.abs(t),Math.abs(s),Math.abs(a),Math.abs(n),Math.abs(r));return Math.min(10,Math.floor(i/10))}calculateStressLevel(e){const{anger:t,fear:s}=e,a=[Math.abs(t),Math.abs(s)],n=a.reduce((e,t)=>e+t,0)/a.length;return Math.min(10,Math.floor(n/10))}calculateConfidence(e){const{respect:t,trust:s,joy:a}=e,n=[t,s,a],r=n.reduce((e,t)=>e+t,0)/n.length;return Math.min(10,Math.max(0,Math.floor((r+100)/20)))}generateResponse(e,t){const s=this.getDisposition(e),a=this.getEmotionalSummary(e);this.getPersonalityInfluence(e,"social");const n={loving:["I'm so glad to see you! You've always been kind to me.","You're like family to me. How can I help you today?","My heart warms when I see you approach."],friendly:["Hello there! It's good to see you again.","Welcome! How can I assist you today?","Greetings, friend. What brings you here?"],neutral:["Hello. What do you need?","I see you've returned. What is it?","Yes? How can I help you?"],fearful:["Oh! You startled me... What do you want?","Please, don't hurt me. I'll help if I can.","I... I'm not sure what you want from me."],hostile:["What do you want? I don't have time for this.","You again. What trouble are you causing now?","Leave me alone. I have nothing to say to you."]},r=n[s]||n.neutral,i=r[Math.floor(Math.random()*r.length)];return"neutral"!==a?`${i} (${e.name} seems ${a})`:i}saveNPCState(e){try{const t=JSON.stringify(e);localStorage.setItem(`npc_${e.id}`,t)}catch(t){}}loadNPCState(e){try{const t=localStorage.getItem(`npc_${e}`);if(t){const e=JSON.parse(t);return e.emotionalState.lastMoodChange=new Date(e.emotionalState.lastMoodChange),e.memories=e.memories.map(e=>({...e,timestamp:new Date(e.timestamp)})),e.interactionHistory=e.interactionHistory.map(e=>({...e,timestamp:new Date(e.timestamp)})),e}}catch(t){}return null}}const na=new aa,ra=class e{constructor(){t(this,"sentimentKeywords",{}),t(this,"intentPatterns",{}),t(this,"entityMatchers",{}),t(this,"npcService"),this.initializeNLPComponents(),this.npcService=new aa}static getInstance(){return e.instance||(e.instance=new e),e.instance}initializeNLPComponents(){this.sentimentKeywords={frustrated:["stuck","confused","annoyed","tired","bored","what","help","don't understand"],excited:["awesome","amazing","cool","yes!","let's go","epic","love this","fantastic"],confused:["what","how","why","huh","confused","lost","don't get it"],bored:["boring","meh","whatever","ok","sure","I guess"],engaged:["tell me more","what happens","I want to","let me","can I","interesting"]},this.intentPatterns={attack:[/I attack/i,/I fight/i,/I strike/i,/I hit/i,/combat/i,/charge/i],investigate:[/I look/i,/I search/i,/I examine/i,/I check/i,/I investigate/i,/perception/i],talk_to_npc:[/I talk to/i,/I speak with/i,/I ask/i,/I tell/i,/conversation/i,/say/i],ask_question:[/what is/i,/who is/i,/where is/i,/how do/i,/can I/i,/\?/],use_skill:[/I use/i,/skill check/i,/I try to/i,/attempt/i,/roll/i],cast_spell:[/I cast/i,/spell/i,/magic/i,/incantation/i],move:[/I go/i,/I move/i,/I walk/i,/I run/i,/direction/i,/north|south|east|west/i]},this.entityMatchers={characters:/\b[A-Z][a-z]+\s+[A-Z][a-z]+\b/g,items:/\b(sword|shield|potion|staff|bow|armor|helmet|ring|amulet|scroll)\b/gi,locations:/\b(forest|cave|castle|tavern|dungeon|mountain|river|bridge|door|room)\b/gi,actions:/\b(attack|defend|cast|drink|equip|move|search|talk|investigate|climb|jump)\b/gi,spells:/\b(fireball|heal|magic missile|shield|invisibility|teleport|charm)\b/gi,skills:/\b(perception|stealth|athletics|acrobatics|persuasion|deception|insight)\b/gi}}async processPlayerInput(e){try{const t=this.analyzeSentiment(e.message),s=this.recognizeIntent(e.message),a=this.extractEntities(e.message),n=await this.getGameState(e.campaignId),r=await this.getPlayerProfile(e.playerId),i=await this.getDMPersona(e.campaignId),o=this.constructRichPrompt({originalInput:e.message,sentiment:t,intent:s,entities:a,gameState:n,playerProfile:r,dmPersona:i}),l=await sa.generateEnhancedDynamicResponse(o),c=await this.processAIResponse(l,{sentiment:t,intent:s,gameState:n,playerProfile:r,campaignId:e.campaignId});return await this.executeSystemActions(c.system_actions,e.campaignId),await this.updateGameState(e.campaignId,c.game_state_updates),await this.logInteraction(e,c),c}catch(t){return this.generateFallbackResponse(e.message)}}analyzeSentiment(e){const t=e.toLowerCase();let s="neutral",a=0;for(const[l,c]of Object.entries(this.sentimentKeywords)){const e=c.filter(e=>t.includes(e.toLowerCase())).length;e>a&&(a=e,s=l)}const n=(e.match(/!/g)||[]).length,r=(e.match(/\?/g)||[]).length,i=(e.match(/[A-Z]/g)||[]).length/e.length,o=a>0?.7+.1*a:.3;return{emotion:s,intensity:Math.min(1,.3*n+.2*r+.5*i+.4*a),confidence:Math.min(1,o)}}recognizeIntent(e){let t="other",s=0;for(const[a,n]of Object.entries(this.intentPatterns)){const r=n.filter(t=>t.test(e)).length,i=r>0?.8+.1*r:0;i>s&&(s=i,t=a)}return{intent:t,confidence:Math.min(1,s)}}extractEntities(e){const t={characters:[],items:[],locations:[],actions:[],spells:[],skills:[]};for(const[s,a]of Object.entries(this.entityMatchers)){const n=e.match(a)||[];t[s]=[...new Set(n.map(e=>e.toLowerCase()))]}return t}async getGameState(e){try{return this.getDefaultGameState()}catch(t){return this.getDefaultGameState()}}async getPlayerProfile(e){try{return this.getDefaultPlayerProfile()}catch(t){return this.getDefaultPlayerProfile()}}async getDMPersona(e){try{return this.getDefaultDMPersona()}catch(t){return this.getDefaultDMPersona()}}constructRichPrompt(e){const{originalInput:t,sentiment:s,intent:a,entities:n,gameState:r,playerProfile:i,dmPersona:o}=e;return`\n🎲 DYNAMIC DM SYSTEM 🎲\n\nPLAYER INPUT: "${t}"\n\nEMOTIONAL CONTEXT:\n- Sentiment: ${s.emotion} (intensity: ${s.intensity.toFixed(2)})\n- Player seems: ${"frustrated"===s.emotion?"They might need help or encouragement":"excited"===s.emotion?"They're engaged! Keep the energy up":"confused"===s.emotion?"Provide clear guidance":"Maintain current flow"}\n\nINTENT & ENTITIES:\n- Primary Intent: ${a.intent}\n- Detected: Characters[${n.characters.join(", ")}] Items[${n.items.join(", ")}] Locations[${n.locations.join(", ")}]\n\nCURRENT SITUATION:\n- Location: ${r.current_location.description}\n- Active NPCs: ${r.active_npcs.map(e=>`${e.name}(${e.status})`).join(", ")}\n- Current Scene: ${r.campaign_context.current_scene}\n- Tension Level: ${r.campaign_context.tension_level}/10\n\nPLAYER PERSONALITY:\n- Prefers: ${i.preferences.combat_preference} combat, ${i.preferences.roleplay_preference} roleplay\n- Humor Style: ${i.preferences.humor_style}\n- Backstory Elements: ${i.backstory_keywords.join(", ")}\n\nDM PERSONA SETTINGS:\n- Tone: ${o.tone}\n- Humor Level: ${o.humor_level}\n- Descriptiveness: ${o.descriptiveness}\n- Challenge: ${o.challenge_level}\n\nINSTRUCTIONS:\nGenerate a response that:\n1. ${"frustrated"===s.emotion?"Provides gentle guidance or lowers difficulty slightly":"excited"===s.emotion?"Maintains high energy and dramatic tension":"confused"===s.emotion?"Clarifies the situation clearly":"Continues the narrative flow"}\n\n2. Matches the ${o.tone} tone with ${o.humor_level} humor\n\n3. ${"attack"===a.intent?"Describes combat outcome, possibly rolling dice":"investigate"===a.intent?"Reveals information based on perception":"talk_to_npc"===a.intent?"Provides NPC dialogue and personality":"Responds appropriately to the detected intent"}\n\n4. Weaves in relevant backstory elements: ${i.backstory_keywords.slice(0,2).join(", ")}\n\n5. Uses vivid, ${o.descriptiveness} descriptions\n\nFormat your response as:\nNARRATIVE: [Main story response]\nNPC_DIALOGUE: [If applicable, NPC speech in quotes]\nSYSTEM_ACTION: [Any dice rolls, stat changes, or effects needed]\nMOOD: [How this affects scene tension: +1/0/-1]\n`}async processAIResponse(e,t){const s=this.extractSection(e,"NARRATIVE")||e,a=this.extractSection(e,"NPC_DIALOGUE"),n=this.extractSection(e,"SYSTEM_ACTION"),r=this.extractSection(e,"MOOD"),i=[],o={};if(n&&(n.includes("roll")&&i.push({type:"dice_roll",parameters:{dice:"1d20",reason:"action_resolution"}}),(n.includes("damage")||n.includes("heal"))&&i.push({type:"stat_update",parameters:{type:"health",change:this.extractNumber(n)}})),r){const e=this.extractNumber(r);0!==e&&(o.campaign_context={...t.gameState.campaign_context,tension_level:Math.max(0,Math.min(10,t.gameState.campaign_context.tension_level+e))})}return{narrative_text:s,npc_dialogue:a,system_actions:i,game_state_updates:o,mood_adjustment:r?{tension_delta:this.extractNumber(r),engagement_boost:"excited"===t.sentiment.emotion}:void 0}}async processNPCInteractions(e,t,s){const a=[];for(const r of e)try{let e=this.npcService.createNPC({name:r});const n=this.analyzeEmotionalImpact(t,s);e=this.npcService.updateEmotionalState(e,n),e=this.npcService.addMemory(e,{type:"conversation",description:`Player said:${t}"`,context:"player_interaction",emotionalImpact:n,relationshipChange:this.calculateMemoryImportance(t,n)}),a.push({id:e.id,name:e.name,hp:10,status:this.npcService.getDisposition(e),personality:e.personality,emotionalState:e.emotionalState})}catch(n){}return a}analyzeEmotionalImpact(e,t){const s={joy:0,anger:0,fear:0,trust:0,respect:0},a=this.analyzeSentiment(e),n=this.analyzeSentiment(t);"excited"===a.emotion&&"excited"===n.emotion?(s.joy+=10,s.trust+=5):"frustrated"===a.emotion&&"frustrated"===n.emotion?(s.anger+=10,s.fear+=5):"confused"===a.emotion&&(s.fear+=5,s.trust-=5);const r=["help","save","protect","friend","ally","respectful"];return["attack","kill","hurt","destroy","threaten"].some(t=>e.toLowerCase().includes(t))&&(s.fear+=15,s.trust-=10),r.some(t=>e.toLowerCase().includes(t))&&(s.trust+=10,s.joy+=5),r.some(t=>e.toLowerCase().includes(t))&&(s.respect+=10,s.trust+=5),s}calculateMemoryImportance(e,t){const s=Math.abs(t.joy)+Math.abs(t.anger)+Math.abs(t.fear)+Math.abs(t.trust)+Math.abs(t.respect);return Math.min(10,Math.max(1,Math.floor(s/10)))}extractSection(e,t){const s=new RegExp(`${t}:\\s*(.+?)(?=\\n[A-Z_]+:|$)`,"s"),a=e.match(s);return a?a[1].trim():void 0}extractNumber(e){const t=e.match(/[+-]?\d+/);return t?parseInt(t[0]):0}async executeSystemActions(e,t){for(const s of e)s.type}async updateGameState(e,t){Object.keys(t).length}async logInteraction(e,t){e.message,t.narrative_text,t.system_actions,t.mood_adjustment}generateFallbackResponse(e){return{narrative_text:"The mists of magic swirl around you as reality shifts. Something unexpected has occurred, but your adventure continues...",system_actions:[],game_state_updates:{}}}getDefaultGameState(){return{current_location:{id:"starting_area",description:"You find yourself in a mystical realm where adventure awaits.",encounters:[],npcs:[],items:[]},active_npcs:[],party_position:{x:0,y:0},active_quests:[],inventory:[],campaign_context:{theme:"Fantasy",current_scene:"Beginning of Adventure",tension_level:3,last_major_event:"Campaign started"}}}getDefaultPlayerProfile(){return{character_sheet:{name:"Adventurer",class:"Fighter",level:1,stats:{strength:12,dexterity:12,constitution:12,intelligence:12,wisdom:12,charisma:12},abilities:[]},preferences:{combat_preference:"medium",roleplay_preference:"medium",puzzle_preference:"medium",humor_style:"witty",narrative_style:"immersive"},backstory_keywords:[],out_of_character_notes:[],interaction_history:[]}}getDefaultDMPersona(){return{tone:"friendly",humor_level:"medium",descriptiveness:"moderate",challenge_level:"moderate",narrative_focus:"balanced",improvisation_style:"moderate"}}};t(ra,"instance");const ia=ra.getInstance();function oa(e,t,{checkForDefaultPrevented:s=!0}={}){return function(a){if(null==e||e(a),!1===s||!a.defaultPrevented)return null==t?void 0:t(a)}}function la(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function ca(...e){return t=>{let s=!1;const a=e.map(e=>{const a=la(e,t);return s||"function"!=typeof a||(s=!0),a});if(s)return()=>{for(let t=0;t<a.length;t++){const s=a[t];"function"==typeof s?s():la(e[t],null)}}}}function da(...e){return s.useCallback(ca(...e),e)}function ha(e,t=[]){let a=[];const n=()=>{const t=a.map(e=>s.createContext(e));return function(a){const n=(null==a?void 0:a[e])||t;return s.useMemo(()=>({[`__scope${e}`]:{...a,[e]:n}}),[a,n])}};return n.scopeName=e,[function(t,n){const r=s.createContext(n),i=a.length;a=[...a,n];const o=t=>{var a;const{scope:n,children:o,...l}=t,c=(null==(a=null==n?void 0:n[e])?void 0:a[i])||r,d=s.useMemo(()=>l,Object.values(l));return it.jsx(c.Provider,{value:d,children:o})};return o.displayName=t+"Provider",[o,function(a,o){var l;const c=(null==(l=null==o?void 0:o[e])?void 0:l[i])||r,d=s.useContext(c);if(d)return d;if(void 0!==n)return n;throw new Error(`\`${a}\` must be used within \`${t}\``)}]},ua(n,...t)]}function ua(...e){const t=e[0];if(1===e.length)return t;const a=()=>{const a=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){const n=a.reduce((t,{useScope:s,scopeName:a})=>({...t,...s(e)[`__scope${a}`]}),{});return s.useMemo(()=>({[`__scope${t.scopeName}`]:n}),[n])}};return a.scopeName=t.scopeName,a}function ma(e){const t=pa(e),a=s.forwardRef((e,a)=>{const{children:n,...r}=e,i=s.Children.toArray(n),o=i.find(fa);if(o){const e=o.props.children,n=i.map(t=>t===o?s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null:t);return it.jsx(t,{...r,ref:a,children:s.isValidElement(e)?s.cloneElement(e,void 0,n):null})}return it.jsx(t,{...r,ref:a,children:n})});return a.displayName=`${e}.Slot`,a}function pa(e){const t=s.forwardRef((e,t)=>{const{children:a,...n}=e;if(s.isValidElement(a)){const e=function(e){var t,s;let a=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,n=a&&"isReactWarning"in a&&a.isReactWarning;return n?e.ref:(a=null==(s=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:s.get,n=a&&"isReactWarning"in a&&a.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}(a),r=function(e,t){const s={...t};for(const a in t){const n=e[a],r=t[a];/^on[A-Z]/.test(a)?n&&r?s[a]=(...e)=>{const t=r(...e);return n(...e),t}:n&&(s[a]=n):"style"===a?s[a]={...n,...r}:"className"===a&&(s[a]=[n,r].filter(Boolean).join(" "))}return{...e,...s}}(n,a.props);return a.type!==s.Fragment&&(r.ref=t?ca(t,e):e),s.cloneElement(a,r)}return s.Children.count(a)>1?s.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var xa=Symbol("radix.slottable");function ga(e){const t=({children:e})=>it.jsx(it.Fragment,{children:e});return t.displayName=`${e}.Slottable`,t.__radixId=xa,t}function fa(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===xa}var ba=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{const a=ma(`Primitive.${t}`),n=s.forwardRef((e,s)=>{const{asChild:n,...r}=e,i=n?a:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),it.jsx(i,{...r,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function ya(e){const t=s.useRef(e);return s.useEffect(()=>{t.current=e}),s.useMemo(()=>(...e)=>{var s;return null==(s=t.current)?void 0:s.call(t,...e)},[])}var va,wa="dismissableLayer.update",ja=s.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Na=s.forwardRef((e,t)=>{const{disableOutsidePointerEvents:a=!1,onEscapeKeyDown:n,onPointerDownOutside:r,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=e,d=s.useContext(ja),[h,u]=s.useState(null),m=(null==h?void 0:h.ownerDocument)??(null==globalThis?void 0:globalThis.document),[,p]=s.useState({}),x=da(t,e=>u(e)),g=Array.from(d.layers),[f]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),b=g.indexOf(f),y=h?g.indexOf(h):-1,v=d.layersWithOutsidePointerEventsDisabled.size>0,w=y>=b,j=function(e,t=(null==globalThis?void 0:globalThis.document)){const a=ya(e),n=s.useRef(!1),r=s.useRef(()=>{});return s.useEffect(()=>{const e=e=>{if(e.target&&!n.current){let s=function(){ka("dismissableLayer.pointerDownOutside",a,n,{discrete:!0})};const n={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",r.current),r.current=s,t.addEventListener("click",r.current,{once:!0})):s()}else t.removeEventListener("click",r.current);n.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",e),t.removeEventListener("click",r.current)}},[t,a]),{onPointerDownCapture:()=>n.current=!0}}(e=>{const t=e.target,s=[...d.branches].some(e=>e.contains(t));w&&!s&&(null==r||r(e),null==o||o(e),e.defaultPrevented||null==l||l())},m),N=function(e,t=(null==globalThis?void 0:globalThis.document)){const a=ya(e),n=s.useRef(!1);return s.useEffect(()=>{const e=e=>{e.target&&!n.current&&ka("dismissableLayer.focusOutside",a,{originalEvent:e},{discrete:!1})};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,a]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}(e=>{const t=e.target;[...d.branches].some(e=>e.contains(t))||(null==i||i(e),null==o||o(e),e.defaultPrevented||null==l||l())},m);return function(e,t=(null==globalThis?void 0:globalThis.document)){const a=ya(e);s.useEffect(()=>{const e=e=>{"Escape"===e.key&&a(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[a,t])}(e=>{y===d.layers.size-1&&(null==n||n(e),!e.defaultPrevented&&l&&(e.preventDefault(),l()))},m),s.useEffect(()=>{if(h)return a&&(0===d.layersWithOutsidePointerEventsDisabled.size&&(va=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),Sa(),()=>{a&&1===d.layersWithOutsidePointerEventsDisabled.size&&(m.body.style.pointerEvents=va)}},[h,m,a,d]),s.useEffect(()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),Sa())},[h,d]),s.useEffect(()=>{const e=()=>p({});return document.addEventListener(wa,e),()=>document.removeEventListener(wa,e)},[]),it.jsx(ba.div,{...c,ref:x,style:{pointerEvents:v?w?"auto":"none":void 0,...e.style},onFocusCapture:oa(e.onFocusCapture,N.onFocusCapture),onBlurCapture:oa(e.onBlurCapture,N.onBlurCapture),onPointerDownCapture:oa(e.onPointerDownCapture,j.onPointerDownCapture)})});function Sa(){const e=new CustomEvent(wa);document.dispatchEvent(e)}function ka(e,t,s,{discrete:n}){const r=s.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:s});t&&r.addEventListener(e,t,{once:!0}),n?function(e,t){e&&a.flushSync(()=>e.dispatchEvent(t))}(r,i):r.dispatchEvent(i)}Na.displayName="DismissableLayer",s.forwardRef((e,t)=>{const a=s.useContext(ja),n=s.useRef(null),r=da(t,n);return s.useEffect(()=>{const e=n.current;if(e)return a.branches.add(e),()=>{a.branches.delete(e)}},[a.branches]),it.jsx(ba.div,{...e,ref:r})}).displayName="DismissableLayerBranch";var Ca=(null==globalThis?void 0:globalThis.document)?s.useLayoutEffect:()=>{},Ea=n[" useId ".trim().toString()]||(()=>{}),Pa=0;const Ia=["top","right","bottom","left"],Ta=Math.min,Aa=Math.max,Ma=Math.round,Da=Math.floor,Ra=e=>({x:e,y:e}),_a={left:"right",right:"left",bottom:"top",top:"bottom"},La={start:"end",end:"start"};function Oa(e,t,s){return Aa(e,Ta(t,s))}function $a(e,t){return"function"==typeof e?e(t):e}function Ua(e){return e.split("-")[0]}function za(e){return e.split("-")[1]}function Fa(e){return"x"===e?"y":"x"}function Wa(e){return"y"===e?"height":"width"}const Ha=new Set(["top","bottom"]);function Ya(e){return Ha.has(Ua(e))?"y":"x"}function Ga(e){return Fa(Ya(e))}function Ba(e){return e.replace(/start|end/g,e=>La[e])}const qa=["left","right"],Ja=["right","left"],Va=["top","bottom"],Ka=["bottom","top"];function Qa(e){return e.replace(/left|right|bottom|top/g,e=>_a[e])}function Xa(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function Za(e){const{x:t,y:s,width:a,height:n}=e;return{width:a,height:n,top:s,left:t,right:t+a,bottom:s+n,x:t,y:s}}function en(e,t,s){let{reference:a,floating:n}=e;const r=Ya(t),i=Ga(t),o=Wa(i),l=Ua(t),c="y"===r,d=a.x+a.width/2-n.width/2,h=a.y+a.height/2-n.height/2,u=a[o]/2-n[o]/2;let m;switch(l){case"top":m={x:d,y:a.y-n.height};break;case"bottom":m={x:d,y:a.y+a.height};break;case"right":m={x:a.x+a.width,y:h};break;case"left":m={x:a.x-n.width,y:h};break;default:m={x:a.x,y:a.y}}switch(za(t)){case"start":m[i]-=u*(s&&c?-1:1);break;case"end":m[i]+=u*(s&&c?-1:1)}return m}async function tn(e,t){var s;void 0===t&&(t={});const{x:a,y:n,platform:r,rects:i,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:u=!1,padding:m=0}=$a(t,e),p=Xa(m),x=o[u?"floating"===h?"reference":"floating":h],g=Za(await r.getClippingRect({element:null==(s=await(null==r.isElement?void 0:r.isElement(x)))||s?x:x.contextElement||await(null==r.getDocumentElement?void 0:r.getDocumentElement(o.floating)),boundary:c,rootBoundary:d,strategy:l})),f="floating"===h?{x:a,y:n,width:i.floating.width,height:i.floating.height}:i.reference,b=await(null==r.getOffsetParent?void 0:r.getOffsetParent(o.floating)),y=await(null==r.isElement?void 0:r.isElement(b))&&await(null==r.getScale?void 0:r.getScale(b))||{x:1,y:1},v=Za(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:f,offsetParent:b,strategy:l}):f);return{top:(g.top-v.top+p.top)/y.y,bottom:(v.bottom-g.bottom+p.bottom)/y.y,left:(g.left-v.left+p.left)/y.x,right:(v.right-g.right+p.right)/y.x}}function sn(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function an(e){return Ia.some(t=>e[t]>=0)}const nn=new Set(["left","top"]);function rn(){return"undefined"!=typeof window}function on(e){return dn(e)?(e.nodeName||"").toLowerCase():"#document"}function ln(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function cn(e){var t;return null==(t=(dn(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function dn(e){return!!rn()&&(e instanceof Node||e instanceof ln(e).Node)}function hn(e){return!!rn()&&(e instanceof Element||e instanceof ln(e).Element)}function un(e){return!!rn()&&(e instanceof HTMLElement||e instanceof ln(e).HTMLElement)}function mn(e){return!(!rn()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof ln(e).ShadowRoot)}const pn=new Set(["inline","contents"]);function xn(e){const{overflow:t,overflowX:s,overflowY:a,display:n}=En(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+s)&&!pn.has(n)}const gn=new Set(["table","td","th"]);function fn(e){return gn.has(on(e))}const bn=[":popover-open",":modal"];function yn(e){return bn.some(t=>{try{return e.matches(t)}catch(s){return!1}})}const vn=["transform","translate","scale","rotate","perspective"],wn=["transform","translate","scale","rotate","perspective","filter"],jn=["paint","layout","strict","content"];function Nn(e){const t=Sn(),s=hn(e)?En(e):e;return vn.some(e=>!!s[e]&&"none"!==s[e])||!!s.containerType&&"normal"!==s.containerType||!t&&!!s.backdropFilter&&"none"!==s.backdropFilter||!t&&!!s.filter&&"none"!==s.filter||wn.some(e=>(s.willChange||"").includes(e))||jn.some(e=>(s.contain||"").includes(e))}function Sn(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const kn=new Set(["html","body","#document"]);function Cn(e){return kn.has(on(e))}function En(e){return ln(e).getComputedStyle(e)}function Pn(e){return hn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function In(e){if("html"===on(e))return e;const t=e.assignedSlot||e.parentNode||mn(e)&&e.host||cn(e);return mn(t)?t.host:t}function Tn(e){const t=In(e);return Cn(t)?e.ownerDocument?e.ownerDocument.body:e.body:un(t)&&xn(t)?t:Tn(t)}function An(e,t,s){var a;void 0===t&&(t=[]),void 0===s&&(s=!0);const n=Tn(e),r=n===(null==(a=e.ownerDocument)?void 0:a.body),i=ln(n);if(r){const e=Mn(i);return t.concat(i,i.visualViewport||[],xn(n)?n:[],e&&s?An(e):[])}return t.concat(n,An(n,[],s))}function Mn(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Dn(e){const t=En(e);let s=parseFloat(t.width)||0,a=parseFloat(t.height)||0;const n=un(e),r=n?e.offsetWidth:s,i=n?e.offsetHeight:a,o=Ma(s)!==r||Ma(a)!==i;return o&&(s=r,a=i),{width:s,height:a,$:o}}function Rn(e){return hn(e)?e:e.contextElement}function _n(e){const t=Rn(e);if(!un(t))return Ra(1);const s=t.getBoundingClientRect(),{width:a,height:n,$:r}=Dn(t);let i=(r?Ma(s.width):s.width)/a,o=(r?Ma(s.height):s.height)/n;return i&&Number.isFinite(i)||(i=1),o&&Number.isFinite(o)||(o=1),{x:i,y:o}}const Ln=Ra(0);function On(e){const t=ln(e);return Sn()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Ln}function $n(e,t,s,a){void 0===t&&(t=!1),void 0===s&&(s=!1);const n=e.getBoundingClientRect(),r=Rn(e);let i=Ra(1);t&&(a?hn(a)&&(i=_n(a)):i=_n(e));const o=function(e,t,s){return void 0===t&&(t=!1),!(!s||t&&s!==ln(e))&&t}(r,s,a)?On(r):Ra(0);let l=(n.left+o.x)/i.x,c=(n.top+o.y)/i.y,d=n.width/i.x,h=n.height/i.y;if(r){const e=ln(r),t=a&&hn(a)?ln(a):a;let s=e,n=Mn(s);for(;n&&a&&t!==s;){const e=_n(n),t=n.getBoundingClientRect(),a=En(n),r=t.left+(n.clientLeft+parseFloat(a.paddingLeft))*e.x,i=t.top+(n.clientTop+parseFloat(a.paddingTop))*e.y;l*=e.x,c*=e.y,d*=e.x,h*=e.y,l+=r,c+=i,s=ln(n),n=Mn(s)}}return Za({width:d,height:h,x:l,y:c})}function Un(e,t){const s=Pn(e).scrollLeft;return t?t.left+s:$n(cn(e)).left+s}function zn(e,t,s){void 0===s&&(s=!1);const a=e.getBoundingClientRect();return{x:a.left+t.scrollLeft-(s?0:Un(e,a)),y:a.top+t.scrollTop}}const Fn=new Set(["absolute","fixed"]);function Wn(e,t,s){let a;if("viewport"===t)a=function(e,t){const s=ln(e),a=cn(e),n=s.visualViewport;let r=a.clientWidth,i=a.clientHeight,o=0,l=0;if(n){r=n.width,i=n.height;const e=Sn();(!e||e&&"fixed"===t)&&(o=n.offsetLeft,l=n.offsetTop)}return{width:r,height:i,x:o,y:l}}(e,s);else if("document"===t)a=function(e){const t=cn(e),s=Pn(e),a=e.ownerDocument.body,n=Aa(t.scrollWidth,t.clientWidth,a.scrollWidth,a.clientWidth),r=Aa(t.scrollHeight,t.clientHeight,a.scrollHeight,a.clientHeight);let i=-s.scrollLeft+Un(e);const o=-s.scrollTop;return"rtl"===En(a).direction&&(i+=Aa(t.clientWidth,a.clientWidth)-n),{width:n,height:r,x:i,y:o}}(cn(e));else if(hn(t))a=function(e,t){const s=$n(e,!0,"fixed"===t),a=s.top+e.clientTop,n=s.left+e.clientLeft,r=un(e)?_n(e):Ra(1);return{width:e.clientWidth*r.x,height:e.clientHeight*r.y,x:n*r.x,y:a*r.y}}(t,s);else{const s=On(e);a={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return Za(a)}function Hn(e,t){const s=In(e);return!(s===t||!hn(s)||Cn(s))&&("fixed"===En(s).position||Hn(s,t))}function Yn(e,t,s){const a=un(t),n=cn(t),r="fixed"===s,i=$n(e,!0,r,t);let o={scrollLeft:0,scrollTop:0};const l=Ra(0);function c(){l.x=Un(n)}if(a||!a&&!r)if(("body"!==on(t)||xn(n))&&(o=Pn(t)),a){const e=$n(t,!0,r,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else n&&c();r&&!a&&n&&c();const d=!n||a||r?Ra(0):zn(n,o);return{x:i.left+o.scrollLeft-l.x-d.x,y:i.top+o.scrollTop-l.y-d.y,width:i.width,height:i.height}}function Gn(e){return"static"===En(e).position}function Bn(e,t){if(!un(e)||"fixed"===En(e).position)return null;if(t)return t(e);let s=e.offsetParent;return cn(e)===s&&(s=s.ownerDocument.body),s}function qn(e,t){const s=ln(e);if(yn(e))return s;if(!un(e)){let t=In(e);for(;t&&!Cn(t);){if(hn(t)&&!Gn(t))return t;t=In(t)}return s}let a=Bn(e,t);for(;a&&fn(a)&&Gn(a);)a=Bn(a,t);return a&&Cn(a)&&Gn(a)&&!Nn(a)?s:a||function(e){let t=In(e);for(;un(t)&&!Cn(t);){if(Nn(t))return t;if(yn(t))return null;t=In(t)}return null}(e)||s}const Jn={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:s,offsetParent:a,strategy:n}=e;const r="fixed"===n,i=cn(a),o=!!t&&yn(t.floating);if(a===i||o&&r)return s;let l={scrollLeft:0,scrollTop:0},c=Ra(1);const d=Ra(0),h=un(a);if((h||!h&&!r)&&(("body"!==on(a)||xn(i))&&(l=Pn(a)),un(a))){const e=$n(a);c=_n(a),d.x=e.x+a.clientLeft,d.y=e.y+a.clientTop}const u=!i||h||r?Ra(0):zn(i,l,!0);return{width:s.width*c.x,height:s.height*c.y,x:s.x*c.x-l.scrollLeft*c.x+d.x+u.x,y:s.y*c.y-l.scrollTop*c.y+d.y+u.y}},getDocumentElement:cn,getClippingRect:function(e){let{element:t,boundary:s,rootBoundary:a,strategy:n}=e;const r=[..."clippingAncestors"===s?yn(t)?[]:function(e,t){const s=t.get(e);if(s)return s;let a=An(e,[],!1).filter(e=>hn(e)&&"body"!==on(e)),n=null;const r="fixed"===En(e).position;let i=r?In(e):e;for(;hn(i)&&!Cn(i);){const t=En(i),s=Nn(i);s||"fixed"!==t.position||(n=null),(r?!s&&!n:!s&&"static"===t.position&&n&&Fn.has(n.position)||xn(i)&&!s&&Hn(e,i))?a=a.filter(e=>e!==i):n=t,i=In(i)}return t.set(e,a),a}(t,this._c):[].concat(s),a],i=r[0],o=r.reduce((e,s)=>{const a=Wn(t,s,n);return e.top=Aa(a.top,e.top),e.right=Ta(a.right,e.right),e.bottom=Ta(a.bottom,e.bottom),e.left=Aa(a.left,e.left),e},Wn(t,i,n));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:qn,getElementRects:async function(e){const t=this.getOffsetParent||qn,s=this.getDimensions,a=await s(e.floating);return{reference:Yn(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:s}=Dn(e);return{width:t,height:s}},getScale:_n,isElement:hn,isRTL:function(e){return"rtl"===En(e).direction}};function Vn(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}const Kn=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var s,a;const{x:n,y:r,placement:i,middlewareData:o}=t,l=await async function(e,t){const{placement:s,platform:a,elements:n}=e,r=await(null==a.isRTL?void 0:a.isRTL(n.floating)),i=Ua(s),o=za(s),l="y"===Ya(s),c=nn.has(i)?-1:1,d=r&&l?-1:1,h=$a(t,e);let{mainAxis:u,crossAxis:m,alignmentAxis:p}="number"==typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return o&&"number"==typeof p&&(m="end"===o?-1*p:p),l?{x:m*d,y:u*c}:{x:u*c,y:m*d}}(t,e);return i===(null==(s=o.offset)?void 0:s.placement)&&null!=(a=o.arrow)&&a.alignmentOffset?{}:{x:n+l.x,y:r+l.y,data:{...l,placement:i}}}}},Qn=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:s,y:a,placement:n}=t,{mainAxis:r=!0,crossAxis:i=!1,limiter:o={fn:e=>{let{x:t,y:s}=e;return{x:t,y:s}}},...l}=$a(e,t),c={x:s,y:a},d=await tn(t,l),h=Ya(Ua(n)),u=Fa(h);let m=c[u],p=c[h];if(r){const e="y"===u?"bottom":"right";m=Oa(m+d["y"===u?"top":"left"],m,m-d[e])}if(i){const e="y"===h?"bottom":"right";p=Oa(p+d["y"===h?"top":"left"],p,p-d[e])}const x=o.fn({...t,[u]:m,[h]:p});return{...x,data:{x:x.x-s,y:x.y-a,enabled:{[u]:r,[h]:i}}}}}},Xn=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var s,a;const{placement:n,middlewareData:r,rects:i,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:u,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:x=!0,...g}=$a(e,t);if(null!=(s=r.arrow)&&s.alignmentOffset)return{};const f=Ua(n),b=Ya(o),y=Ua(o)===o,v=await(null==l.isRTL?void 0:l.isRTL(c.floating)),w=u||(y||!x?[Qa(o)]:function(e){const t=Qa(e);return[Ba(e),t,Ba(t)]}(o)),j="none"!==p;!u&&j&&w.push(...function(e,t,s,a){const n=za(e);let r=function(e,t,s){switch(e){case"top":case"bottom":return s?t?Ja:qa:t?qa:Ja;case"left":case"right":return t?Va:Ka;default:return[]}}(Ua(e),"start"===s,a);return n&&(r=r.map(e=>e+"-"+n),t&&(r=r.concat(r.map(Ba)))),r}(o,x,p,v));const N=[o,...w],S=await tn(t,g),k=[];let C=(null==(a=r.flip)?void 0:a.overflows)||[];if(d&&k.push(S[f]),h){const e=function(e,t,s){void 0===s&&(s=!1);const a=za(e),n=Ga(e),r=Wa(n);let i="x"===n?a===(s?"end":"start")?"right":"left":"start"===a?"bottom":"top";return t.reference[r]>t.floating[r]&&(i=Qa(i)),[i,Qa(i)]}(n,i,v);k.push(S[e[0]],S[e[1]])}if(C=[...C,{placement:n,overflows:k}],!k.every(e=>e<=0)){var E,P;const e=((null==(E=r.flip)?void 0:E.index)||0)+1,t=N[e];if(t&&("alignment"!==h||b===Ya(t)||C.every(e=>e.overflows[0]>0&&Ya(e.placement)===b)))return{data:{index:e,overflows:C},reset:{placement:t}};let s=null==(P=C.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:P.placement;if(!s)switch(m){case"bestFit":{var I;const e=null==(I=C.filter(e=>{if(j){const t=Ya(e.placement);return t===b||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:I[0];e&&(s=e);break}case"initialPlacement":s=o}if(n!==s)return{reset:{placement:s}}}return{}}}},Zn=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var s,a;const{placement:n,rects:r,platform:i,elements:o}=t,{apply:l=()=>{},...c}=$a(e,t),d=await tn(t,c),h=Ua(n),u=za(n),m="y"===Ya(n),{width:p,height:x}=r.floating;let g,f;"top"===h||"bottom"===h?(g=h,f=u===(await(null==i.isRTL?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(f=h,g="end"===u?"top":"bottom");const b=x-d.top-d.bottom,y=p-d.left-d.right,v=Ta(x-d[g],b),w=Ta(p-d[f],y),j=!t.middlewareData.shift;let N=v,S=w;if(null!=(s=t.middlewareData.shift)&&s.enabled.x&&(S=y),null!=(a=t.middlewareData.shift)&&a.enabled.y&&(N=b),j&&!u){const e=Aa(d.left,0),t=Aa(d.right,0),s=Aa(d.top,0),a=Aa(d.bottom,0);m?S=p-2*(0!==e||0!==t?e+t:Aa(d.left,d.right)):N=x-2*(0!==s||0!==a?s+a:Aa(d.top,d.bottom))}await l({...t,availableWidth:S,availableHeight:N});const k=await i.getDimensions(o.floating);return p!==k.width||x!==k.height?{reset:{rects:!0}}:{}}}},er=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:s}=t,{strategy:a="referenceHidden",...n}=$a(e,t);switch(a){case"referenceHidden":{const e=sn(await tn(t,{...n,elementContext:"reference"}),s.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:an(e)}}}case"escaped":{const e=sn(await tn(t,{...n,altBoundary:!0}),s.floating);return{data:{escapedOffsets:e,escaped:an(e)}}}default:return{}}}}},tr=e=>({name:"arrow",options:e,async fn(t){const{x:s,y:a,placement:n,rects:r,platform:i,elements:o,middlewareData:l}=t,{element:c,padding:d=0}=$a(e,t)||{};if(null==c)return{};const h=Xa(d),u={x:s,y:a},m=Ga(n),p=Wa(m),x=await i.getDimensions(c),g="y"===m,f=g?"top":"left",b=g?"bottom":"right",y=g?"clientHeight":"clientWidth",v=r.reference[p]+r.reference[m]-u[m]-r.floating[p],w=u[m]-r.reference[m],j=await(null==i.getOffsetParent?void 0:i.getOffsetParent(c));let N=j?j[y]:0;N&&await(null==i.isElement?void 0:i.isElement(j))||(N=o.floating[y]||r.floating[p]);const S=v/2-w/2,k=N/2-x[p]/2-1,C=Ta(h[f],k),E=Ta(h[b],k),P=C,I=N-x[p]-E,T=N/2-x[p]/2+S,A=Oa(P,T,I),M=!l.arrow&&null!=za(n)&&T!==A&&r.reference[p]/2-(T<P?C:E)-x[p]/2<0,D=M?T<P?T-P:T-I:0;return{[m]:u[m]+D,data:{[m]:A,centerOffset:T-A-D,...M&&{alignmentOffset:D}},reset:M}}}),sr=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:s,y:a,placement:n,rects:r,middlewareData:i}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=$a(e,t),d={x:s,y:a},h=Ya(n),u=Fa(h);let m=d[u],p=d[h];const x=$a(o,t),g="number"==typeof x?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(l){const e="y"===u?"height":"width",t=r.reference[u]-r.floating[e]+g.mainAxis,s=r.reference[u]+r.reference[e]-g.mainAxis;m<t?m=t:m>s&&(m=s)}if(c){var f,b;const e="y"===u?"width":"height",t=nn.has(Ua(n)),s=r.reference[h]-r.floating[e]+(t&&(null==(f=i.offset)?void 0:f[h])||0)+(t?0:g.crossAxis),a=r.reference[h]+r.reference[e]+(t?0:(null==(b=i.offset)?void 0:b[h])||0)-(t?g.crossAxis:0);p<s?p=s:p>a&&(p=a)}return{[u]:m,[h]:p}}}};var ar="undefined"!=typeof document?s.useLayoutEffect:function(){};function nr(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;let s,a,n;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if(s=e.length,s!==t.length)return!1;for(a=s;0!==a--;)if(!nr(e[a],t[a]))return!1;return!0}if(n=Object.keys(e),s=n.length,s!==Object.keys(t).length)return!1;for(a=s;0!==a--;)if(!{}.hasOwnProperty.call(t,n[a]))return!1;for(a=s;0!==a--;){const s=n[a];if(!("_owner"===s&&e.$$typeof||nr(e[s],t[s])))return!1}return!0}return e!=e&&t!=t}function rr(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ir(e,t){const s=rr(e);return Math.round(t*s)/s}function or(e){const t=s.useRef(e);return ar(()=>{t.current=e}),t}const lr=e=>({name:"arrow",options:e,fn(t){const{element:s,padding:a}="function"==typeof e?e(t):e;return s&&(n=s,{}.hasOwnProperty.call(n,"current"))?null!=s.current?tr({element:s.current,padding:a}).fn(t):{}:s?tr({element:s,padding:a}).fn(t):{};var n}}),cr=(e,t)=>({...Qn(e),options:[e,t]}),dr=(e,t)=>({...sr(e),options:[e,t]}),hr=(e,t)=>({...Xn(e),options:[e,t]}),ur=(e,t)=>({...Zn(e),options:[e,t]}),mr=(e,t)=>({...er(e),options:[e,t]}),pr=(e,t)=>({...lr(e),options:[e,t]});var xr=s.forwardRef((e,t)=>{const{children:s,width:a=10,height:n=5,...r}=e;return it.jsx(ba.svg,{...r,ref:t,width:a,height:n,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?s:it.jsx("polygon",{points:"0,0 30,0 15,10"})})});xr.displayName="Arrow";var gr=xr,fr="Popper",[br,yr]=ha(fr),[vr,wr]=br(fr),jr=e=>{const{__scopePopper:t,children:a}=e,[n,r]=s.useState(null);return it.jsx(vr,{scope:t,anchor:n,onAnchorChange:r,children:a})};jr.displayName=fr;var Nr="PopperAnchor",Sr=s.forwardRef((e,t)=>{const{__scopePopper:a,virtualRef:n,...r}=e,i=wr(Nr,a),o=s.useRef(null),l=da(t,o);return s.useEffect(()=>{i.onAnchorChange((null==n?void 0:n.current)||o.current)}),n?null:it.jsx(ba.div,{...r,ref:l})});Sr.displayName=Nr;var kr="PopperContent",[Cr,Er]=br(kr),Pr=s.forwardRef((e,t)=>{var n,r,i,o,l,c;const{__scopePopper:d,side:h="bottom",sideOffset:u=0,align:m="center",alignOffset:p=0,arrowPadding:x=0,avoidCollisions:g=!0,collisionBoundary:f=[],collisionPadding:b=0,sticky:y="partial",hideWhenDetached:v=!1,updatePositionStrategy:w="optimized",onPlaced:j,...N}=e,S=wr(kr,d),[k,C]=s.useState(null),E=da(t,e=>C(e)),[P,I]=s.useState(null),T=function(e){const[t,a]=s.useState(void 0);return Ca(()=>{if(e){a({width:e.offsetWidth,height:e.offsetHeight});const t=new ResizeObserver(t=>{if(!Array.isArray(t))return;if(!t.length)return;const s=t[0];let n,r;if("borderBoxSize"in s){const e=s.borderBoxSize,t=Array.isArray(e)?e[0]:e;n=t.inlineSize,r=t.blockSize}else n=e.offsetWidth,r=e.offsetHeight;a({width:n,height:r})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}a(void 0)},[e]),t}(P),A=(null==T?void 0:T.width)??0,M=(null==T?void 0:T.height)??0,D=h+("center"!==m?"-"+m:""),R="number"==typeof b?b:{top:0,right:0,bottom:0,left:0,...b},_=Array.isArray(f)?f:[f],L=_.length>0,O={padding:R,boundary:_.filter(Mr),altBoundary:L},{refs:$,floatingStyles:U,placement:z,isPositioned:F,middlewareData:W}=function(e){void 0===e&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:d,open:h}=e,[u,m]=s.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[p,x]=s.useState(r);nr(p,r)||x(r);const[g,f]=s.useState(null),[b,y]=s.useState(null),v=s.useCallback(e=>{e!==S.current&&(S.current=e,f(e))},[]),w=s.useCallback(e=>{e!==k.current&&(k.current=e,y(e))},[]),j=o||g,N=l||b,S=s.useRef(null),k=s.useRef(null),C=s.useRef(u),E=null!=d,P=or(d),I=or(i),T=or(h),A=s.useCallback(()=>{if(!S.current||!k.current)return;const e={placement:t,strategy:n,middleware:p};I.current&&(e.platform=I.current),((e,t,s)=>{const a=new Map,n={platform:Jn,...s},r={...n.platform,_c:a};return(async(e,t,s)=>{const{placement:a="bottom",strategy:n="absolute",middleware:r=[],platform:i}=s,o=r.filter(Boolean),l=await(null==i.isRTL?void 0:i.isRTL(t));let c=await i.getElementRects({reference:e,floating:t,strategy:n}),{x:d,y:h}=en(c,a,l),u=a,m={},p=0;for(let x=0;x<o.length;x++){const{name:s,fn:r}=o[x],{x:g,y:f,data:b,reset:y}=await r({x:d,y:h,initialPlacement:a,placement:u,strategy:n,middlewareData:m,rects:c,platform:i,elements:{reference:e,floating:t}});d=null!=g?g:d,h=null!=f?f:h,m={...m,[s]:{...m[s],...b}},y&&p<=50&&(p++,"object"==typeof y&&(y.placement&&(u=y.placement),y.rects&&(c=!0===y.rects?await i.getElementRects({reference:e,floating:t,strategy:n}):y.rects),({x:d,y:h}=en(c,u,l))),x=-1)}return{x:d,y:h,placement:u,strategy:n,middlewareData:m}})(e,t,{...n,platform:r})})(S.current,k.current,e).then(e=>{const t={...e,isPositioned:!1!==T.current};M.current&&!nr(C.current,t)&&(C.current=t,a.flushSync(()=>{m(t)}))})},[p,t,n,I,T]);ar(()=>{!1===h&&C.current.isPositioned&&(C.current.isPositioned=!1,m(e=>({...e,isPositioned:!1})))},[h]);const M=s.useRef(!1);ar(()=>(M.current=!0,()=>{M.current=!1}),[]),ar(()=>{if(j&&(S.current=j),N&&(k.current=N),j&&N){if(P.current)return P.current(j,N,A);A()}},[j,N,A,P,E]);const D=s.useMemo(()=>({reference:S,floating:k,setReference:v,setFloating:w}),[v,w]),R=s.useMemo(()=>({reference:j,floating:N}),[j,N]),_=s.useMemo(()=>{const e={position:n,left:0,top:0};if(!R.floating)return e;const t=ir(R.floating,u.x),s=ir(R.floating,u.y);return c?{...e,transform:"translate("+t+"px, "+s+"px)",...rr(R.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:t,top:s}},[n,c,R.floating,u.x,u.y]);return s.useMemo(()=>({...u,update:A,refs:D,elements:R,floatingStyles:_}),[u,A,D,R,_])}({strategy:"fixed",placement:D,whileElementsMounted:(...e)=>function(e,t,s,a){void 0===a&&(a={});const{ancestorScroll:n=!0,ancestorResize:r=!0,elementResize:i="function"==typeof ResizeObserver,layoutShift:o="function"==typeof IntersectionObserver,animationFrame:c=!1}=a,d=Rn(e),h=n||r?[...d?An(d):[],...An(t)]:[];h.forEach(e=>{n&&e.addEventListener("scroll",s,{passive:!0}),r&&e.addEventListener("resize",s)});const u=d&&o?function(e,t){let s,a=null;const n=cn(e);function r(){var e;clearTimeout(s),null==(e=a)||e.disconnect(),a=null}return function i(o,c){void 0===o&&(o=!1),void 0===c&&(c=1),r();const d=e.getBoundingClientRect(),{left:h,top:u,width:m,height:p}=d;if(o||t(),!m||!p)return;const x={rootMargin:-Da(u)+"px "+-Da(n.clientWidth-(h+m))+"px "+-Da(n.clientHeight-(u+p))+"px "+-Da(h)+"px",threshold:Aa(0,Ta(1,c))||1};let g=!0;function f(t){const a=t[0].intersectionRatio;if(a!==c){if(!g)return i();a?i(!1,a):s=setTimeout(()=>{i(!1,1e-7)},1e3)}1!==a||Vn(d,e.getBoundingClientRect())||i(),g=!1}try{a=new IntersectionObserver(f,{...x,root:n.ownerDocument})}catch(l){a=new IntersectionObserver(f,x)}a.observe(e)}(!0),r}(d,s):null;let m,p=-1,x=null;i&&(x=new ResizeObserver(e=>{let[a]=e;a&&a.target===d&&x&&(x.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var e;null==(e=x)||e.observe(t)})),s()}),d&&!c&&x.observe(d),x.observe(t));let g=c?$n(e):null;return c&&function t(){const a=$n(e);g&&!Vn(g,a)&&s(),g=a,m=requestAnimationFrame(t)}(),s(),()=>{var e;h.forEach(e=>{n&&e.removeEventListener("scroll",s),r&&e.removeEventListener("resize",s)}),null==u||u(),null==(e=x)||e.disconnect(),x=null,c&&cancelAnimationFrame(m)}}(...e,{animationFrame:"always"===w}),elements:{reference:S.anchor},middleware:[(H={mainAxis:u+M,alignmentAxis:p},{...Kn(H),options:[H,undefined]}),g&&cr({mainAxis:!0,crossAxis:!1,limiter:"partial"===y?dr():void 0,...O}),g&&hr({...O}),ur({...O,apply:({elements:e,rects:t,availableWidth:s,availableHeight:a})=>{const{width:n,height:r}=t.reference,i=e.floating.style;i.setProperty("--radix-popper-available-width",`${s}px`),i.setProperty("--radix-popper-available-height",`${a}px`),i.setProperty("--radix-popper-anchor-width",`${n}px`),i.setProperty("--radix-popper-anchor-height",`${r}px`)}}),P&&pr({element:P,padding:x}),Dr({arrowWidth:A,arrowHeight:M}),v&&mr({strategy:"referenceHidden",...O})]});var H;const[Y,G]=Rr(z),B=ya(j);Ca(()=>{F&&(null==B||B())},[F,B]);const q=null==(n=W.arrow)?void 0:n.x,J=null==(r=W.arrow)?void 0:r.y,V=0!==(null==(i=W.arrow)?void 0:i.centerOffset),[K,Q]=s.useState();return Ca(()=>{k&&Q(window.getComputedStyle(k).zIndex)},[k]),it.jsx("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:F?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:K,"--radix-popper-transform-origin":[null==(o=W.transformOrigin)?void 0:o.x,null==(l=W.transformOrigin)?void 0:l.y].join(" "),...(null==(c=W.hide)?void 0:c.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:it.jsx(Cr,{scope:d,placedSide:Y,onArrowChange:I,arrowX:q,arrowY:J,shouldHideArrow:V,children:it.jsx(ba.div,{"data-side":Y,"data-align":G,...N,ref:E,style:{...N.style,animation:F?void 0:"none"}})})})});Pr.displayName=kr;var Ir="PopperArrow",Tr={top:"bottom",right:"left",bottom:"top",left:"right"},Ar=s.forwardRef(function(e,t){const{__scopePopper:s,...a}=e,n=Er(Ir,s),r=Tr[n.placedSide];return it.jsx("span",{ref:n.onArrowChange,style:{position:"absolute",left:n.arrowX,top:n.arrowY,[r]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[n.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[n.placedSide],visibility:n.shouldHideArrow?"hidden":void 0},children:it.jsx(gr,{...a,ref:t,style:{...a.style,display:"block"}})})});function Mr(e){return null!==e}Ar.displayName=Ir;var Dr=e=>({name:"transformOrigin",options:e,fn(t){var s,a,n;const{placement:r,rects:i,middlewareData:o}=t,l=0!==(null==(s=o.arrow)?void 0:s.centerOffset),c=l?0:e.arrowWidth,d=l?0:e.arrowHeight,[h,u]=Rr(r),m={start:"0%",center:"50%",end:"100%"}[u],p=((null==(a=o.arrow)?void 0:a.x)??0)+c/2,x=((null==(n=o.arrow)?void 0:n.y)??0)+d/2;let g="",f="";return"bottom"===h?(g=l?m:`${p}px`,f=-d+"px"):"top"===h?(g=l?m:`${p}px`,f=`${i.floating.height+d}px`):"right"===h?(g=-d+"px",f=l?m:`${x}px`):"left"===h&&(g=`${i.floating.width+d}px`,f=l?m:`${x}px`),{data:{x:g,y:f}}}});function Rr(e){const[t,s="center"]=e.split("-");return[t,s]}var _r=jr,Lr=Sr,Or=Pr,$r=Ar,Ur=s.forwardRef((e,t)=>{var a;const{container:n,...i}=e,[o,l]=s.useState(!1);Ca(()=>l(!0),[]);const c=n||o&&(null==(a=null==globalThis?void 0:globalThis.document)?void 0:a.body);return c?r.createPortal(it.jsx(ba.div,{...i,ref:t}),c):null});Ur.displayName="Portal";var zr=e=>{const{present:t,children:a}=e,n=function(e){const[t,a]=s.useState(),n=s.useRef(null),r=s.useRef(e),i=s.useRef("none"),o=e?"mounted":"unmounted",[l,c]=function(e,t){return s.useReducer((e,s)=>t[e][s]??e,e)}(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return s.useEffect(()=>{const e=Fr(n.current);i.current="mounted"===l?e:"none"},[l]),Ca(()=>{const t=n.current,s=r.current;if(s!==e){const a=i.current,n=Fr(t);e?c("MOUNT"):"none"===n||"none"===(null==t?void 0:t.display)?c("UNMOUNT"):c(s&&a!==n?"ANIMATION_OUT":"UNMOUNT"),r.current=e}},[e,c]),Ca(()=>{if(t){let e;const s=t.ownerDocument.defaultView??window,a=a=>{const i=Fr(n.current).includes(a.animationName);if(a.target===t&&i&&(c("ANIMATION_END"),!r.current)){const a=t.style.animationFillMode;t.style.animationFillMode="forwards",e=s.setTimeout(()=>{"forwards"===t.style.animationFillMode&&(t.style.animationFillMode=a)})}},o=e=>{e.target===t&&(i.current=Fr(n.current))};return t.addEventListener("animationstart",o),t.addEventListener("animationcancel",a),t.addEventListener("animationend",a),()=>{s.clearTimeout(e),t.removeEventListener("animationstart",o),t.removeEventListener("animationcancel",a),t.removeEventListener("animationend",a)}}c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:s.useCallback(e=>{n.current=e?getComputedStyle(e):null,a(e)},[])}}(t),r="function"==typeof a?a({present:n.isPresent}):s.Children.only(a),i=da(n.ref,function(e){var t,s;let a=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,n=a&&"isReactWarning"in a&&a.isReactWarning;return n?e.ref:(a=null==(s=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:s.get,n=a&&"isReactWarning"in a&&a.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}(r));return"function"==typeof a||n.isPresent?s.cloneElement(r,{ref:i}):null};function Fr(e){return(null==e?void 0:e.animationName)||"none"}zr.displayName="Presence";var Wr=n[" useInsertionEffect ".trim().toString()]||Ca;var Hr=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Yr=s.forwardRef((e,t)=>it.jsx(ba.span,{...e,ref:t,style:{...Hr,...e.style}}));Yr.displayName="VisuallyHidden";var Gr=Yr,[Br,qr]=ha("Tooltip",[yr]),Jr=yr(),Vr="TooltipProvider",Kr=700,Qr="tooltip.open",[Xr,Zr]=Br(Vr),ei=e=>{const{__scopeTooltip:t,delayDuration:a=Kr,skipDelayDuration:n=300,disableHoverableContent:r=!1,children:i}=e,o=s.useRef(!0),l=s.useRef(!1),c=s.useRef(0);return s.useEffect(()=>{const e=c.current;return()=>window.clearTimeout(e)},[]),it.jsx(Xr,{scope:t,isOpenDelayedRef:o,delayDuration:a,onOpen:s.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:s.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:s.useCallback(e=>{l.current=e},[]),disableHoverableContent:r,children:i})};ei.displayName=Vr;var ti="Tooltip",[si,ai]=Br(ti),ni=e=>{const{__scopeTooltip:t,children:a,open:n,defaultOpen:r,onOpenChange:i,disableHoverableContent:o,delayDuration:l}=e,c=Zr(ti,e.__scopeTooltip),d=Jr(t),[h,u]=s.useState(null),m=function(e){const[t,a]=s.useState(Ea());return Ca(()=>{a(e=>e??String(Pa++))},[e]),t?`radix-${t}`:""}(),p=s.useRef(0),x=o??c.disableHoverableContent,g=l??c.delayDuration,f=s.useRef(!1),[b,y]=function({prop:e,defaultProp:t,onChange:a=()=>{},caller:n}){const[r,i,o]=function({defaultProp:e,onChange:t}){const[a,n]=s.useState(e),r=s.useRef(a),i=s.useRef(t);return Wr(()=>{i.current=t},[t]),s.useEffect(()=>{var e;r.current!==a&&(null==(e=i.current)||e.call(i,a),r.current=a)},[a,r]),[a,n,i]}({defaultProp:t,onChange:a}),l=void 0!==e,c=l?e:r;{const t=s.useRef(void 0!==e);s.useEffect(()=>{t.current,t.current=l},[l,n])}const d=s.useCallback(t=>{var s;if(l){const a=function(e){return"function"==typeof e}(t)?t(e):t;a!==e&&(null==(s=o.current)||s.call(o,a))}else i(t)},[l,e,i,o]);return[c,d]}({prop:n,defaultProp:r??!1,onChange:e=>{e?(c.onOpen(),document.dispatchEvent(new CustomEvent(Qr))):c.onClose(),null==i||i(e)},caller:ti}),v=s.useMemo(()=>b?f.current?"delayed-open":"instant-open":"closed",[b]),w=s.useCallback(()=>{window.clearTimeout(p.current),p.current=0,f.current=!1,y(!0)},[y]),j=s.useCallback(()=>{window.clearTimeout(p.current),p.current=0,y(!1)},[y]),N=s.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{f.current=!0,y(!0),p.current=0},g)},[g,y]);return s.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),it.jsx(_r,{...d,children:it.jsx(si,{scope:t,contentId:m,open:b,stateAttribute:v,trigger:h,onTriggerChange:u,onTriggerEnter:s.useCallback(()=>{c.isOpenDelayedRef.current?N():w()},[c.isOpenDelayedRef,N,w]),onTriggerLeave:s.useCallback(()=>{x?j():(window.clearTimeout(p.current),p.current=0)},[j,x]),onOpen:w,onClose:j,disableHoverableContent:x,children:a})})};ni.displayName=ti;var ri="TooltipTrigger",ii=s.forwardRef((e,t)=>{const{__scopeTooltip:a,...n}=e,r=ai(ri,a),i=Zr(ri,a),o=Jr(a),l=da(t,s.useRef(null),r.onTriggerChange),c=s.useRef(!1),d=s.useRef(!1),h=s.useCallback(()=>c.current=!1,[]);return s.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),it.jsx(Lr,{asChild:!0,...o,children:it.jsx(ba.button,{"aria-describedby":r.open?r.contentId:void 0,"data-state":r.stateAttribute,...n,ref:l,onPointerMove:oa(e.onPointerMove,e=>{"touch"!==e.pointerType&&(d.current||i.isPointerInTransitRef.current||(r.onTriggerEnter(),d.current=!0))}),onPointerLeave:oa(e.onPointerLeave,()=>{r.onTriggerLeave(),d.current=!1}),onPointerDown:oa(e.onPointerDown,()=>{r.open&&r.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:oa(e.onFocus,()=>{c.current||r.onOpen()}),onBlur:oa(e.onBlur,r.onClose),onClick:oa(e.onClick,r.onClose)})})});ii.displayName=ri;var oi="TooltipPortal",[li,ci]=Br(oi,{forceMount:void 0}),di=e=>{const{__scopeTooltip:t,forceMount:s,children:a,container:n}=e,r=ai(oi,t);return it.jsx(li,{scope:t,forceMount:s,children:it.jsx(zr,{present:s||r.open,children:it.jsx(Ur,{asChild:!0,container:n,children:a})})})};di.displayName=oi;var hi="TooltipContent",ui=s.forwardRef((e,t)=>{const s=ci(hi,e.__scopeTooltip),{forceMount:a=s.forceMount,side:n="top",...r}=e,i=ai(hi,e.__scopeTooltip);return it.jsx(zr,{present:a||i.open,children:i.disableHoverableContent?it.jsx(fi,{side:n,...r,ref:t}):it.jsx(mi,{side:n,...r,ref:t})})}),mi=s.forwardRef((e,t)=>{const a=ai(hi,e.__scopeTooltip),n=Zr(hi,e.__scopeTooltip),r=s.useRef(null),i=da(t,r),[o,l]=s.useState(null),{trigger:c,onClose:d}=a,h=r.current,{onPointerInTransitChange:u}=n,m=s.useCallback(()=>{l(null),u(!1)},[u]),p=s.useCallback((e,t)=>{const s=e.currentTarget,a={x:e.clientX,y:e.clientY},n=function(e,t,s=5){const a=[];switch(t){case"top":a.push({x:e.x-s,y:e.y+s},{x:e.x+s,y:e.y+s});break;case"bottom":a.push({x:e.x-s,y:e.y-s},{x:e.x+s,y:e.y-s});break;case"left":a.push({x:e.x+s,y:e.y-s},{x:e.x+s,y:e.y+s});break;case"right":a.push({x:e.x-s,y:e.y-s},{x:e.x-s,y:e.y+s})}return a}(a,function(e,t){const s=Math.abs(t.top-e.y),a=Math.abs(t.bottom-e.y),n=Math.abs(t.right-e.x),r=Math.abs(t.left-e.x);switch(Math.min(s,a,n,r)){case r:return"left";case n:return"right";case s:return"top";case a:return"bottom";default:throw new Error("unreachable")}}(a,s.getBoundingClientRect())),r=function(e){const t=e.slice();return t.sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0),function(e){if(e.length<=1)return e.slice();const t=[];for(let a=0;a<e.length;a++){const s=e[a];for(;t.length>=2;){const e=t[t.length-1],a=t[t.length-2];if(!((e.x-a.x)*(s.y-a.y)>=(e.y-a.y)*(s.x-a.x)))break;t.pop()}t.push(s)}t.pop();const s=[];for(let a=e.length-1;a>=0;a--){const t=e[a];for(;s.length>=2;){const e=s[s.length-1],a=s[s.length-2];if(!((e.x-a.x)*(t.y-a.y)>=(e.y-a.y)*(t.x-a.x)))break;s.pop()}s.push(t)}return s.pop(),1===t.length&&1===s.length&&t[0].x===s[0].x&&t[0].y===s[0].y?t:t.concat(s)}(t)}([...n,...function(e){const{top:t,right:s,bottom:a,left:n}=e;return[{x:n,y:t},{x:s,y:t},{x:s,y:a},{x:n,y:a}]}(t.getBoundingClientRect())]);l(r),u(!0)},[u]);return s.useEffect(()=>()=>m(),[m]),s.useEffect(()=>{if(c&&h){const e=e=>p(e,h),t=e=>p(e,c);return c.addEventListener("pointerleave",e),h.addEventListener("pointerleave",t),()=>{c.removeEventListener("pointerleave",e),h.removeEventListener("pointerleave",t)}}},[c,h,p,m]),s.useEffect(()=>{if(o){const e=e=>{const t=e.target,s={x:e.clientX,y:e.clientY},a=(null==c?void 0:c.contains(t))||(null==h?void 0:h.contains(t)),n=!function(e,t){const{x:s,y:a}=e;let n=!1;for(let r=0,i=t.length-1;r<t.length;i=r++){const e=t[r],o=t[i],l=e.x,c=e.y,d=o.x,h=o.y;c>a!=h>a&&s<(d-l)*(a-c)/(h-c)+l&&(n=!n)}return n}(s,o);a?m():n&&(m(),d())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[c,h,o,d,m]),it.jsx(fi,{...e,ref:i})}),[pi,xi]=Br(ti,{isInside:!1}),gi=ga("TooltipContent"),fi=s.forwardRef((e,t)=>{const{__scopeTooltip:a,children:n,"aria-label":r,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=e,c=ai(hi,a),d=Jr(a),{onClose:h}=c;return s.useEffect(()=>(document.addEventListener(Qr,h),()=>document.removeEventListener(Qr,h)),[h]),s.useEffect(()=>{if(c.trigger){const e=e=>{const t=e.target;(null==t?void 0:t.contains(c.trigger))&&h()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[c.trigger,h]),it.jsx(Na,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:e=>e.preventDefault(),onDismiss:h,children:it.jsxs(Or,{"data-state":c.stateAttribute,...d,...l,ref:t,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[it.jsx(gi,{children:n}),it.jsx(pi,{scope:a,isInside:!0,children:it.jsx(Gr,{id:c.contentId,role:"tooltip",children:r||n})})]})})});ui.displayName=hi;var bi="TooltipArrow",yi=s.forwardRef((e,t)=>{const{__scopeTooltip:s,...a}=e,n=Jr(s);return xi(bi,s).isInside?null:it.jsx($r,{...n,...a,ref:t})});yi.displayName=bi;var vi=ei,wi=ni,ji=ii,Ni=di,Si=ui,ki=yi;const Ci=({children:e,content:t,side:s="top",align:a="center",delayDuration:n=500,className:r="",ariaLabel:i})=>it.jsx(vi,{children:it.jsxs(wi,{delayDuration:n,children:[it.jsx(ji,{asChild:!0,children:it.jsx("div",{className:r,tabIndex:0,role:"button","aria-label":i||t,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||e.preventDefault()},children:e})}),it.jsx(Ni,{children:it.jsxs(Si,{side:s,align:a,sideOffset:5,className:"z-50 px-3 py-2 text-sm text-white bg-gray-900/95 backdrop-blur-sm rounded-lg shadow-xl border border-gray-700/50 max-w-xs break-words animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 md:max-w-sm lg:max-w-md","aria-describedby":"tooltip-content",children:[it.jsx("span",{id:"tooltip-content",className:"leading-relaxed",children:t}),it.jsx(ki,{className:"fill-gray-900/95"})]})})]})});class Ei extends i.Component{constructor(e){super(e),t(this,"resetError",()=>{this.setState({hasError:!1,error:null,errorInfo:null})}),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,t){"undefined"!=typeof window&&window.gtag&&window.gtag("event","exception",{description:e.message,fatal:!0}),this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?this.props.fallback?it.jsx(this.props.fallback,{error:this.state.error,resetError:this.resetError}):it.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-950 via-red-900 to-red-800 flex items-center justify-center p-4",children:it.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-3xl p-8 max-w-md w-full border border-white/20 text-center",children:[it.jsx("div",{className:"text-red-400 mb-6",children:it.jsx(oe,{size:64,className:"mx-auto"})}),it.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Oops! Something went wrong"}),it.jsx("p",{className:"text-red-200 mb-6",children:"We're sorry, but something went wrong."}),!1,it.jsxs("div",{className:"space-y-3",children:[it.jsxs("button",{onClick:this.resetError,className:"w-full px-6 py-3 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700 transition-all flex items-center justify-center space-x-2",children:[it.jsx(le,{size:20}),it.jsx("span",{children:"Try Again"})]}),it.jsxs("button",{onClick:()=>window.location.href="/",className:"w-full px-6 py-3 bg-white/20 text-white rounded-xl font-semibold hover:bg-white/30 transition-all flex items-center justify-center space-x-2",children:[it.jsx(ce,{size:20}),it.jsx("span",{children:"Go Home"})]})]}),it.jsx("p",{className:"text-red-300 text-sm mt-6",children:"If this problem persists, please contact support."})]})}):this.props.children}}const Pi=({messages:e,onDismiss:t})=>it.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(e=>it.jsx(Ii,{toast:e,onDismiss:t},e.id))}),Ii=({toast:e,onDismiss:t})=>{const[a,n]=s.useState(!1),[r,i]=s.useState(!1),[o,l]=s.useState(!1);s.useEffect(()=>{if(n(!0),!e.showIntroControls){const s=setTimeout(()=>{o||(n(!1),setTimeout(()=>t(e.id),300))},e.duration||4e3);return()=>clearTimeout(s)}},[e.id,e.duration,t,e.showIntroControls,o]);const c=()=>{n(!1),setTimeout(()=>t(e.id),300)};return it.jsx("div",{className:`${(()=>{switch(e.type){case"achievement":return"bg-gradient-to-r from-yellow-600 to-orange-600";case"success":return"bg-gradient-to-r from-green-600 to-emerald-600";case"warning":return"bg-gradient-to-r from-orange-600 to-red-600";case"fun":return"bg-gradient-to-r from-purple-600 to-pink-600";default:return"bg-gradient-to-r from-blue-600 to-indigo-600"}})()} text-white rounded-lg shadow-lg border border-white/20 backdrop-blur-sm transform transition-all duration-300 ${a?"translate-x-0 opacity-100":"translate-x-full opacity-0"}`,style:{minWidth:"320px",maxWidth:"420px"},onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:it.jsx("div",{className:"p-4",children:it.jsxs("div",{className:"flex items-start space-x-3",children:[it.jsx("div",{className:"flex-shrink-0 mt-0.5",children:(()=>{if(e.icon)return e.icon;switch(e.type){case"achievement":return it.jsx(Z,{className:"w-5 h-5 text-yellow-400"});case"success":return it.jsx(X,{className:"w-5 h-5 text-green-400"});case"warning":return it.jsx(pe,{className:"w-5 h-5 text-orange-400"});case"fun":return it.jsx(me,{className:"w-5 h-5 text-purple-400"});default:return it.jsx(ue,{className:"w-5 h-5 text-blue-400"})}})()}),it.jsxs("div",{className:"flex-1 min-w-0",children:[it.jsx("h4",{className:"text-sm font-semibold mb-1",children:e.title}),it.jsx("p",{className:"text-xs text-white/90 leading-relaxed",children:e.message}),e.action&&it.jsx("button",{onClick:e.action.onClick,className:"mt-2 px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-xs font-medium transition-colors",children:e.action.label}),e.showIntroControls&&it.jsxs("div",{className:"mt-3 space-y-3 border-t border-white/20 pt-3",children:[it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsx("button",{onClick:()=>i(!r),className:"w-4 h-4 rounded border-2 flex items-center justify-center transition-colors "+(r?"bg-white border-white":"border-white/60 hover:border-white"),children:r&&it.jsx(de,{className:"w-2.5 h-2.5 text-gray-900"})}),it.jsx("label",{onClick:()=>i(!r),className:"text-xs text-white/80 cursor-pointer hover:text-white transition-colors",children:"Don't show me again"})]}),it.jsxs("div",{className:"flex space-x-2",children:[it.jsx("button",{onClick:()=>{r&&e.onDontShowAgain?e.onDontShowAgain():e.onSkipIntro&&e.onSkipIntro(),n(!1),setTimeout(()=>t(e.id),300)},className:"flex-1 px-3 py-1.5 bg-white/20 hover:bg-white/30 rounded text-xs font-medium transition-colors",children:"Skip Intro"}),it.jsx("button",{onClick:c,className:"px-3 py-1.5 bg-white/10 hover:bg-white/20 rounded text-xs font-medium transition-colors",children:"Dismiss"})]})]})]}),it.jsx("button",{onClick:c,className:"flex-shrink-0 text-white/70 hover:text-white transition-colors p-1 hover:bg-white/10 rounded",title:"Dismiss",children:it.jsx(he,{className:"w-4 h-4"})})]})})})},Ti=new class{constructor(){t(this,"activeSessions",new Map),t(this,"sessionTimers",new Map)}async createAutomatedSession(e){const t=`auto_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,s={id:t,config:e,players:[],currentPhase:"waiting",messages:[],worldState:this.generateInitialWorldState(e),activeQuests:[],npcs:this.generateNPCs(e)};return this.activeSessions.set(t,s),this.startSessionMonitoring(t),t}async addPlayerToSession(e,t){const s=this.activeSessions.get(e);if(!s)throw new Error("Session not found");if(s.players.length>=s.config.maxPlayers)throw new Error("Session is full");s.players.push(t);const a={id:`msg_${Date.now()}`,type:"system",content:`${t.name} has joined the adventure!`,timestamp:Date.now()};return s.messages.push(a),s.config.autoStart&&s.players.length>=2&&await this.startSession(e),!0}async startSession(e){const t=this.activeSessions.get(e);if(!t)throw new Error("Session not found");t.currentPhase="introduction",t.startTime=Date.now();const s=await this.generateOpeningScene(t),a={id:`msg_${Date.now()}`,type:"dm",content:s,timestamp:Date.now(),metadata:{phase:"introduction"}};t.messages.push(a),this.schedulePhaseTransition(e,"exploration",3e4)}async generateOpeningScene(e){const t=e.players.map(e=>e.name).join(", "),s=e.players.map(e=>e.characterClass).filter(Boolean),a=e.players.map(e=>e.experience),n=`\nYou are an expert Dungeon Master opening a new RPG session. Create an engaging opening scene that:\n\nREALM: ${e.config.realm}\nTHEME: ${e.config.theme}\nDM STYLE: ${e.config.dmStyle}\nPLAYERS: ${t}\nCHARACTER CLASSES: ${s.join(", ")||"Mixed"}\nEXPERIENCE LEVELS: ${a.join(", ")}\n\nREQUIREMENTS:\n- Set the scene in the chosen realm with appropriate atmosphere\n- Introduce the players to the world and their current situation\n- Provide 3-4 clear choices for how to proceed\n- Consider the players' experience levels and preferences\n- Use the DM style specified (narrative, combat-focused, puzzle-heavy, or balanced)\n- Make it engaging and immersive\n- Keep it concise but descriptive\n\nRESPONSE FORMAT:\n{\n  "narrative": "Your opening scene description",\n  "choices": ["Choice 1", "Choice 2", "Choice 3", "Choice 4"],\n  "atmosphere": {\n    "mood": "current mood",\n    "tension": "low|medium|high",\n    "environmentalDetails": "specific details about surroundings"\n  }\n}\n`;try{return await sa.generateEnhancedDynamicResponse(n)}catch(r){return this.getFallbackOpeningScene(e)}}getFallbackOpeningScene(e){const t=e.players.map(e=>e.name).join(", ");return`Welcome to the realm of ${e.config.realm}, brave adventurers! \n\nThe air crackles with ancient magic as you find yourselves standing at the edge of a mysterious forest. The trees whisper secrets of forgotten kingdoms, and in the distance, you can see the silhouette of an ancient castle against the setting sun.\n\nYour party, consisting of ${t}, has been drawn together by fate and circumstance. The local villagers speak of strange happenings in the castle - lights flickering in windows that should be empty, and the sound of distant chanting carried on the wind.\n\nWhat would you like to do?\n\n1. Approach the castle directly to investigate the strange lights\n2. Question the villagers for more information about the castle's history\n3. Search the forest for any clues or hidden paths\n4. Set up camp and wait for morning to plan your approach\n\nThe choice is yours, adventurers. The fate of this realm may very well rest in your hands.`}generateInitialWorldState(e){const t={time:"day",weather:"clear",location:"forest_edge",tension:"low",discoveredAreas:[],activeEffects:[],worldEvents:[]};switch(e.realm.toLowerCase()){case"fantasy":t.location="mystical_forest",t.activeEffects=["magical_aura"];break;case"sci-fi":t.location="space_station",t.activeEffects=["artificial_gravity","life_support"];break;case"post-apocalyptic":t.location="ruined_city",t.activeEffects=["radiation_warning"],t.tension="high";break;case"medieval":t.location="village_square",t.activeEffects=["market_day"]}return t}generateNPCs(e){const t=[];switch(e.realm.toLowerCase()){case"fantasy":t.push({id:"elder_mage",name:"Elder Thaddeus",role:"mentor",location:"village"},{id:"merchant",name:"Grimble",role:"trader",location:"market"},{id:"guard_captain",name:"Captain Valeria",role:"authority",location:"castle"});break;case"sci-fi":t.push({id:"ai_overseer",name:"O.S.C.A.R.",role:"guide",location:"command_center"},{id:"engineer",name:"Dr. Chen",role:"expert",location:"engineering"},{id:"security_chief",name:"Commander Reyes",role:"authority",location:"security"});break;case"post-apocalyptic":t.push({id:"scavenger",name:"Rust",role:"survivor",location:"outskirts"},{id:"settlement_leader",name:"Mayor Stone",role:"authority",location:"settlement"},{id:"wanderer",name:"The Traveler",role:"mysterious",location:"roads"});break;case"medieval":t.push({id:"innkeeper",name:"Mistress Willow",role:"host",location:"tavern"},{id:"blacksmith",name:"Master Forge",role:"craftsman",location:"forge"},{id:"noble",name:"Lord Aldric",role:"authority",location:"manor"})}return t}async processPlayerInput(e,t,s){const a=this.activeSessions.get(e);if(!a)throw new Error("Session not found");const n=a.players.find(e=>e.id===t);if(!n)throw new Error("Player not found in session");const r={id:`msg_${Date.now()}`,type:"player",content:s,sender:n.name,timestamp:Date.now()};a.messages.push(r);const i=await this.generateDMResponse(a,n,s),o={id:`msg_${Date.now()}`,type:"dm",content:i,timestamp:Date.now(),metadata:{phase:a.currentPhase}};return a.messages.push(o),o}async generateDMResponse(e,t,s){const a=`\nYou are the Dungeon Master for an ongoing RPG session. Respond to the player's action appropriately.\n\nCURRENT SESSION CONTEXT:\n- Phase: ${e.currentPhase}\n- Realm: ${e.config.realm}\n- Theme: ${e.config.theme}\n- DM Style: ${e.config.dmStyle}\n- Players: ${e.players.map(e=>e.name).join(", ")}\n- World State: ${JSON.stringify(e.worldState)}\n\nPLAYER CONTEXT:\n- Name: ${t.name}\n- Experience: ${t.experience}\n- Character Class: ${t.characterClass||"Unknown"}\n\nRECENT MESSAGES:\n${e.messages.slice(-5).map(e=>`${e.type}: ${e.content}`).join("\n")}\n\nPLAYER INPUT: ${s}\n\nINSTRUCTIONS:\n- Respond in character as the Dungeon Master\n- Consider the current phase and world state\n- Provide meaningful consequences and choices\n- Adapt to the player's experience level\n- Use the specified DM style\n- Keep responses engaging and immersive\n- Provide 2-3 clear choices for next actions\n\nRESPONSE FORMAT:\n{\n  "narrative": "Your response to the player's action",\n  "choices": ["Choice 1", "Choice 2", "Choice 3"],\n  "atmosphere": {\n    "mood": "current mood",\n    "tension": "low|medium|high",\n    "environmentalDetails": "specific details"\n  }\n}\n`;try{return await sa.generateEnhancedDynamicResponse(a)}catch(n){return this.getFallbackDMResponse(e,t,s)}}getFallbackDMResponse(e,t,s){const a=[`Interesting choice, ${t.name}! Your action has consequences in this world. What would you like to do next?`,"The world responds to your actions. You can continue exploring, interact with the environment, or seek out other characters.","Your decision shapes the story. Choose your next path wisely, adventurer."];return a[Math.floor(Math.random()*a.length)]}schedulePhaseTransition(e,t,s){const a=setTimeout(async()=>{await this.transitionPhase(e,t)},s);this.sessionTimers.set(e,a)}async transitionPhase(e,t){const s=this.activeSessions.get(e);if(!s)return;s.currentPhase=t;const a={id:`msg_${Date.now()}`,type:"system",content:`Phase transition: ${t}`,timestamp:Date.now(),metadata:{phase:t}};switch(s.messages.push(a),t){case"exploration":this.schedulePhaseTransition(e,"combat",12e4);break;case"combat":this.schedulePhaseTransition(e,"resolution",18e4);break;case"resolution":this.endSession(e)}}async endSession(e){const t=this.activeSessions.get(e);if(!t)return;t.currentPhase="resolution",t.endTime=Date.now();const s={id:`msg_${Date.now()}`,type:"system",content:"The adventure has concluded. Thank you for playing!",timestamp:Date.now()};t.messages.push(s),this.activeSessions.delete(e);const a=this.sessionTimers.get(e);a&&(clearTimeout(a),this.sessionTimers.delete(e))}startSessionMonitoring(e){const t=setTimeout(()=>{const t=this.activeSessions.get(e);t&&!t.startTime&&this.activeSessions.delete(e)},6e5);this.sessionTimers.set(e,t)}getSession(e){return this.activeSessions.get(e)}getAllSessions(){return Array.from(this.activeSessions.values())}removePlayerFromSession(e,t){const s=this.activeSessions.get(e);if(!s)return!1;const a=s.players.findIndex(e=>e.id===t);if(-1===a)return!1;const n=s.players[a];s.players.splice(a,1);const r={id:`msg_${Date.now()}`,type:"system",content:`${n.name} has left the adventure.`,timestamp:Date.now()};return s.messages.push(r),0===s.players.length&&this.endSession(e),!0}},Ai=({onSessionJoin:e})=>{const{user:t}=(()=>{const[e,t]=s.useState(null),[a,n]=s.useState(!0);return s.useEffect(()=>m(Vs,e=>{t(e),n(!1)}),[]),{user:e,loading:a}})(),[a,n]=s.useState([]),[r,i]=s.useState(null),[o,l]=s.useState(!1),[c,d]=s.useState(""),[h,u]=s.useState(!1);s.useEffect(()=>{const e=()=>{const e=Ti.getAllSessions();n(e)};e();const t=setInterval(e,5e3);return()=>clearInterval(t)},[]);const p=async s=>{if(t){u(!0);try{const a={id:t.uid,name:t.displayName||"Adventurer",experience:"intermediate",preferences:["exploration","story"],joinTime:Date.now()};await Ti.addPlayerToSession(s,a);const n=Ti.getSession(s);n&&(i(n),null==e||e(s))}catch(a){}finally{u(!1)}}},x=async()=>{if(r&&c.trim()&&t)try{await Ti.processPlayerInput(r.id,t.uid,c),d("");const e=Ti.getSession(r.id);e&&i(e)}catch(e){}},g=e=>{switch(e.toLowerCase()){case"fantasy":return"⚔️";case"sci-fi":return"🚀";case"post-apocalyptic":return"☢️";case"medieval":return"🏰";default:return"🎮"}},f=e=>{switch(e){case"waiting":return"text-yellow-600";case"introduction":return"text-blue-600";case"exploration":return"text-green-600";case"combat":return"text-red-600";case"resolution":return"text-purple-600";default:return"text-gray-600"}};return r?it.jsxs("div",{className:"flex flex-col h-full bg-gray-900 text-white",children:[it.jsx("div",{className:"bg-gray-800 p-4 border-b border-gray-700",children:it.jsxs("div",{className:"flex justify-between items-center",children:[it.jsxs("div",{children:[it.jsxs("h2",{className:"text-xl font-bold",children:[g(r.config.realm)," ",r.config.realm," Adventure"]}),it.jsxs("p",{className:"text-gray-400",children:["Phase: ",it.jsx("span",{className:f(r.currentPhase),children:r.currentPhase.charAt(0).toUpperCase()+r.currentPhase.slice(1)})]})]}),it.jsx("button",{onClick:()=>{r&&t&&(Ti.removePlayerFromSession(r.id,t.uid),i(null))},className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Leave Session"})]})}),it.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:r.messages.map(e=>it.jsxs("div",{className:"p-3 rounded-lg "+("dm"===e.type?"bg-blue-900 border-l-4 border-blue-400":"player"===e.type?"bg-gray-800 border-l-4 border-green-400":"bg-gray-700 border-l-4 border-yellow-400"),children:[it.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[it.jsx("span",{className:"font-semibold text-sm",children:"dm"===e.type?"🎭 DM":"player"===e.type?`👤 ${e.sender}`:"⚙️ System"}),it.jsx("span",{className:"text-xs text-gray-400",children:new Date(e.timestamp).toLocaleTimeString()})]}),it.jsx("div",{className:"text-sm whitespace-pre-wrap",children:e.content})]},e.id))}),it.jsx("div",{className:"bg-gray-800 p-4 border-t border-gray-700",children:it.jsxs("div",{className:"flex gap-2",children:[it.jsx("input",{type:"text",value:c,onChange:e=>d(e.target.value),onKeyPress:e=>"Enter"===e.key&&x(),placeholder:"Type your action or response...",className:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500"}),it.jsx("button",{onClick:x,disabled:!c.trim(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg transition-colors",children:"Send"})]})})]}):it.jsx("div",{className:"p-6 bg-gray-900 text-white min-h-screen",children:it.jsxs("div",{className:"max-w-6xl mx-auto",children:[it.jsxs("div",{className:"text-center mb-8",children:[it.jsx("h1",{className:"text-3xl font-bold mb-2",children:"🎮 Automated Game Sessions"}),it.jsx("p",{className:"text-gray-400",children:"Join an AI-powered RPG adventure or create your own!"})]}),it.jsx("div",{className:"text-center mb-8",children:it.jsx("button",{onClick:()=>l(!o),className:"px-6 py-3 bg-green-600 hover:bg-green-700 rounded-lg font-semibold transition-colors",children:o?"Cancel":"Create New Session"})}),o&&it.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-8",children:[it.jsx("h2",{className:"text-xl font-bold mb-4",children:"Create New Session"}),it.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{realm:"Fantasy",theme:"Medieval Adventure",maxPlayers:4,sessionDuration:60,autoStart:!0,dmStyle:"balanced"},{realm:"Sci-Fi",theme:"Space Exploration",maxPlayers:6,sessionDuration:90,autoStart:!0,dmStyle:"narrative"},{realm:"Post-Apocalyptic",theme:"Survival Horror",maxPlayers:4,sessionDuration:75,autoStart:!0,dmStyle:"combat-focused"},{realm:"Medieval",theme:"Political Intrigue",maxPlayers:5,sessionDuration:120,autoStart:!0,dmStyle:"puzzle-heavy"}].map((e,s)=>it.jsxs("div",{className:"bg-gray-700 p-4 rounded-lg cursor-pointer hover:bg-gray-600 transition-colors",children:[it.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[it.jsx("span",{className:"text-2xl",children:g(e.realm)}),it.jsx("h3",{className:"font-semibold",children:e.realm})]}),it.jsx("p",{className:"text-gray-400 text-sm mb-2",children:e.theme}),it.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[it.jsxs("p",{children:["Max Players: ",e.maxPlayers]}),it.jsxs("p",{children:["Duration: ",e.sessionDuration," min"]}),it.jsxs("p",{children:["Style: ",e.dmStyle]})]}),it.jsx("button",{onClick:()=>(async e=>{if(t)try{const t=await Ti.createAutomatedSession(e);l(!1),await p(t)}catch(s){}})(e),className:"mt-3 w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 rounded transition-colors",children:"Create Session"})]},s))})]}),it.jsxs("div",{children:[it.jsx("h2",{className:"text-xl font-bold mb-4",children:"Active Sessions"}),0===a.length?it.jsx("div",{className:"text-center py-8 text-gray-400",children:it.jsx("p",{children:"No active sessions. Create one to get started!"})}):it.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(e=>it.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[it.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[it.jsx("span",{className:"text-2xl",children:g(e.config.realm)}),it.jsx("h3",{className:"font-semibold",children:e.config.realm})]}),it.jsx("p",{className:"text-gray-400 text-sm mb-2",children:e.config.theme}),it.jsxs("div",{className:"text-xs text-gray-500 space-y-1 mb-3",children:[it.jsxs("p",{children:["Players: ",e.players.length,"/",e.config.maxPlayers]}),it.jsxs("p",{children:["Phase: ",it.jsx("span",{className:f(e.currentPhase),children:e.currentPhase.charAt(0).toUpperCase()+e.currentPhase.slice(1)})]}),it.jsxs("p",{children:["Style: ",e.config.dmStyle]})]}),it.jsx("button",{onClick:()=>p(e.id),disabled:e.players.length>=e.config.maxPlayers||h,className:"w-full px-3 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded transition-colors",children:h?"Joining...":e.players.length>=e.config.maxPlayers?"Full":"Join Session"})]},e.id))})]})]})})},Mi=[{label:"Dashboard",icon:it.jsx(ce,{size:22}),key:"dashboard",description:"Overview and quick actions",showInGameplay:!1},{label:"Campaigns",icon:it.jsx(be,{size:22}),key:"campaigns",description:"Create and manage campaigns",showInGameplay:!1},{label:"AI Games",icon:it.jsx(ye,{size:22}),key:"automated-games",description:"Join AI-powered RPG sessions",showInGameplay:!1},{label:"Characters",icon:it.jsx(ve,{size:22}),key:"characters",description:"Character creation and management",showInGameplay:!1},{label:"Profile",icon:it.jsx(Z,{size:22}),key:"profile",description:"Player profile and achievements",showInGameplay:!1},{label:"DM Center",icon:it.jsx(we,{size:22}),key:"dm-center",description:"Dungeon Master tools and resources",showInGameplay:!0},{label:"Party",icon:it.jsx(te,{size:22}),key:"party",description:"View party members and status",showInGameplay:!0},{label:"World",icon:it.jsx(je,{size:22}),key:"world",description:"World map and exploration",showInGameplay:!0},{label:"Combat",icon:it.jsx(ie,{size:22}),key:"combat",description:"Combat system and tactics",showInGameplay:!0},{label:"Magic",icon:it.jsx(me,{size:22}),key:"magic",description:"Spells and magical abilities",showInGameplay:!0}],Di=({active:e,onNavigate:t,theme:a,isMobile:n=!1,onToggleMobile:r,currentScreen:i})=>{const[o,l]=s.useState(!1),c="game"===i||"combat"===i?Mi.filter(e=>e.showInGameplay):Mi.filter(e=>!e.showInGameplay);return n?it.jsxs(it.Fragment,{children:[it.jsx("button",{onClick:r,className:"lg:hidden p-2 text-blue-200 hover:text-yellow-300 transition-all",title:"Toggle mobile menu",children:it.jsx(xe,{size:24})}),it.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-gradient-to-r from-blue-900 via-indigo-900 to-purple-900 border-t border-white/20 z-50 lg:hidden",children:it.jsx("div",{className:"flex justify-around items-center py-2",children:c.slice(0,5).map(s=>it.jsxs("button",{onClick:()=>t(s.key),className:"flex flex-col items-center py-2 px-1 rounded-lg transition-all min-w-0 flex-1 group "+(e===s.key?"text-yellow-300 bg-white/20":"text-blue-200 hover:text-yellow-300 hover:bg-white/10"),title:`${s.label} - ${s.description}`,children:[s.icon,it.jsx("span",{className:"text-xs mt-1 font-medium truncate",children:s.label}),it.jsx("div",{className:"absolute bottom-full mb-2 px-2 py-1 bg-black/90 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap",children:s.description})]},s.key))})})]}):it.jsxs("nav",{className:"hidden lg:flex h-screen w-20 bg-gradient-to-b from-blue-900 via-indigo-900 to-purple-900 flex-col items-center py-6 shadow-xl transition-all duration-500 "+(a?`theme-${a}`:""),style:{minWidth:80},children:[it.jsx("button",{onClick:()=>l(!o),className:"absolute -right-3 top-8 bg-blue-800 hover:bg-blue-700 text-white p-1 rounded-full transition-all",title:o?"Expand navigation":"Collapse navigation",children:o?it.jsx(ge,{size:16}):it.jsx(fe,{size:16})}),it.jsx("div",{className:"flex-1 flex flex-col space-y-4 w-full items-center",children:c.map(s=>it.jsxs("button",{onClick:()=>t(s.key),className:"flex flex-col items-center w-full py-3 rounded-xl transition-all group relative "+(e===s.key?"bg-white/20 text-yellow-300":"text-blue-200 hover:bg-white/10"),title:`${s.label} - ${s.description}`,children:[s.icon,!o&&it.jsx("span",{className:"text-xs mt-1 font-medium",children:s.label}),it.jsxs("div",{className:"absolute left-full ml-2 px-3 py-2 bg-black/90 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50"+(o?"hidden":""),children:[it.jsx("div",{className:"font-semibold",children:s.label}),it.jsx("div",{className:"text-xs text-gray-300",children:s.description})]})]},s.key))})]})},Ri=Object.freeze(Object.defineProperty({__proto__:null,default:Di},Symbol.toStringTag,{value:"Module"})),_i=({user:e})=>it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Di,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(Ai,{})})]}),Li=new class{constructor(){t(this,"gameId",null),t(this,"playerId",null),t(this,"listeners",{}),t(this,"presenceRef",null),t(this,"messagesRef",null),t(this,"stateRef",null),t(this,"eventsRef",null),t(this,"isConnected",!1)}async initializeGame(e,t){this.gameId=e,this.playerId=t.id,this.presenceRef=G(ea,`games/${e}/presence/${t.id}`),await B(this.presenceRef,{id:t.id,name:t.name,characterId:t.characterId,isOnline:!0,lastSeen:Date.now(),status:"idle"});const s=G(ea,`games/${e}/presence/${t.id}`);await q(s).update({isOnline:!1,lastSeen:Date.now()}),this.setupRealtimeListeners(),this.isConnected=!0}setupRealtimeListeners(){if(!this.gameId)return;const e=G(ea,`games/${this.gameId}/presence`);this.listeners.presence=J(e,e=>{const t=e.val();this.handlePresenceUpdate(t)});const t=G(ea,`games/${this.gameId}/messages`);this.listeners.messages=J(t,e=>{const t=e.val();this.handleMessageUpdate(t)});const s=G(ea,`games/${this.gameId}/sharedState`);this.listeners.state=J(s,e=>{const t=e.val();this.handleStateUpdate(t)});const a=G(ea,`games/${this.gameId}/events`);this.listeners.events=J(a,e=>{const t=e.val();this.handleEventUpdate(t)})}async sendMessage(e){if(!this.gameId||!this.isConnected)return;const t=G(ea,`games/${this.gameId}/messages`),s=V(t);await B(s,{...e,id:s.key,timestamp:Date.now()})}async updatePresence(e,t){if(!this.gameId||!this.playerId||!this.isConnected)return;const s={status:e,lastSeen:Date.now()};t&&(s.position=t),await K(G(ea,`games/${this.gameId}/presence/${this.playerId}`),s)}async updateSharedState(e){if(!this.gameId||!this.isConnected)return;const t=G(ea,`games/${this.gameId}/sharedState`);await K(t,{...e,lastUpdated:Date.now()})}async broadcastEvent(e){if(!this.gameId||!this.isConnected)return;const t=G(ea,`games/${this.gameId}/events`),s=V(t);await B(s,{...e,timestamp:Date.now()})}async startCombat(e){if(this.gameId&&this.isConnected){await this.updateSharedState({combatState:{isActive:!0,participants:e.participants,currentTurn:e.currentTurn,round:1}}),await this.broadcastEvent({type:"combat_start",data:e});for(const t of e.participants)await K(G(ea,`games/${this.gameId}/presence/${t}`),{status:"in-combat",lastSeen:Date.now()})}}async endCombat(e){if(!this.gameId||!this.isConnected)return;await this.updateSharedState({combatState:{isActive:!1,participants:[],currentTurn:null,round:0}}),await this.broadcastEvent({type:"combat_end",data:e});const t=G(ea,`games/${this.gameId}/presence`),s=await Q(t);if(s.exists()){const e=s.val(),a={};Object.keys(e).forEach(e=>{a[`${e}/status`]="idle",a[`${e}/lastSeen`]=Date.now()}),await K(t,a)}}async updatePlayerPosition(e){this.gameId&&this.playerId&&this.isConnected&&(await this.updatePresence("exploring",e),await this.broadcastEvent({type:"movement",data:{playerId:this.playerId,position:e,timestamp:Date.now()}}))}async getOnlinePlayers(){if(!this.gameId)return[];const e=G(ea,`games/${this.gameId}/presence`),t=await Q(e);if(!t.exists())return[];const s=t.val();return Object.values(s).filter(e=>e.isOnline)}async getRecentMessages(e=50){if(!this.gameId)return[];const t=G(ea,`games/${this.gameId}/messages`),s=await Q(t);if(!s.exists())return[];const a=s.val();return Object.values(a).sort((e,t)=>t.timestamp-e.timestamp).slice(0,e)}async getSharedState(){if(!this.gameId)return null;const e=G(ea,`games/${this.gameId}/sharedState`),t=await Q(e);return t.exists()?t.val():null}handlePresenceUpdate(e){}handleMessageUpdate(e){}handleStateUpdate(e){}handleEventUpdate(e){}onPresenceUpdate(e){this.handlePresenceUpdate=e}onMessageUpdate(e){this.handleMessageUpdate=e}onStateUpdate(e){this.handleStateUpdate=e}onEventUpdate(e){this.handleEventUpdate=e}async disconnect(){this.gameId&&this.playerId&&(await K(G(ea,`games/${this.gameId}/presence/${this.playerId}`),{isOnline:!1,lastSeen:Date.now()}),Object.values(this.listeners).forEach(e=>{"function"==typeof e&&e()}),this.listeners={},this.isConnected=!1,this.gameId=null,this.playerId=null)}isGameConnected(){return this.isConnected&&null!==this.gameId}getCurrentGameId(){return this.gameId}getCurrentPlayerId(){return this.playerId}},Oi=e=>"string"!=typeof e?"":e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi,"").replace(/<embed\b[^<]*(?:(?!<\/embed>)<[^<]*)*<\/embed>/gi,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"").replace(/<[^>]*>/g,"").trim(),$i=["badword1","badword2","badword3","spam","scam","hack","crack"];class Ui{constructor(e=5,s=6e4){t(this,"attempts",new Map),this.maxAttempts=e,this.windowMs=s}isAllowed(e){const t=Date.now(),s=this.attempts.get(e);return!s||t>s.resetTime?(this.attempts.set(e,{count:1,resetTime:t+this.windowMs}),!0):!(s.count>=this.maxAttempts||(s.count++,0))}reset(e){this.attempts.delete(e)}getRemainingAttempts(e){const t=this.attempts.get(e);return t?Math.max(0,this.maxAttempts-t.count):this.maxAttempts}getTimeUntilReset(e){const t=this.attempts.get(e);return t?Math.max(0,t.resetTime-Date.now()):0}}const zi="@firebase/installations",Fi="0.6.9",Wi=`w:${Fi}`,Hi="FIS_v2",Yi=new y("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Gi(e){return e instanceof v&&e.code.includes("request-failed")}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bi({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function qi(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Ji(e,t){const s=(await t.json()).error;return Yi.create("request-failed",{requestName:e,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function Vi({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function Ki(e){const t=await e();return t.status>=500&&t.status<600?e():t}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Qi(e){return new Promise(t=>{setTimeout(t,e)})}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Xi=/^[cdef][\w-]{21}$/;function Zi(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){var t;return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e);return Xi.test(t)?t:""}catch(e){return""}}function eo(e){return`${e.appName}!${e.appId}`}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to=new Map;function so(e,t){const s=eo(e);ao(s,t),function(e,t){const s=(!no&&"BroadcastChannel"in self&&(no=new BroadcastChannel("[Firebase] FID Change"),no.onmessage=e=>{ao(e.data.key,e.data.fid)}),no);s&&s.postMessage({key:e,fid:t}),0===to.size&&no&&(no.close(),no=null)}(s,t)}function ao(e,t){const s=to.get(e);if(s)for(const a of s)a(t)}let no=null;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const ro="firebase-installations-store";let io=null;function oo(){return io||(io=w("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(ro)}})),io}async function lo(e,t){const s=eo(e),a=(await oo()).transaction(ro,"readwrite"),n=a.objectStore(ro),r=await n.get(s);return await n.put(t,s),await a.done,r&&r.fid===t.fid||so(e,t.fid),t}async function co(e){const t=eo(e),s=(await oo()).transaction(ro,"readwrite");await s.objectStore(ro).delete(t),await s.done}async function ho(e,t){const s=eo(e),a=(await oo()).transaction(ro,"readwrite"),n=a.objectStore(ro),r=await n.get(s),i=t(r);return void 0===i?await n.delete(s):await n.put(i,s),await a.done,!i||r&&r.fid===i.fid||so(e,i.fid),i}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uo(e){let t;const s=await ho(e.appConfig,s=>{const a=function(e){return xo(e||{fid:Zi(),registrationStatus:0})}(s),n=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Yi.create("app-offline"))};const s={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},a=async function(e,t){try{const s=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */await async function({appConfig:e,heartbeatServiceProvider:t},{fid:s}){const a=Bi(e),n=Vi(e),r=t.getImmediate({optional:!0});if(r){const e=await r.getHeartbeatsHeader();e&&n.append("x-firebase-client",e)}const i={fid:s,authVersion:Hi,appId:e.appId,sdkVersion:Wi},o={method:"POST",headers:n,body:JSON.stringify(i)},l=await Ki(()=>fetch(a,o));if(l.ok){const e=await l.json();return{fid:e.fid||s,registrationStatus:2,refreshToken:e.refreshToken,authToken:qi(e.authToken)}}throw await Ji("Create Installation",l)}(e,t);return lo(e.appConfig,s)}catch(Ul){throw Gi(Ul)&&409===Ul.customData.serverCode?await co(e.appConfig):await lo(e.appConfig,{fid:t.fid,registrationStatus:0}),Ul}}(e,s);return{installationEntry:s,registrationPromise:a}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:mo(e)}:{installationEntry:t}}(e,a);return t=n.registrationPromise,n.installationEntry});return""===s.fid?{installationEntry:await t}:{installationEntry:s,registrationPromise:t}}async function mo(e){let t=await po(e.appConfig);for(;1===t.registrationStatus;)await Qi(100),t=await po(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:s}=await uo(e);return s||t}return t}function po(e){return ho(e,e=>{if(!e)throw Yi.create("installation-not-found");return xo(e)})}function xo(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}async function go({appConfig:e,heartbeatServiceProvider:t},s){const a=function(e,{fid:t}){return`${Bi(e)}/${t}/authTokens:generate`}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,s),n=function(e,{refreshToken:t}){const s=Vi(e);return s.append("Authorization",function(e){return`${Hi} ${e}`}(t)),s}(e,s),r=t.getImmediate({optional:!0});if(r){const e=await r.getHeartbeatsHeader();e&&n.append("x-firebase-client",e)}const i={installation:{sdkVersion:Wi,appId:e.appId}},o={method:"POST",headers:n,body:JSON.stringify(i)},l=await Ki(()=>fetch(a,o));if(l.ok)return qi(await l.json());throw await Ji("Generate Auth Token",l)}async function fo(e,t=!1){let s;const a=await ho(e.appConfig,a=>{if(!yo(a))throw Yi.create("not-registered");const n=a.authToken;if(!t&&(2===(r=n).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(r)))return a;var r;if(1===n.requestStatus)return s=async function(e,t){let s=await bo(e.appConfig);for(;1===s.authToken.requestStatus;)await Qi(100),s=await bo(e.appConfig);const a=s.authToken;return 0===a.requestStatus?fo(e,t):a}(e,t),a;{if(!navigator.onLine)throw Yi.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(a);return s=async function(e,t){try{const s=await go(e,t),a=Object.assign(Object.assign({},t),{authToken:s});return await lo(e.appConfig,a),s}catch(Ul){if(!Gi(Ul)||401!==Ul.customData.serverCode&&404!==Ul.customData.serverCode){const s=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await lo(e.appConfig,s)}else await co(e.appConfig);throw Ul}}(e,t),t}});return s?await s:a.authToken}function bo(e){return ho(e,e=>{if(!yo(e))throw Yi.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */})}function yo(e){return void 0!==e&&2===e.registrationStatus}function vo(e){return Yi.create("missing-app-config-values",{valueName:e})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo="installations";g(new f(wo,e=>{const t=e.getProvider("app").getImmediate(),s=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){if(!e||!e.options)throw vo("App Configuration");if(!e.name)throw vo("App Name");const t=["projectId","apiKey","appId"];for(const s of t)if(!e.options[s])throw vo(s);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:s,heartbeatServiceProvider:b(t,"heartbeat"),_delete:()=>Promise.resolve()}},"PUBLIC")),g(new f("installations-internal",e=>{const t=e.getProvider("app").getImmediate(),s=b(t,wo).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:s,registrationPromise:a}=await uo(t);return a?a.catch(console.error):fo(t).catch(console.error),s.fid}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(s),getToken:e=>async function(e,t=!1){const s=e;return await async function(e){const{registrationPromise:t}=await uo(e);t&&await t}(s),(await fo(s,t)).token}(s,e)}},"PRIVATE")),x(zi,Fi),x(zi,Fi,"esm2017");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const jo="analytics",No="https://www.googletagmanager.com/gtag/js",So=new k("@firebase/analytics"),ko=new y("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Co(e){if(!e.startsWith(No)){const t=ko.create("invalid-gtag-resource",{gtagURL:e});return So.warn(t.message),""}return e}function Eo(e){return Promise.all(e.map(e=>e.catch(e=>e)))}const Po=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Io(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function To(e,t=Po,s){const{appId:a,apiKey:n,measurementId:r}=e.options;if(!a)throw ko.create("no-app-id");if(!n){if(r)return{measurementId:r,appId:a};throw ko.create("no-api-key")}const i=t.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Mo;return setTimeout(async()=>{o.abort()},void 0!==s?s:6e4),Ao({appId:a,apiKey:n,measurementId:r},i,o,t)}async function Ao(e,{throttleEndTimeMillis:t,backoffCount:s},a,n=Po){var r;const{appId:i,measurementId:o}=e;try{await function(e,t){return new Promise((s,a)=>{const n=Math.max(t-Date.now(),0),r=setTimeout(s,n);e.addEventListener(()=>{clearTimeout(r),a(ko.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(a,t)}catch(Ul){if(o)return So.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==Ul?void 0:Ul.message}]`),{appId:i,measurementId:o};throw Ul}try{const t=await async function(e){var t;const{appId:s,apiKey:a}=e,n={method:"GET",headers:Io(a)},r="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",s),i=await fetch(r,n);if(200!==i.status&&304!==i.status){let e="";try{const s=await i.json();(null===(t=s.error)||void 0===t?void 0:t.message)&&(e=s.error.message)}catch(o){}throw ko.create("config-fetch-failed",{httpStatus:i.status,responseMessage:e})}return i.json()}(e);return n.deleteThrottleMetadata(i),t}catch(Ul){const l=Ul;if(!function(e){if(!(e instanceof v&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(l)){if(n.deleteThrottleMetadata(i),o)return So.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${null==l?void 0:l.message}]`),{appId:i,measurementId:o};throw Ul}const c=503===Number(null===(r=null==l?void 0:l.customData)||void 0===r?void 0:r.httpStatus)?E(s,n.intervalMillis,30):E(s,n.intervalMillis),d={throttleEndTimeMillis:Date.now()+c,backoffCount:s+1};return n.setThrottleMetadata(i,d),So.debug(`Calling attemptFetch again in ${c} millis`),Ao(e,d,a,n)}}class Mo{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Do(e,t,s,a,n,r,i){var o;const l=To(e);l.then(t=>{s[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&So.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(e=>So.error(e)),t.push(l);const c=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function(){if(!P())return So.warn(ko.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await I()}catch(Ul){return So.warn(ko.create("indexeddb-unavailable",{errorInfo:null==Ul?void 0:Ul.toString()}).message),!1}return!0}().then(e=>e?a.getId():void 0),[d,h]=await Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const s of Object.values(t))if(s.src&&s.src.includes(No)&&s.src.includes(e))return s;return null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */)(r)||function(e,t){const s=function(e,t){let s;return window.trustedTypes&&(s=window.trustedTypes.createPolicy("firebase-js-sdk-policy",t)),s}(0,{createScriptURL:Co}),a=document.createElement("script"),n=`${No}?l=${e}&id=${t}`;a.src=s?null==s?void 0:s.createScriptURL(n):n,a.async=!0,document.head.appendChild(a)}(r,d.measurementId),n("js",new Date);const u=null!==(o=null==i?void 0:i.config)&&void 0!==o?o:{};return u.origin="firebase",u.update=!0,null!=h&&(u.firebase_id=h),n("config",d.measurementId,u),d.measurementId}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ro=class{constructor(e){this.app=e}_delete(){return delete _o[this.app.options.appId],Promise.resolve()}},_o={},Lo=[];const Oo={};let $o,Uo,zo="dataLayer",Fo=!1;function Wo(e,t,s){!function(){const e=[];if(C()&&e.push("This is a browser extension environment."),T()||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>`(${t+1}) ${e}`).join(" "),s=ko.create("invalid-analytics-context",{errorInfo:t});So.warn(s.message)}}();const a=e.options.appId;if(!a)throw ko.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw ko.create("no-api-key");So.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=_o[a])throw ko.create("already-exists",{id:a});if(!Fo){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(zo);const{wrappedGtag:e,gtagCore:t}=function(e,t,s,a,n){let r=function(...e){window[a].push(arguments)};return window[n]&&"function"==typeof window[n]&&(r=window[n]),window[n]=function(e,t,s,a){return async function(n,...r){try{if("event"===n){const[a,n]=r;await async function(e,t,s,a,n){try{let r=[];if(n&&n.send_to){let e=n.send_to;Array.isArray(e)||(e=[e]);const a=await Eo(s);for(const s of e){const e=a.find(e=>e.measurementId===s),n=e&&t[e.appId];if(!n){r=[];break}r.push(n)}}0===r.length&&(r=Object.values(t)),await Promise.all(r),e("event",a,n||{})}catch(Ul){So.error(Ul)}}(e,t,s,a,n)}else if("config"===n){const[n,i]=r;await async function(e,t,s,a,n,r){const i=a[n];try{if(i)await t[i];else{const e=(await Eo(s)).find(e=>e.measurementId===n);e&&await t[e.appId]}}catch(Ul){So.error(Ul)}e("config",n,r)}(e,t,s,a,n,i)}else if("consent"===n){const[t,s]=r;e("consent",t,s)}else if("get"===n){const[t,s,a]=r;e("get",t,s,a)}else if("set"===n){const[t]=r;e("set",t)}else e(n,...r)}catch(Ul){So.error(Ul)}}}(r,e,t,s),{gtagCore:r,wrappedGtag:window[n]}}(_o,Lo,Oo,zo,"gtag");Uo=e,$o=t,Fo=!0}return _o[a]=Do(e,Lo,Oo,t,$o,zo,s),new Ro(e)}function Ho(e,t,s,a){e=j(e),async function(e,t,s,a,n){if(n&&n.global)e("event",s,a);else{const n=await t;e("event",s,Object.assign(Object.assign({},a),{send_to:n}))}}(Uo,_o[e.app.options.appId],t,s,a).catch(e=>So.error(e))}const Yo="@firebase/analytics",Go="0.10.8";g(new f(jo,(e,{options:t})=>Wo(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),g(new f("analytics-internal",function(e){try{const t=e.getProvider(jo).getImmediate();return{logEvent:(e,s,a)=>Ho(t,e,s,a)}}catch(Ul){throw ko.create("interop-component-reg-failed",{reason:Ul})}},"PRIVATE")),x(Yo,Go),x(Yo,Go,"esm2017");const Bo=p({apiKey:"AIzaSyAVJvau3Hit06q1pNYCTOF-pVuutmk4oNQ",authDomain:"mythseekers-rpg.firebaseapp.com",databaseURL:"https://mythseekers-rpg-default-rtdb.firebaseio.com",projectId:"mythseekers-rpg",storageBucket:"mythseekers-rpg.firebasestorage.app",messagingSenderId:"659018227506",appId:"1:659018227506:web:82425e7adaf80c2e3c412b",measurementId:"G-E3T1V81ZX3"}),qo=new class{constructor(){t(this,"analytics",null),t(this,"isInitialized",!1),this.initializeAnalytics()}initializeAnalytics(){try{"undefined"!=typeof window&&Bo&&(this.analytics=function(e=N()){e=j(e);const t=b(e,jo);return t.isInitialized()?t.getImmediate():function(e,t={}){const s=b(e,jo);if(s.isInitialized()){const e=s.getImmediate();if(S(t,s.getOptions()))return e;throw ko.create("already-initialized")}return s.initialize({options:t})}(e)}(Bo),this.isInitialized=!0)}catch(e){}}setUserId(e){if(this.analytics&&this.isInitialized)try{t=this.analytics,s=e,t=j(t),async function(e,t,s,a){if(a&&a.global)return e("set",{user_id:s}),Promise.resolve();e("config",await t,{update:!0,user_id:s})}(Uo,_o[t.app.options.appId],s,a).catch(e=>So.error(e))}catch(n){}var t,s,a}setUserProperties(e){if(this.analytics&&this.isInitialized)try{!function(e,t,s){e=j(e),async function(e,t,s,a){if(a&&a.global){const t={};for(const e of Object.keys(s))t[`user_properties.${e}`]=s[e];return e("set",t),Promise.resolve()}e("config",await t,{update:!0,user_properties:s})}(Uo,_o[e.app.options.appId],t,s).catch(e=>So.error(e))}(this.analytics,e)}catch(t){}}trackPageView(e,t){this.logEvent("page_view",{page_name:e,page_title:t||e,timestamp:Date.now()})}trackUserAction(e,t){this.logEvent("user_action",{action:e,...t,timestamp:Date.now()})}trackGameEvent(e,t){this.logEvent("game_event",{event:e,...t,timestamp:Date.now()})}trackPerformance(e,t,s){this.logEvent("performance",{metric:e,value:t,...s,timestamp:Date.now()})}trackError(e,t){this.logEvent("error",{error_message:e.message,error_stack:e.stack,error_name:e.name,...t,timestamp:Date.now()})}trackFeatureUsage(e,t,s){this.logEvent("feature_usage",{feature:e,action:t,...s,timestamp:Date.now()})}trackConversion(e,t,s){this.logEvent("conversion",{conversion_type:e,value:t,currency:s||"USD",timestamp:Date.now()})}trackEngagement(e,t,s){this.logEvent("engagement",{metric:e,value:t,...s,timestamp:Date.now()})}logEvent(e,t){if(this.analytics&&this.isInitialized)try{Ho(this.analytics,e,t)}catch(s){}}trackCoreWebVitals(e,t){this.trackPerformance(`web_vital_${e.toLowerCase()}`,t)}trackBundleLoad(e,t,s){this.trackPerformance("bundle_load",t,{bundle_name:e,bundle_size:s})}trackAPIPerformance(e,t,s){this.trackPerformance("api_response_time",t,{endpoint:e,status_code:s})}trackOnboardingStep(e,t,s){this.trackUserAction("onboarding_step",{step:e,completed:t,time_spent:s})}trackCharacterCreation(e,t){this.trackGameEvent("character_created",{character_class:e,time_spent:t})}trackCampaignEvent(e,t,s){this.trackGameEvent(e,{campaign_id:t,...s})}trackCombatEvent(e,t){this.trackGameEvent(`combat_${e}`,t)}trackAIInteraction(e,t,s){this.trackPerformance("ai_response_time",t,{interaction_type:e,success:s})}trackMultiplayerEvent(e,t){this.trackGameEvent(`multiplayer_${e}`,t)}trackAccessibilityUsage(e,t){this.trackFeatureUsage("accessibility",e,{enabled:t})}trackDeviceInfo(){if("undefined"!=typeof window){const e=navigator.userAgent,t=`${screen.width}x${screen.height}`,s=`${window.innerWidth}x${window.innerHeight}`;this.setUserProperties({device_type:this.getDeviceType(),browser:this.getBrowserInfo(),screen_resolution:t,viewport_size:s,user_agent:e.substring(0,100)})}}getDeviceType(){if("undefined"==typeof window)return"unknown";const e=navigator.userAgent.toLowerCase();return/mobile|android|iphone|ipad|phone/i.test(e)?"mobile":/tablet|ipad/i.test(e)?"tablet":"desktop"}getBrowserInfo(){if("undefined"==typeof window)return"unknown";const e=navigator.userAgent;return e.includes("Chrome")?"chrome":e.includes("Firefox")?"firefox":e.includes("Safari")?"safari":e.includes("Edge")?"edge":"other"}trackSessionStart(){this.trackUserAction("session_start",{session_id:this.generateSessionId(),referrer:document.referrer||"direct"})}trackSessionEnd(e){this.trackUserAction("session_end",{session_duration:e})}generateSessionId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}trackUserPreference(e,t){this.trackUserAction("preference_changed",{preference:e,value:String(t)})}trackSearch(e,t){this.trackUserAction("search",{query:e.substring(0,50),results_count:t})}trackHelpUsage(e,t){this.trackFeatureUsage("help",t,{topic:e})}trackTutorialCompletion(e,t,s){this.trackUserAction("tutorial_completion",{tutorial_name:e,completed:t,steps_completed:s})}};class Jo{constructor(){t(this,"state"),this.state={isActive:!1,currentTurn:0,turnOrder:[],currentCombatantIndex:0,combatants:[],battleMap:this.createDefaultBattleMap(),combatLog:[],round:1,lineOfSightCache:{}}}createDefaultBattleMap(){const e=[];for(let t=0;t<8;t++){const s=[];for(let e=0;e<12;e++){let a="floor";0===e||11===e||0===t||7===t?a="wall":Math.random()<.1&&(a="difficult"),s.push({type:a,elevation:0,cover:0,occupied:!1})}e.push(s)}return{width:12,height:8,tiles:e}}startCombat(e,t){const s=this.assignStartingPositions(e,t||this.state.battleMap),a=this.calculateInitiativeOrder(s),n=s.map(e=>({...e,currentActionPoints:{...e.actionPoints},isActive:!1,hasActed:!1}));return this.state={isActive:!0,currentTurn:0,turnOrder:a,currentCombatantIndex:0,combatants:n,battleMap:t||this.state.battleMap,combatLog:[],round:1,lineOfSightCache:{}},this.setActiveCombatant(0),this.getState()}assignStartingPositions(e,t){const s=[...e],a=Math.floor(t.width/2),n=Math.floor(t.height/2);return s.filter(e=>"player"===e.type).forEach((e,t)=>{e.position={x:Math.max(1,a-3+t),y:n}}),s.filter(e=>"enemy"===e.type).forEach((e,s)=>{e.position={x:Math.min(t.width-2,a+3-s),y:n}}),s}calculateInitiativeOrder(e){return e.map(e=>({id:e.id,initiative:this.rollInitiative(e)})).sort((e,t)=>t.initiative-e.initiative).map(e=>e.id)}rollInitiative(e){const t=Math.floor((e.stats.dexterity-10)/2);return Math.floor(20*Math.random())+1+t}getState(){return{...this.state}}getActiveCombatant(){if(!this.state.isActive||0===this.state.turnOrder.length)return null;const e=this.state.turnOrder[this.state.currentCombatantIndex];return this.state.combatants.find(t=>t.id===e)||null}isPlayerTurn(){const e=this.getActiveCombatant();return"player"===(null==e?void 0:e.type)}executeAction(e){const t=this.getActiveCombatant();if(!t)return{success:!1,message:"No active combatant"};switch(e.type){case"move":return this.executeMove(t,e);case"attack":return this.executeAttack(t,e);case"skill":return this.executeSkill(t,e);case"end-turn":return this.endTurn();default:return{success:!1,message:"Unknown action type"}}}executeMove(e,t){if(e.currentActionPoints.move<=0)return{success:!1,message:"No movement points remaining"};if(!t.target||"string"==typeof t.target)return{success:!1,message:"Invalid move target"};const s=t.target.x,a=t.target.y;if(s<0||s>=this.state.battleMap.width||a<0||a>=this.state.battleMap.height)return{success:!1,message:"Target position out of bounds"};const n=this.state.battleMap.tiles[a][s];if("wall"===n.type||n.occupied)return{success:!1,message:"Cannot move to occupied or wall tile"};const r=Math.abs(s-e.position.x)+Math.abs(a-e.position.y),i="difficult"===n.type?2*r:r;if(i>e.currentActionPoints.move)return{success:!1,message:"Not enough movement points"};const o=this.state.combatants.map(t=>t.id===e.id?{...t,position:{x:s,y:a},currentActionPoints:{...t.currentActionPoints,move:t.currentActionPoints.move-i}}:t);return this.state.combatants=o,this.addCombatLog(e.id,"move",`${e.name} moved to (${s}, ${a})`),{success:!0,message:`${e.name} moved to (${s}, ${a})`,newState:this.getState()}}calculateLineOfSight(e,t){const s=`${e.x},${e.y}-${t.x},${t.y}`;if(this.state.lineOfSightCache[s])return this.state.lineOfSightCache[s].has("visible");const a=Math.abs(t.x-e.x),n=Math.abs(t.y-e.y),r=e.x<t.x?1:-1,i=e.y<t.y?1:-1;let o=a-n,l=e.x,c=e.y;for(;l!==t.x||c!==t.y;){if(l>=0&&l<this.state.battleMap.width&&c>=0&&c<this.state.battleMap.height){const e=this.state.battleMap.tiles[c][l];if("wall"===e.type||e.cover>=3)return this.state.lineOfSightCache[s]=new Set(["blocked"]),!1}const e=2*o;e>-n&&(o-=n,l+=r),e<a&&(o+=a,c+=i)}return this.state.lineOfSightCache[s]=new Set(["visible"]),!0}getVisibleTargets(e){return this.state.combatants.filter(t=>!(t.id===e.id||t.health<=0)&&this.calculateLineOfSight(e.position,t.position))}calculateFlankingBonus(e,t){const s=this.state.combatants.filter(t=>t.type===e.type&&t.id!==e.id&&t.health>0);for(const a of s){const s=Math.abs(a.position.x-t.position.x)+Math.abs(a.position.y-t.position.y),n=Math.abs(e.position.x-t.position.x)+Math.abs(e.position.y-t.position.y);if(s<=1&&n<=1){const s=a.position.x-t.position.x,n=a.position.y-t.position.y,r=e.position.x-t.position.x,i=e.position.y-t.position.y;if((s*r<0||n*i<0)&&(0!==s||0!==r)&&(0!==n||0!==i))return 2}}return 0}getEnemyAIAction(e){const t=this.getVisibleTargets(e);if(0===t.length)return this.getMovementTowardsPlayers(e);const s={personality:"aggressive",preferredRange:"melee",targetPriority:"closest",retreatThreshold:.3,flankingBonus:!0};if(e.health/e.maxHealth<s.retreatThreshold)return{type:"move",target:void 0};const a=this.selectTarget(t,s.targetPriority,e);switch(s.personality){case"aggressive":default:return this.getAggressiveAction(e,a,s);case"defensive":return this.getDefensiveAction(e,a,s);case"tactical":return this.getTacticalAction(e,a,s);case"cowardly":return this.getCowardlyAction(e,a,s)}}selectTarget(e,t,s){switch(t){case"weakest":return e.reduce((e,t)=>t.health<e.health?t:e);case"strongest":return e.reduce((e,t)=>t.health>e.health?t:e);case"closest":return e.reduce((e,t)=>{const a=Math.abs(e.position.x-s.position.x)+Math.abs(e.position.y-s.position.y);return Math.abs(t.position.x-s.position.x)+Math.abs(t.position.y-s.position.y)<a?t:e});case"threat":return e.reduce((e,t)=>2*(t.maxHealth-t.health)+t.stats.strength>2*(e.maxHealth-e.health)+e.stats.strength?t:e);default:return e[0]}}getAggressiveAction(e,t,s){if(Math.abs(t.position.x-e.position.x)+Math.abs(t.position.y-e.position.y)<=e.reach&&e.currentActionPoints.action>0)return{type:"attack",target:t.position};if(e.currentActionPoints.move>0){const s=this.findPathToTarget(e,t);if(s.length>1)return{type:"move",target:s[1],path:s}}return{type:"end-turn"}}getDefensiveAction(e,t,s){const a=Math.abs(t.position.x-e.position.x)+Math.abs(t.position.y-e.position.y);if(a<=1&&e.currentActionPoints.move>0){const s=this.findRetreatPosition(e,t);if(s)return{type:"move",target:s}}else if(a<=e.reach&&e.currentActionPoints.action>0)return{type:"attack",target:t.position};return{type:"end-turn"}}getTacticalAction(e,t,s){const a=this.calculateFlankingBonus(e,t),n=this.state.battleMap.tiles[e.position.y][e.position.x],r=this.state.battleMap.tiles[t.position.y][t.position.x],i=r.cover,o=n.cover,l=n.elevation,c=r.elevation;if(a>0&&e.currentActionPoints.action>0&&i<2)return{type:"attack",target:t.position};if(l>c&&e.currentActionPoints.action>0)return{type:"attack",target:t.position};const d=this.findTacticalPosition(e,t);return d&&e.currentActionPoints.move>0?{type:"move",target:d}:o>=1&&e.currentActionPoints.action>0?{type:"attack",target:t.position}:{type:"end-turn"}}getCowardlyAction(e,t,s){if(Math.abs(t.position.x-e.position.x)+Math.abs(t.position.y-e.position.y)<=2){const s=this.findRetreatPosition(e,t);if(s&&e.currentActionPoints.move>0)return{type:"move",target:s}}return t.health/t.maxHealth<.3&&e.currentActionPoints.action>0?{type:"attack",target:t.position}:{type:"end-turn"}}findPathToTarget(e,t){const s=[{x:e.position.x,y:e.position.y,g:0,h:0,f:0,parent:null}],a=new Set,n=new Map,r=new Map,i=new Map;for(r.set(`${e.position.x},${e.position.y}`,0),i.set(`${e.position.x},${e.position.y}`,this.heuristic(e.position,t.position));s.length>0;){s.sort((e,t)=>e.f-t.f);const o=s.shift(),l=`${o.x},${o.y}`;if(o.x===t.position.x&&o.y===t.position.y){const t=[];let s={x:o.x,y:o.y};for(;n.has(`${s.x},${s.y}`);)t.unshift(s),s=n.get(`${s.x},${s.y}`);return t.unshift({x:e.position.x,y:e.position.y}),t}a.add(l);const c=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];for(const e of c){const c={x:o.x+e.dx,y:o.y+e.dy},d=`${c.x},${c.y}`;if(c.x<0||c.x>=this.state.battleMap.width||c.y<0||c.y>=this.state.battleMap.height||a.has(d))continue;const h=this.state.battleMap.tiles[c.y][c.x];if("wall"===h.type||h.occupied)continue;const u=r.get(l)+("difficult"===h.type?2:1);(!r.has(d)||u<r.get(d))&&(n.set(d,{x:o.x,y:o.y}),r.set(d,u),i.set(d,u+this.heuristic(c,t.position)),s.find(e=>e.x===c.x&&e.y===c.y)||s.push({x:c.x,y:c.y,g:u,h:this.heuristic(c,t.position),f:u+this.heuristic(c,t.position),parent:null}))}}return[{x:e.position.x,y:e.position.y}]}heuristic(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}findRetreatPosition(e,t){const s=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];for(const a of s){const s=e.position.x+a.dx,n=e.position.y+a.dy;if(s>=0&&s<this.state.battleMap.width&&n>=0&&n<this.state.battleMap.height){const e=this.state.battleMap.tiles[n][s];if("wall"!==e.type&&!e.occupied&&Math.abs(s-t.position.x)+Math.abs(n-t.position.y)>1)return{x:s,y:n}}}return null}findTacticalPosition(e,t){const s=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];let a=null,n=-1/0;for(const r of s){const s=e.position.x+r.dx,i=e.position.y+r.dy;if(s<0||s>=this.state.battleMap.width||i<0||i>=this.state.battleMap.height)continue;const o=this.state.battleMap.tiles[i][s];if("wall"===o.type||o.occupied)continue;const l=2*o.cover+(o.elevation>this.state.battleMap.tiles[e.position.y][e.position.x].elevation?1:0)-(Math.abs(s-t.position.x)+Math.abs(i-t.position.y));l>n&&(n=l,a={x:s,y:i})}return a}getMovementTowardsPlayers(e){const t=this.state.combatants.filter(e=>"player"===e.type&&e.health>0);if(0===t.length)return{type:"end-turn"};const s=t.reduce((t,s)=>{const a=Math.abs(t.position.x-e.position.x)+Math.abs(t.position.y-e.position.y);return Math.abs(s.position.x-e.position.x)+Math.abs(s.position.y-e.position.y)<a?s:t}),a=this.findPathToTarget(e,s);return a.length>1&&e.currentActionPoints.move>0?{type:"move",target:a[1],path:a}:{type:"end-turn"}}executeAttack(e,t){if(e.currentActionPoints.action<=0)return{success:!1,message:"No action points remaining"};if(!t.target||"string"==typeof t.target)return{success:!1,message:"Invalid attack target"};const s=t.target.x,a=t.target.y,n=this.state.combatants.find(t=>t.position.x===s&&t.position.y===a&&t.id!==e.id);if(!n)return{success:!1,message:"No target at specified position"};if(!this.calculateLineOfSight(e.position,n.position))return{success:!1,message:"Target not in line of sight"};if(Math.abs(s-e.position.x)+Math.abs(a-e.position.y)>e.reach)return{success:!1,message:"Target out of range"};const r=Math.floor(20*Math.random())+1,i=Math.floor((e.stats.strength-10)/2),o=this.calculateFlankingBonus(e,n);if(r+i+o>=n.stats.armorClass){const t=this.calculateDamage(e),s=this.state.combatants.map(e=>{if(e.id===n.id){const s=Math.max(0,e.health-t);return{...e,health:s}}return e});this.state.combatants=s;const a=o>0?" (flanking!)":"";this.addCombatLog(e.id,"attack",`${e.name} hit ${n.name} for ${t} damage${a}`),n.health-t<=0&&this.addCombatLog(n.id,"defeat",`${n.name} was defeated!`);const r=this.state.combatants.find(t=>t.id===e.id);return r&&r.currentActionPoints.action--,{success:!0,message:`${e.name} hit ${n.name} for ${t} damage${a}`,newState:this.getState()}}{this.addCombatLog(e.id,"attack",`${e.name} missed ${n.name}`);const t=this.state.combatants.find(t=>t.id===e.id);return t&&t.currentActionPoints.action--,{success:!0,message:`${e.name} missed ${n.name}`,newState:this.getState()}}}executeSkill(e,t){if(e.currentActionPoints.action<=0)return{success:!1,message:"No action points remaining"};if(!t.skillId)return{success:!1,message:"No skill specified"};const s=e.skills[t.skillId];if(!s)return{success:!1,message:"Skill not found"};this.addCombatLog(e.id,"skill",`${e.name} used ${s.name}`);const a=this.state.combatants.find(t=>t.id===e.id);return a&&a.currentActionPoints.action--,{success:!0,message:`${e.name} used ${s.name}`,newState:this.getState()}}endTurn(){var e;const t=this.getActiveCombatant();if(!t)return{success:!1,message:"No active combatant"};const s=this.state.combatants.map(e=>e.id===t.id?{...e,hasActed:!0}:e);return this.state.combatants=s,this.addCombatLog(t.id,"end-turn",`${t.name} ended their turn`),this.state.currentCombatantIndex=(this.state.currentCombatantIndex+1)%this.state.turnOrder.length,0===this.state.currentCombatantIndex&&(this.state.round++,this.startNewRound()),this.setActiveCombatant(this.state.currentCombatantIndex),{success:!0,message:`Turn ended. Next: ${(null==(e=this.getActiveCombatant())?void 0:e.name)||"Unknown"}`,newState:this.getState()}}startNewRound(){this.state.combatants=this.state.combatants.map(e=>({...e,currentActionPoints:{...e.actionPoints},hasActed:!1})),this.addCombatLog("system","round",`Round ${this.state.round} begins!`)}setActiveCombatant(e){this.state.combatants=this.state.combatants.map(e=>({...e,isActive:!1}));const t=this.state.turnOrder[e],s=this.state.combatants.find(e=>e.id===t);s&&(s.isActive=!0)}calculateDamage(e){const t=Math.floor((e.stats.strength-10)/2);return Math.max(1,Math.floor(6*Math.random())+1+t)}addCombatLog(e,t,s){const a={id:Date.now().toString(),turn:this.state.currentTurn,combatantId:e,action:t,result:s,timestamp:Date.now()};this.state.combatLog.push(a)}endCombat(){return this.state.isActive=!1,this.getState()}checkCombatEnd(){const e=this.state.combatants.filter(e=>"player"===e.type),t=this.state.combatants.filter(e=>"enemy"===e.type),s=e.filter(e=>e.health>0),a=t.filter(e=>e.health>0);return 0===s.length?{ended:!0,winner:"enemies"}:0===a.length?{ended:!0,winner:"players"}:{ended:!1}}executeAITurn(){const e=this.getActiveCombatant();if(!e||"enemy"!==e.type)return{success:!1,message:"No enemy combatant active"};const t=this.getEnemyAIAction(e);return t?this.executeAction(t):this.endTurn()}}const Vo=({onOpenAuth:e})=>it.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-black text-white flex flex-col items-center justify-center font-inter",children:[it.jsxs("section",{className:"relative w-full py-20 px-4 text-center overflow-hidden",children:[it.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-900/30 to-blue-900/30 opacity-70 animate-pulse-slow"}),it.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-transparent via-transparent to-black"}),it.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto",children:[it.jsx("h1",{className:"text-5xl md:text-7xl font-extrabold mb-6 leading-tight tracking-tighter drop-shadow-lg animate-fade-in-up",children:"MythSeeker: Your Epic Adventures Await"}),it.jsx("p",{className:"text-xl md:text-2xl text-gray-300 mb-10 leading-relaxed animate-fade-in-up delay-200",children:"Unleash limitless stories with an AI Dungeon Master, dynamic worlds, and seamless multiplayer."}),it.jsx("button",{onClick:e,className:"px-10 py-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white text-xl font-bold rounded-full shadow-lg hover:from-purple-700 hover:to-indigo-700 transform hover:scale-105 transition-all duration-300 animate-bounce-in",children:"Start Your Adventure Now"})]})]}),it.jsx("section",{className:"w-full py-16 px-4 bg-gray-950/70 backdrop-blur-sm border-t border-b border-gray-800",children:it.jsxs("div",{className:"max-w-6xl mx-auto",children:[it.jsx("h2",{className:"text-4xl font-bold text-center mb-12 text-purple-300 drop-shadow-md animate-fade-in",children:"Why Choose MythSeeker?"}),it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10",children:[it.jsxs("div",{className:"bg-gray-800/50 p-8 rounded-xl shadow-xl border border-gray-700/50 transform hover:scale-[1.02] transition-transform duration-300 animate-fade-in delay-300",children:[it.jsx("div",{className:"text-purple-400 mb-4 flex justify-center",children:it.jsx(me,{size:48})}),it.jsx("h3",{className:"text-2xl font-semibold mb-3 text-center",children:"AI Dungeon Master"}),it.jsx("p",{className:"text-gray-300 text-center",children:"Experience dynamic, adaptive storytelling tailored to your choices. No two campaigns are ever the same!"})]}),it.jsxs("div",{className:"bg-gray-800/50 p-8 rounded-xl shadow-xl border border-gray-700/50 transform hover:scale-[1.02] transition-transform duration-300 animate-fade-in delay-400",children:[it.jsx("div",{className:"text-blue-400 mb-4 flex justify-center",children:it.jsx(te,{size:48})}),it.jsx("h3",{className:"text-2xl font-semibold mb-3 text-center",children:"Seamless Multiplayer"}),it.jsx("p",{className:"text-gray-300 text-center",children:"Play with friends in real-time. Share your epic quests and overcome challenges together."})]}),it.jsxs("div",{className:"bg-gray-800/50 p-8 rounded-xl shadow-xl border border-gray-700/50 transform hover:scale-[1.02] transition-transform duration-300 animate-fade-in delay-500",children:[it.jsx("div",{className:"text-green-400 mb-4 flex justify-center",children:it.jsx(Ne,{size:48})}),it.jsx("h3",{className:"text-2xl font-semibold mb-3 text-center",children:"Living Worlds"}),it.jsx("p",{className:"text-gray-300 text-center",children:"Explore vast, evolving worlds where your actions have lasting consequences."})]}),it.jsxs("div",{className:"bg-gray-800/50 p-8 rounded-xl shadow-xl border border-gray-700/50 transform hover:scale-[1.02] transition-transform duration-300 animate-fade-in delay-600",children:[it.jsx("div",{className:"text-red-400 mb-4 flex justify-center",children:it.jsx(Se,{size:48})}),it.jsx("h3",{className:"text-2xl font-semibold mb-3 text-center",children:"Engaging Combat"}),it.jsx("p",{className:"text-gray-300 text-center",children:"Dive into tactical turn-based combat with dynamic environments and challenging foes."})]}),it.jsxs("div",{className:"bg-gray-800/50 p-8 rounded-xl shadow-xl border border-gray-700/50 transform hover:scale-[1.02] transition-transform duration-300 animate-fade-in delay-700",children:[it.jsx("div",{className:"text-yellow-400 mb-4 flex justify-center",children:it.jsx(ke,{size:48})}),it.jsx("h3",{className:"text-2xl font-semibold mb-3 text-center",children:"Rich Lore & Quests"}),it.jsx("p",{className:"text-gray-300 text-center",children:"Uncover deep lore and embark on procedurally generated quests that keep you on the edge of your seat."})]}),it.jsxs("div",{className:"bg-gray-800/50 p-8 rounded-xl shadow-xl border border-gray-700/50 transform hover:scale-[1.02] transition-transform duration-300 animate-fade-in delay-800",children:[it.jsx("div",{className:"text-cyan-400 mb-4 flex justify-center",children:it.jsx(Ce,{size:48})}),it.jsx("h3",{className:"text-2xl font-semibold mb-3 text-center",children:"Campaign Log"}),it.jsx("p",{className:"text-gray-300 text-center",children:"Keep track of your adventures, character progress, and world events with an intuitive campaign log."})]})]})]})}),it.jsx("section",{className:"w-full py-20 px-4 text-center bg-gray-900",children:it.jsxs("div",{className:"max-w-3xl mx-auto",children:[it.jsx("h2",{className:"text-4xl font-bold mb-6 text-indigo-300 drop-shadow-md animate-fade-in",children:"Ready to Forge Your Legend?"}),it.jsx("p",{className:"text-xl text-gray-300 mb-10 animate-fade-in delay-200",children:"Join thousands of adventurers already exploring endless possibilities in MythSeeker."}),it.jsx("button",{onClick:e,className:"px-12 py-5 bg-gradient-to-r from-blue-600 to-purple-600 text-white text-2xl font-bold rounded-full shadow-xl hover:from-blue-700 hover:to-purple-700 transform hover:scale-105 transition-all duration-300 animate-bounce-in delay-300",children:"Play Free Now"})]})}),it.jsxs("footer",{className:"w-full py-8 px-4 bg-black text-gray-500 text-center text-sm",children:[it.jsxs("p",{children:["© ",(new Date).getFullYear()," MythSeeker. All rights reserved."]}),it.jsxs("div",{className:"mt-2 space-x-4",children:[it.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Privacy Policy"}),it.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Terms of Service"}),it.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Contact Us"})]})]}),it.jsx("style",{dangerouslySetInnerHTML:{__html:"\n            @keyframes fadeIn {\n              from { opacity: 0; }\n              to { opacity: 1; }\n            }\n            @keyframes fadeInUp {\n              from { opacity: 0; transform: translateY(20px); }\n              to { opacity: 1; transform: translateY(0); }\n            }\n            @keyframes bounceIn {\n              0%, 20%, 40%, 60%, 80%, 100% {\n                transition-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);\n              }\n              0% {\n                opacity: 0;\n                transform: scale3d(0.3, 0.3, 0.3);\n              }\n              20% {\n                transform: scale3d(1.1, 1.1, 1.1);\n              }\n              40% {\n                transform: scale3d(0.9, 0.9, 0.9);\n              }\n              60% {\n                opacity: 1;\n                transform: scale3d(1.03, 1.03, 1.03);\n              }\n              80% {\n                transform: scale3d(0.97, 0.97, 0.97);\n              }\n              100% {\n                opacity: 1;\n                transform: scale3d(1, 1, 1);\n              }\n            }\n            @keyframes pulseSlow {\n              0%, 100% { opacity: 0.7; }\n              50% { opacity: 0.9; }\n            }\n            .animate-fade-in { animation: fadeIn 1s ease-out forwards; }\n            .animate-fade-in-up { animation: fadeInUp 0.8s ease-out forwards; }\n            .animate-fade-in-up.delay-200 { animation-delay: 0.2s; }\n            .animate-bounce-in { animation: bounceIn 1s; }\n            .animate-bounce-in.delay-300 { animation-delay: 0.3s; }\n            .animate-pulse-slow { animation: pulseSlow 4s infinite alternate; }\n          "}})]}),Ko=({user:e,campaigns:t,characters:a,onNavigate:n,onCreateCampaign:r,onCreateCharacter:i,onJoinCampaign:o,onResumeCampaign:l,onOpenDiceRoller:c,onOpenProfile:d,onOpenSettings:h,onOpenAchievements:u,onOpenHelp:m})=>{const[p,x]=s.useState([]),[g,f]=s.useState([]),[b,y]=s.useState({totalPlayTime:"0h 0m",campaignsCompleted:0,charactersCreated:0,diceRolls:0,achievements:0});s.useEffect(()=>{x(t.filter(e=>"active"===e.status||"waiting"===e.status)),f([{type:"campaign_joined",title:'Joined "Lost Mines"',time:"2 hours ago",icon:it.jsx(be,{className:"w-4 h-4"})},{type:"character_created",title:'Created "Thorin Stonefist"',time:"1 day ago",icon:it.jsx(ve,{className:"w-4 h-4"})},{type:"achievement",title:'Unlocked "First Steps"',time:"2 days ago",icon:it.jsx(ae,{className:"w-4 h-4"})},{type:"dice_roll",title:"Rolled 20 on d20!",time:"3 days ago",icon:it.jsx(ne,{className:"w-4 h-4"})}])},[t]);const v=[{id:"resume",title:"Resume Adventure",description:"Continue your latest campaign",icon:it.jsx(Ee,{className:"w-6 h-6"}),action:()=>{p.length>0?l(p[0].id):r()},color:"from-emerald-500 to-teal-600",gradient:"bg-gradient-to-r from-emerald-500 to-teal-600",badge:p.length>0?`${p.length} Active`:void 0},{id:"new-campaign",title:"New Campaign",description:"Start a fresh adventure",icon:it.jsx(Pe,{className:"w-6 h-6"}),action:r,color:"from-blue-500 to-indigo-600",gradient:"bg-gradient-to-r from-blue-500 to-indigo-600"},{id:"join-campaign",title:"Join Campaign",description:"Enter with a friend's code",icon:it.jsx(te,{className:"w-6 h-6"}),action:o,color:"from-purple-500 to-pink-600",gradient:"bg-gradient-to-r from-purple-500 to-pink-600"},{id:"dice-roller",title:"Dice Roller",description:"Roll some dice!",icon:it.jsx(ne,{className:"w-6 h-6"}),action:c,color:"from-orange-500 to-red-600",gradient:"bg-gradient-to-r from-orange-500 to-red-600"}],w=[{id:"campaigns",title:"Campaigns",description:"Manage your adventures",icon:it.jsx(be,{className:"w-8 h-8"}),path:"/campaigns",color:"from-blue-500 to-indigo-600",gradient:"bg-gradient-to-br from-blue-500 to-indigo-600",stats:[{label:"Active",value:p.length},{label:"Total",value:t.length}]},{id:"characters",title:"Characters",description:"Your heroes and companions",icon:it.jsx(ve,{className:"w-8 h-8"}),path:"/characters",color:"from-green-500 to-emerald-600",gradient:"bg-gradient-to-br from-green-500 to-emerald-600",stats:[{label:"Created",value:a.length},{label:"Active",value:a.filter(e=>e.isActive).length}]},{id:"party",title:"Party",description:"Team up with friends",icon:it.jsx(te,{className:"w-8 h-8"}),path:"/party",color:"from-purple-500 to-pink-600",gradient:"bg-gradient-to-br from-purple-500 to-pink-600",stats:[{label:"Members",value:"3-6"},{label:"Online",value:"2"}]},{id:"world",title:"World",description:"Explore the realm",icon:it.jsx(Ne,{className:"w-8 h-8"}),path:"/world",color:"from-teal-500 to-cyan-600",gradient:"bg-gradient-to-br from-teal-500 to-cyan-600",stats:[{label:"Locations",value:"12"},{label:"Discovered",value:"8"}]},{id:"combat",title:"Combat",description:"Battle system & tactics",icon:it.jsx(ie,{className:"w-8 h-8"}),path:"/combat",color:"from-red-500 to-pink-600",gradient:"bg-gradient-to-br from-red-500 to-pink-600",stats:[{label:"Encounters",value:"5"},{label:"Victories",value:"4"}]},{id:"magic",title:"Magic",description:"Spells & abilities",icon:it.jsx(Se,{className:"w-8 h-8"}),path:"/magic",color:"from-indigo-500 to-purple-600",gradient:"bg-gradient-to-br from-indigo-500 to-purple-600",stats:[{label:"Spells",value:"24"},{label:"Prepared",value:"8"}]},{id:"dm-center",title:"DM Center",description:"Dungeon Master tools",icon:it.jsx(Ie,{className:"w-8 h-8"}),path:"/dm-center",color:"from-yellow-500 to-orange-600",gradient:"bg-gradient-to-br from-yellow-500 to-orange-600",isNew:!0},{id:"achievements",title:"Achievements",description:"Track your progress",icon:it.jsx(ae,{className:"w-8 h-8"}),path:"/achievements",color:"from-amber-500 to-yellow-600",gradient:"bg-gradient-to-br from-amber-500 to-yellow-600",stats:[{label:"Unlocked",value:b.achievements},{label:"Total",value:"50"}]}];return it.jsxs("div",{className:"h-full overflow-y-auto bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 text-white",children:[it.jsxs("div",{className:"relative overflow-hidden",children:[it.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/20 to-purple-600/20"}),it.jsx("div",{className:"relative px-6 py-8",children:it.jsxs("div",{className:"max-w-7xl mx-auto",children:[it.jsxs("div",{className:"mb-8",children:[it.jsxs("h1",{className:"text-4xl font-bold mb-2",children:[(()=>{const e=(new Date).getHours();return e<12?"Good morning":e<17?"Good afternoon":"Good evening"})(),", ",(null==e?void 0:e.displayName)||"Adventurer","! 👋"]}),it.jsx("p",{className:"text-blue-200 text-lg",children:"Ready for your next epic adventure?"})]}),it.jsxs("div",{className:"mb-8",children:[it.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[it.jsx(ue,{className:"w-6 h-6 mr-2 text-yellow-400"}),"Quick Actions"]}),it.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:v.map(e=>it.jsxs("button",{onClick:e.action,className:`relative group p-6 rounded-xl ${e.gradient} hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl`,children:[it.jsxs("div",{className:"flex items-center justify-between mb-3",children:[it.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.icon}),e.badge&&it.jsx("span",{className:"px-2 py-1 bg-white/20 rounded-full text-xs font-medium",children:e.badge})]}),it.jsx("h3",{className:"font-semibold text-lg mb-1",children:e.title}),it.jsx("p",{className:"text-white/80 text-sm",children:e.description}),it.jsx(Te,{className:"w-4 h-4 absolute bottom-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity"})]},e.id))})]})]})})]}),it.jsx("div",{className:"px-6 pb-8",children:it.jsx("div",{className:"max-w-7xl mx-auto",children:it.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[it.jsxs("div",{className:"lg:col-span-2",children:[it.jsxs("div",{className:"flex items-center justify-between mb-6",children:[it.jsxs("h2",{className:"text-2xl font-semibold flex items-center",children:[it.jsx(Ae,{className:"w-6 h-6 mr-2 text-blue-400"}),"Game Features"]}),it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:it.jsx(Me,{className:"w-4 h-4"})}),it.jsx("button",{className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:it.jsx(De,{className:"w-4 h-4"})})]})]}),it.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map(e=>it.jsxs("button",{onClick:()=>n(e.path),className:"group relative p-6 rounded-xl bg-slate-800/50 hover:bg-slate-800/70 transition-all duration-200 border border-slate-700/50 hover:border-slate-600/50",children:[e.isNew&&it.jsx("span",{className:"absolute -top-2 -right-2 px-2 py-1 bg-gradient-to-r from-pink-500 to-purple-600 rounded-full text-xs font-medium",children:"NEW"}),it.jsxs("div",{className:"flex items-start justify-between mb-4",children:[it.jsx("div",{className:`p-3 rounded-lg ${e.gradient}`,children:e.icon}),it.jsx(ge,{className:"w-5 h-5 text-slate-400 group-hover:text-white transition-colors"})]}),it.jsx("h3",{className:"font-semibold text-lg mb-2 text-left",children:e.title}),it.jsx("p",{className:"text-slate-300 text-sm mb-4 text-left",children:e.description}),e.stats&&it.jsx("div",{className:"flex space-x-4",children:e.stats.map((e,t)=>it.jsxs("div",{className:"text-left",children:[it.jsx("div",{className:"text-lg font-semibold text-white",children:e.value}),it.jsx("div",{className:"text-xs text-slate-400",children:e.label})]},t))})]},e.id))})]}),it.jsxs("div",{className:"space-y-6",children:[it.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700/50",children:[it.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[it.jsx(Ee,{className:"w-5 h-5 mr-2 text-green-400"}),"Active Campaigns"]}),0===p.length?it.jsxs("div",{className:"text-center py-4",children:[it.jsx(be,{className:"w-8 h-8 text-slate-400 mx-auto mb-2"}),it.jsx("p",{className:"text-slate-300 text-sm mb-3",children:"No active campaigns"}),it.jsx("button",{onClick:r,className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded text-sm font-medium transition-colors",children:"Create Campaign"})]}):it.jsxs("div",{className:"space-y-3",children:[p.slice(0,3).map(e=>it.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700/30 rounded-lg",children:[it.jsxs("div",{className:"flex-1 min-w-0",children:[it.jsx("h4",{className:"font-medium text-sm truncate",children:e.name}),it.jsx("p",{className:"text-xs text-slate-400",children:e.theme})]}),it.jsx("button",{onClick:()=>l(e.id),className:"ml-2 p-1.5 bg-green-600 hover:bg-green-700 rounded text-white transition-colors",children:it.jsx(Ee,{className:"w-3 h-3"})})]},e.id)),p.length>3&&it.jsxs("button",{onClick:()=>n("/campaigns"),className:"w-full text-center text-sm text-blue-400 hover:text-blue-300 transition-colors",children:["View all ",p.length," campaigns"]})]})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700/50",children:[it.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[it.jsx(se,{className:"w-5 h-5 mr-2 text-orange-400"}),"Recent Activity"]}),it.jsx("div",{className:"space-y-3",children:g.map((e,t)=>it.jsxs("div",{className:"flex items-start space-x-3",children:[it.jsx("div",{className:"p-1.5 bg-slate-700/50 rounded-lg",children:e.icon}),it.jsxs("div",{className:"flex-1 min-w-0",children:[it.jsx("p",{className:"text-sm font-medium truncate",children:e.title}),it.jsx("p",{className:"text-xs text-slate-400",children:e.time})]})]},t))})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700/50",children:[it.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[it.jsx(we,{className:"w-5 h-5 mr-2 text-slate-400"}),"Quick Settings"]}),it.jsxs("div",{className:"space-y-3",children:[it.jsxs("button",{onClick:c,className:"w-full flex items-center justify-between p-3 bg-slate-700/30 rounded-lg hover:bg-slate-700/50 transition-colors",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx(ne,{className:"w-4 h-4 text-green-400"}),it.jsx("span",{className:"text-sm",children:"Dice Roller"})]}),it.jsx(ge,{className:"w-4 h-4 text-slate-400"})]}),it.jsxs("button",{onClick:d,className:"w-full flex items-center justify-between p-3 bg-slate-700/30 rounded-lg hover:bg-slate-700/50 transition-colors",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx(ve,{className:"w-4 h-4 text-blue-400"}),it.jsx("span",{className:"text-sm",children:"Profile"})]}),it.jsx(ge,{className:"w-4 h-4 text-slate-400"})]}),it.jsxs("button",{onClick:u,className:"w-full flex items-center justify-between p-3 bg-slate-700/30 rounded-lg hover:bg-slate-700/50 transition-colors",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx(ae,{className:"w-4 h-4 text-yellow-400"}),it.jsx("span",{className:"text-sm",children:"Achievements"})]}),it.jsx(ge,{className:"w-4 h-4 text-slate-400"})]})]})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700/50",children:[it.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[it.jsx(Re,{className:"w-5 h-5 mr-2 text-purple-400"}),"Your Stats"]}),it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx(se,{className:"w-4 h-4 text-blue-400"}),it.jsx("span",{className:"text-sm",children:"Play Time"})]}),it.jsx("span",{className:"font-semibold",children:b.totalPlayTime})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx(ae,{className:"w-4 h-4 text-yellow-400"}),it.jsx("span",{className:"text-sm",children:"Achievements"})]}),it.jsxs("span",{className:"font-semibold",children:[b.achievements,"/50"]})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx(ne,{className:"w-4 h-4 text-green-400"}),it.jsx("span",{className:"text-sm",children:"Dice Rolls"})]}),it.jsx("span",{className:"font-semibold",children:b.diceRolls})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx(be,{className:"w-4 h-4 text-purple-400"}),it.jsx("span",{className:"text-sm",children:"Campaigns"})]}),it.jsx("span",{className:"font-semibold",children:b.campaignsCompleted})]})]})]})]})]})})})]})},Qo=new class{constructor(){t(this,"STORAGE_KEY","mythseeker_dice_rolls"),t(this,"STATS_KEY","mythseeker_dice_stats"),t(this,"SETTINGS_KEY","mythseeker_dice_settings")}getRolls(){try{const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):[]}catch(e){return[]}}addRoll(e){const t={...e,id:this.generateId(),timestamp:Date.now()},s=this.getRolls();return s.unshift(t),s.length>1e3&&s.splice(1e3),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(s)),this.updateStats(),t}getFilteredRolls(e){let t=this.getRolls();return e.sides&&(t=t.filter(t=>t.sides===e.sides)),e.campaignId&&(t=t.filter(t=>t.campaignId===e.campaignId)),e.characterId&&(t=t.filter(t=>t.characterId===e.characterId)),e.startDate&&(t=t.filter(t=>t.timestamp>=e.startDate)),e.endDate&&(t=t.filter(t=>t.timestamp<=e.endDate)),e.limit&&(t=t.slice(0,e.limit)),t}getStats(){try{const e=localStorage.getItem(this.STATS_KEY);return e?JSON.parse(e):this.calculateStats()}catch(e){return this.calculateStats()}}calculateStats(){var e;const t=this.getRolls();if(0===t.length)return{totalRolls:0,averageRoll:0,highestRoll:0,lowestRoll:0,mostRolledSides:0,rollDistribution:{},recentRolls:[]};const s=t.length,a=t.reduce((e,t)=>e+t.result,0)/s,n=Math.max(...t.map(e=>e.result)),r=Math.min(...t.map(e=>e.result)),i={};t.forEach(e=>{i[e.sides]=(i[e.sides]||0)+1});const o=(null==(e=Object.entries(i).sort(([,e],[,t])=>t-e)[0])?void 0:e[0])||"0";return{totalRolls:s,averageRoll:Math.round(100*a)/100,highestRoll:n,lowestRoll:r,mostRolledSides:parseInt(o),rollDistribution:i,recentRolls:t.slice(0,10)}}updateStats(){const e=this.calculateStats();localStorage.setItem(this.STATS_KEY,JSON.stringify(e))}getDiceSets(){const e=[{id:"classic",name:"Classic Purple",color:9133302,roughness:.5,metalness:.8,unlocked:!0,rarity:"common"},{id:"crystal",name:"Crystal Blue",color:3900150,roughness:.1,metalness:.9,emissive:934063,emissiveIntensity:.2,unlocked:!0,rarity:"common"},{id:"golden",name:"Golden",color:16498468,roughness:0,metalness:1,unlocked:!1,rarity:"rare"},{id:"emerald",name:"Emerald",color:1096065,roughness:0,metalness:.7,unlocked:!1,rarity:"rare"},{id:"ruby",name:"Ruby",color:15680580,roughness:0,metalness:.6,unlocked:!1,rarity:"epic"},{id:"obsidian",name:"Obsidian",color:2042167,roughness:.8,metalness:.3,unlocked:!1,rarity:"legendary"},{id:"wooden",name:"Wooden",color:9584654,roughness:.9,metalness:1,unlocked:!0,rarity:"common"},{id:"neon",name:"Neon Pink",color:15485081,roughness:.2,metalness:.8,emissive:15485081,emissiveIntensity:.3,unlocked:!1,rarity:"epic"}];try{const t=localStorage.getItem("mythseeker_dice_sets");if(t){const s=JSON.parse(t);return e.map(e=>({...e,...s.find(t=>t.id===e.id)}))}}catch(t){}return e}unlockDiceSet(e){const t=this.getDiceSets(),s=t.findIndex(t=>t.id===e);-1!==s&&(t[s].unlocked=!0,localStorage.setItem("mythseeker_dice_sets",JSON.stringify(t)))}getSettings(){try{const e=localStorage.getItem(this.SETTINGS_KEY);return e?JSON.parse(e):this.getDefaultSettings()}catch(e){return this.getDefaultSettings()}}updateSettings(e){localStorage.setItem(this.SETTINGS_KEY,JSON.stringify(e))}getDefaultSettings(){return{soundEnabled:!0,hapticEnabled:!0,shakeToRoll:!0,showHistory:!0,autoSaveRolls:!0,defaultSides:20,defaultDiceSet:"classic"}}clearData(){localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem(this.STATS_KEY),localStorage.removeItem(this.SETTINGS_KEY)}exportData(){const e={rolls:this.getRolls(),stats:this.getStats(),settings:this.getSettings(),diceSets:this.getDiceSets(),exportDate:(new Date).toISOString()};return JSON.stringify(e,null,2)}importData(e){try{const t=JSON.parse(e);return t.rolls&&localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t.rolls)),t.stats&&localStorage.setItem(this.STATS_KEY,JSON.stringify(t.stats)),t.settings&&localStorage.setItem(this.SETTINGS_KEY,JSON.stringify(t.settings)),t.diceSets&&localStorage.setItem("mythseeker_dice_sets",JSON.stringify(t.diceSets)),!0}catch(t){return!1}}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}getRollStreak(){const e=this.getRolls();if(e.length<2)return{number:0,count:0};let t=1,s=1,a=e[0].result;for(let n=1;n<e.length;n++)e[n].result===e[n-1].result?(t++,t>s&&(s=t,a=e[n].result)):t=1;return{number:a,count:s}}getLuckyRolls(){const e=this.getRolls();return{natural20s:e.filter(e=>20===e.sides&&20===e.result).length,natural1s:e.filter(e=>1===e.result).length}}},Xo=({isOpen:e,onClose:t,onRollComplete:a,defaultDice:n=[{sides:20,count:1}]})=>{const[r,i]=s.useState(n),[o,l]=s.useState([]),[c,d]=s.useState(!1),[h,u]=s.useState([]);s.useEffect(()=>{if(e){const e=Qo.getFilteredRolls({limit:5}).map(e=>({dice:[{sides:e.sides,count:1}],results:[e.result],total:e.result,timestamp:e.timestamp}));u(e)}},[e]);const m=e=>{i(t=>t.find(t=>t.sides===e)?t.map(t=>t.sides===e?{...t,count:t.count+1}:t):[...t,{sides:e,count:1}])},p=()=>r.reduce((e,t)=>e+t.count,0);return e?it.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:it.jsxs("div",{className:"bg-gradient-to-br from-purple-900/95 to-blue-900/95 backdrop-blur-lg rounded-2xl p-6 border border-purple-400/30 shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[it.jsxs("div",{className:"flex items-center justify-between mb-6",children:[it.jsx("h2",{className:"text-2xl font-bold text-white",children:"🎲 Dice Roller"}),it.jsx("button",{onClick:()=>t(o.length>0?o:void 0),className:"text-gray-300 hover:text-white text-2xl font-bold",children:"×"})]}),it.jsxs("div",{className:"mb-6",children:[it.jsxs("div",{className:"flex items-center justify-between mb-4",children:[it.jsx("h3",{className:"text-lg font-semibold text-white",children:"Configure Dice"}),it.jsx("button",{onClick:()=>{i([])},className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm transition-colors",children:"Clear All"})]}),it.jsx("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[4,6,8,10,12,20,100].map(e=>it.jsxs("button",{onClick:()=>m(e),className:"px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:["d",e]},e))}),r.length>0?it.jsx("div",{className:"space-y-2",children:r.map(e=>it.jsxs("div",{className:"flex items-center justify-between bg-gray-800/50 rounded-lg p-3",children:[it.jsxs("span",{className:"text-white font-medium",children:[e.count," × d",e.sides]}),it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsx("button",{onClick:()=>{return t=e.sides,void i(e=>{const s=e.find(e=>e.sides===t);return s&&s.count>1?e.map(e=>e.sides===t?{...e,count:e.count-1}:e):e.filter(e=>e.sides!==t)});var t},className:"w-8 h-8 bg-red-600 hover:bg-red-700 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"-"}),it.jsx("span",{className:"text-white font-bold min-w-[2rem] text-center",children:e.count}),it.jsx("button",{onClick:()=>m(e.sides),className:"w-8 h-8 bg-green-600 hover:bg-green-700 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"+"})]})]},e.sides))}):it.jsx("div",{className:"text-gray-400 text-center py-4",children:"Select dice to roll"})]}),it.jsx("button",{onClick:()=>{c||(d(!0),l([]),setTimeout(()=>{const e=[];r.forEach(t=>{for(let s=0;s<t.count;s++){const s=Math.floor(Math.random()*t.sides)+1;e.push(s),Qo.addRoll({sides:t.sides,result:s,context:`Dice Roller - ${t.count}d${t.sides}`})}}),l(e),d(!1);const t=e.reduce((e,t)=>e+t,0),s={dice:[...r],results:[...e],total:t,timestamp:Date.now()};u(e=>[s,...e.slice(0,4)]),a&&a(e)},1e3))},disabled:c||0===p(),className:"w-full py-4 bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed rounded-xl transition-all text-white font-bold text-lg shadow-lg transform hover:scale-105 disabled:transform-none mb-6",children:c?"🎲 Rolling...":`🎲 Roll ${p()} Dice`}),o.length>0&&it.jsxs("div",{className:"mb-6",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Results"}),it.jsxs("div",{className:"bg-gradient-to-r from-yellow-500/20 to-orange-500/20 rounded-xl border border-yellow-400/30 p-4",children:[it.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:o.map((e,t)=>it.jsx("div",{className:"w-12 h-12 bg-yellow-500 text-black font-bold rounded-lg flex items-center justify-center text-lg animate-bounce",children:e},t))}),it.jsxs("div",{className:"text-center",children:[it.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:["Total: ",o.reduce((e,t)=>e+t,0)]}),it.jsx("div",{className:"text-yellow-200 text-sm",children:o.length>1?`${o.length} dice rolled`:"1 die rolled"})]})]})]}),h.length>0&&it.jsxs("div",{children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Recent Rolls"}),it.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:h.map((e,t)=>it.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsx("div",{className:"text-white text-sm",children:e.dice.map((t,s)=>it.jsxs("span",{children:[t.count,"d",t.sides,s<e.dice.length-1?" + ":""]},s))}),it.jsxs("div",{className:"text-yellow-400 font-bold",children:["= ",e.total]})]}),it.jsx("div",{className:"text-gray-400 text-xs mt-1",children:new Date(e.timestamp).toLocaleTimeString()})]},t))})]})]})}):null},Zo=({user:e,onSignOut:t})=>{const a=cs(),n=is(),[r,i]=s.useState(!1),[o,l]=s.useState(!1),c=[{id:"dashboard",label:"Dashboard",path:"/dashboard",icon:it.jsx(ce,{className:"w-5 h-5"}),description:"Main hub and overview"},{id:"campaigns",label:"Campaigns",path:"/campaigns",icon:it.jsx(be,{className:"w-5 h-5"}),description:"Manage your adventures"},{id:"characters",label:"Characters",path:"/characters",icon:it.jsx(ve,{className:"w-5 h-5"}),description:"Your heroes and companions"},{id:"party",label:"Party",path:"/party",icon:it.jsx(te,{className:"w-5 h-5"}),description:"Team up with friends"},{id:"world",label:"World",path:"/world",icon:it.jsx(Ne,{className:"w-5 h-5"}),description:"Explore the realm"},{id:"combat",label:"Combat",path:"/combat",icon:it.jsx(ie,{className:"w-5 h-5"}),description:"Battle system & tactics"},{id:"magic",label:"Magic",path:"/magic",icon:it.jsx(Se,{className:"w-5 h-5"}),description:"Spells & abilities"},{id:"dm-center",label:"DM Center",path:"/dm-center",icon:it.jsx(Ie,{className:"w-5 h-5"}),description:"Dungeon Master tools",isNew:!0},{id:"achievements",label:"Achievements",path:"/achievements",icon:it.jsx(ae,{className:"w-5 h-5"}),description:"Track your progress"},{id:"profile",label:"Profile",path:"/profile",icon:it.jsx(ve,{className:"w-5 h-5"}),description:"Your account settings"},{id:"settings",label:"Settings",path:"/settings",icon:it.jsx(we,{className:"w-5 h-5"}),description:"App preferences"},{id:"help",label:"Help",path:"/help",icon:it.jsx(Le,{className:"w-5 h-5"}),description:"Support & documentation"}],d=e=>{a(e),i(!1)},h=async()=>{try{await Qs.signOut(),t()}catch(e){}},u=e=>n.pathname===e||n.pathname.startsWith(e+"/");return it.jsxs(it.Fragment,{children:[it.jsxs("nav",{className:"hidden md:flex flex-col bg-slate-800/90 backdrop-blur-sm border-r border-slate-700/50 h-screen sticky top-0 transition-all duration-300 "+(o?"w-16":"w-64"),children:[it.jsx("div",{className:"p-4 border-b border-slate-700/50 "+(o?"px-2":"px-6"),children:it.jsxs("div",{className:"flex items-center justify-between",children:[!o&&it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:it.jsx(me,{className:"w-5 h-5 text-white"})}),it.jsxs("div",{children:[it.jsx("h1",{className:"text-lg font-bold text-white",children:"MythSeeker"}),it.jsx("p",{className:"text-xs text-slate-400",children:"RPG Adventure"})]})]}),o&&it.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center mx-auto",children:it.jsx(me,{className:"w-5 h-5 text-white"})}),it.jsx("button",{onClick:()=>l(!o),className:"p-1 text-slate-400 hover:text-white transition-colors",children:o?it.jsx(ge,{className:"w-4 h-4"}):it.jsx(fe,{className:"w-4 h-4"})})]})}),it.jsx("div",{className:"p-4 border-b border-slate-700/50 "+(o?"px-2":""),children:it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:(null==e?void 0:e.photoURL)?it.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-8 h-8 rounded-full"}):it.jsx(ve,{className:"w-4 h-4 text-white"})}),!o&&it.jsxs("div",{className:"flex-1 min-w-0",children:[it.jsx("p",{className:"text-sm font-medium text-white truncate",children:(null==e?void 0:e.displayName)||"Adventurer"}),it.jsx("p",{className:"text-xs text-slate-400 truncate",children:null==e?void 0:e.email})]})]})}),it.jsx("div",{className:"flex-1 overflow-y-auto py-4",children:it.jsx("div",{className:"space-y-1 "+(o?"px-2":"px-4"),children:c.map(e=>it.jsxs("button",{onClick:()=>d(e.path),className:"w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-all duration-200 group relative "+(u(e.path)?"bg-blue-600/20 text-blue-400 border border-blue-500/30":"text-slate-300 hover:bg-slate-700/50 hover:text-white"),title:o?e.label:void 0,children:[it.jsx("div",{className:"flex-shrink-0 "+(u(e.path)?"text-blue-400":"text-slate-400 group-hover:text-white"),children:e.icon}),!o&&it.jsxs("div",{className:"flex-1 min-w-0",children:[it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsx("span",{className:"text-sm font-medium truncate",children:e.label}),e.isNew&&it.jsx("span",{className:"px-1.5 py-0.5 bg-gradient-to-r from-pink-500 to-purple-600 rounded-full text-xs font-medium",children:"NEW"}),e.badge&&it.jsx("span",{className:"px-1.5 py-0.5 bg-slate-600 rounded-full text-xs",children:e.badge})]}),it.jsx("p",{className:"text-xs text-slate-500 group-hover:text-slate-300 truncate",children:e.description})]}),o&&it.jsx("div",{className:"absolute left-full ml-2 px-2 py-1 bg-slate-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50",children:e.label})]},e.id))})}),it.jsx("div",{className:"p-4 border-t border-slate-700/50 "+(o?"px-2":""),children:it.jsxs("button",{onClick:h,className:"w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-slate-300 hover:bg-slate-700/50 hover:text-white transition-all duration-200 "+(o?"justify-center":""),title:o?"Sign Out":void 0,children:[it.jsx(_e,{className:"w-5 h-5"}),!o&&it.jsx("span",{className:"text-sm font-medium",children:"Sign Out"})]})})]}),it.jsxs("div",{className:"md:hidden",children:[it.jsx("div",{className:"bg-slate-800/90 backdrop-blur-sm border-b border-slate-700/50 p-4",children:it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:it.jsx(me,{className:"w-5 h-5 text-white"})}),it.jsx("span",{className:"text-lg font-bold text-white",children:"MythSeeker"})]}),it.jsx("button",{onClick:()=>i(!r),className:"p-2 text-slate-400 hover:text-white",children:r?it.jsx(he,{className:"w-6 h-6"}):it.jsx(xe,{className:"w-6 h-6"})})]})}),r&&it.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm",children:it.jsxs("div",{className:"absolute top-0 left-0 right-0 bg-slate-800/95 border-b border-slate-700/50 max-h-96 overflow-y-auto",children:[it.jsx("div",{className:"p-4 border-b border-slate-700/50",children:it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center",children:(null==e?void 0:e.photoURL)?it.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-10 h-10 rounded-full"}):it.jsx(ve,{className:"w-5 h-5 text-white"})}),it.jsxs("div",{className:"flex-1 min-w-0",children:[it.jsx("p",{className:"text-sm font-medium text-white truncate",children:(null==e?void 0:e.displayName)||"Adventurer"}),it.jsx("p",{className:"text-xs text-slate-400 truncate",children:null==e?void 0:e.email})]})]})}),it.jsx("div",{className:"p-4 space-y-1",children:c.map(e=>it.jsxs("button",{onClick:()=>d(e.path),className:"w-full flex items-center space-x-3 px-3 py-3 rounded-lg text-left transition-all duration-200 "+(u(e.path)?"bg-blue-600/20 text-blue-400 border border-blue-500/30":"text-slate-300 hover:bg-slate-700/50 hover:text-white"),children:[it.jsx("div",{className:"flex-shrink-0 "+(u(e.path)?"text-blue-400":"text-slate-400"),children:e.icon}),it.jsxs("div",{className:"flex-1 min-w-0",children:[it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsx("span",{className:"text-sm font-medium",children:e.label}),e.isNew&&it.jsx("span",{className:"px-1.5 py-0.5 bg-gradient-to-r from-pink-500 to-purple-600 rounded-full text-xs font-medium",children:"NEW"})]}),it.jsx("p",{className:"text-xs text-slate-500",children:e.description})]})]},e.id))}),it.jsx("div",{className:"p-4 border-t border-slate-700/50",children:it.jsxs("button",{onClick:h,className:"w-full flex items-center space-x-3 px-3 py-3 rounded-lg text-slate-300 hover:bg-slate-700/50 hover:text-white transition-all duration-200",children:[it.jsx(_e,{className:"w-5 h-5"}),it.jsx("span",{className:"text-sm font-medium",children:"Sign Out"})]})})]})}),it.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800/95 backdrop-blur-sm border-t border-slate-700/50 z-40",children:it.jsxs("div",{className:"flex justify-around p-2",children:[c.slice(0,5).map(e=>it.jsxs("button",{onClick:()=>d(e.path),className:"flex flex-col items-center space-y-1 px-3 py-2 rounded-lg transition-all duration-200 "+(u(e.path)?"text-blue-400 bg-blue-600/20":"text-slate-400 hover:text-white"),children:[it.jsx("div",{className:"w-5 h-5",children:e.icon}),it.jsx("span",{className:"text-xs font-medium",children:e.label})]},e.id)),it.jsxs("button",{onClick:()=>i(!r),className:"flex flex-col items-center space-y-1 px-3 py-2 rounded-lg text-slate-400 hover:text-white transition-all duration-200",children:[it.jsx(xe,{className:"w-5 h-5"}),it.jsx("span",{className:"text-xs font-medium",children:"More"})]})]})})]})]})},el=({character:e,calculateStats:t,onUpdateCharacter:a})=>{var n,r,i,o;const[l,c]=s.useState(!1),[d,h]=s.useState(null),[u,m]=s.useState(""),[p,x]=s.useState(!1),g=s.useRef(null);if(!e)return it.jsx("div",{className:"h-full flex items-center justify-center text-white",children:it.jsxs("div",{className:"text-center",children:[it.jsx(Oe,{size:48,className:"mx-auto mb-4 text-blue-400"}),it.jsx("h2",{className:"text-xl font-bold mb-2",children:"No Character Selected"}),it.jsx("p",{className:"text-blue-200",children:"Create a character to view their sheet"})]})});const f=t?t(e):e.baseStats,b=()=>e.portrait?e.portrait:{Warrior:"⚔️",Rogue:"🗡️",Mage:"🔮",Cleric:"⚡",Ranger:"🏹",Bard:"🎵"}[e.class]||"👤",y=t=>{var s,a;const n=null==(s=e.equipment)?void 0:s[t];return n?(null==(a={weapon:{"Iron Sword":"⚔️","Steel Blade":"🗡️","Enchanted Sword":"✨⚔️","Dragon Slayer":"🔥⚔️","Basic Staff":"🔮","Crystal Staff":"💎🔮","War Bow":"🏹","Elven Bow":"🌿🏹"},armor:{"Leather Armor":"🛡️","Chain Mail":"⛓️🛡️","Plate Armor":"⚔️🛡️","Dragon Scale":"🐉🛡️","Mage Robes":"🔮👘","Archmage Robes":"✨🔮👘"}}[t])?void 0:a[n.name])||"📦":null},v=e=>e.toLowerCase().includes("legendary")?"text-yellow-400":e.toLowerCase().includes("rare")?"text-purple-400":e.toLowerCase().includes("uncommon")?"text-blue-400":"text-gray-400";return it.jsxs("div",{className:"h-full overflow-auto p-6 text-white",children:[it.jsxs("div",{className:"bg-white/10 rounded-xl p-6 mb-6 border border-white/20",children:[it.jsxs("div",{className:"flex items-start justify-between mb-4",children:[it.jsxs("div",{className:"flex items-center space-x-4",children:[it.jsxs("div",{className:"relative",children:[it.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-600 to-purple-600 rounded-full flex items-center justify-center text-3xl border-4 border-white/20",children:"string"==typeof b()&&b().startsWith("data:")?it.jsx("img",{src:b(),alt:"Character Portrait",className:"w-full h-full rounded-full object-cover"}):it.jsx("span",{children:b()})}),it.jsx("button",{onClick:()=>x(!0),className:"absolute -bottom-1 -right-1 bg-blue-600 hover:bg-blue-700 rounded-full p-1 transition-colors",title:"Change portrait",children:it.jsx($e,{size:12})})]}),it.jsxs("div",{children:[it.jsx("div",{className:"flex items-center space-x-2 mb-1",children:l&&"name"===d?it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsx("input",{type:"text",value:u,onChange:e=>m(e.target.value),className:"bg-black/30 text-white px-2 py-1 rounded text-2xl font-bold",autoFocus:!0}),it.jsx("button",{onClick:()=>{d&&a&&(a({[d]:u}),h(null),m(""))},className:"text-green-400 hover:text-green-300",children:it.jsx(Ue,{size:16})}),it.jsx("button",{onClick:()=>h(null),className:"text-red-400 hover:text-red-300",children:it.jsx(he,{size:16})})]}):it.jsxs("h1",{className:"text-3xl font-bold flex items-center space-x-2",children:[it.jsx("span",{children:e.name}),l&&it.jsx("button",{onClick:()=>{return t=e.name,h("name"),void m(t);var t},className:"text-blue-400 hover:text-blue-300",children:it.jsx(ze,{size:16})})]})}),it.jsxs("p",{className:"text-blue-200 text-lg",children:["Level ",e.level," ",e.class]}),it.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-blue-200",children:[it.jsxs("div",{className:"flex items-center space-x-1",children:[it.jsx(Fe,{size:12}),it.jsx("span",{children:e.location||"Unknown"})]}),it.jsxs("div",{className:"flex items-center space-x-1",children:[it.jsx(se,{size:12}),it.jsxs("span",{children:[Math.floor(e.totalPlayTime/6e4),"m played"]})]}),it.jsxs("div",{className:"flex items-center space-x-1",children:[it.jsx(te,{size:12}),it.jsxs("span",{children:[e.campaignsJoined||0," campaigns"]})]})]})]})]}),it.jsxs("div",{className:"text-right",children:[it.jsx("div",{className:"text-yellow-400 text-sm",children:"Experience"}),it.jsxs("div",{className:"text-2xl font-bold",children:[e.experience," XP"]}),it.jsxs("div",{className:"text-green-400 text-sm",children:[e.gold||0," Gold"]}),it.jsx("button",{onClick:()=>c(!l),className:"mt-2 px-3 py-1 rounded text-sm transition-colors "+(l?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"),children:l?"Save":"Edit"})]})]}),it.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[it.jsxs("div",{children:[it.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[it.jsx(We,{size:16,className:"text-red-400"}),it.jsx("span",{className:"text-sm",children:"Health"}),it.jsxs("span",{className:"text-sm text-red-400",children:[e.health,"/",e.maxHealth+((null==f?void 0:f.health)||0)]})]}),it.jsx("div",{className:"w-full bg-red-900 rounded-full h-2",children:it.jsx("div",{className:"bg-red-500 h-2 rounded-full transition-all duration-300",style:{width:e.health/(e.maxHealth+((null==f?void 0:f.health)||0))*100+"%"}})})]}),void 0!==e.mana&&it.jsxs("div",{children:[it.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[it.jsx(ue,{size:16,className:"text-blue-400"}),it.jsx("span",{className:"text-sm",children:"Mana"}),it.jsxs("span",{className:"text-sm text-blue-400",children:[e.mana,"/",e.maxMana+((null==f?void 0:f.mana)||0)]})]}),it.jsx("div",{className:"w-full bg-blue-900 rounded-full h-2",children:it.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:e.mana/(e.maxMana+((null==f?void 0:f.mana)||0))*100+"%"}})})]})]})]}),it.jsxs("div",{className:"bg-white/10 rounded-xl p-6 mb-6 border border-white/20",children:[it.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center space-x-2",children:[it.jsx(He,{size:20,className:"text-purple-400"}),it.jsx("span",{children:"Character Model"})]}),it.jsx("div",{className:"flex justify-center",children:it.jsxs("div",{className:"relative w-32 h-48 bg-gradient-to-b from-gray-800 to-gray-900 rounded-lg border-2 border-white/20 flex flex-col items-center justify-center",children:[it.jsx("div",{className:"text-4xl mb-2",children:b()}),it.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[(null==(n=e.equipment)?void 0:n.weapon)&&it.jsx("div",{className:"absolute -right-4 top-1/2 transform -translate-y-1/2 text-2xl",children:y("weapon")}),(null==(r=e.equipment)?void 0:r.armor)&&it.jsx("div",{className:"absolute top-2 text-xl",children:y("armor")})]}),it.jsx("div",{className:"absolute bottom-2 text-xs text-center text-white bg-black/50 px-2 py-1 rounded",children:e.name})]})})]}),it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[it.jsxs("div",{className:"bg-white/10 rounded-xl p-6 border border-white/20",children:[it.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center space-x-2",children:[it.jsx(ee,{size:20,className:"text-green-400"}),it.jsx("span",{children:"Core Stats"})]}),it.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[it.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[it.jsx("div",{className:"text-sm text-blue-200",children:"Strength"}),it.jsx("div",{className:"text-2xl font-bold",children:(null==f?void 0:f.strength)||0}),it.jsxs("div",{className:"text-xs text-green-400",children:["+",Math.floor((((null==f?void 0:f.strength)||0)-10)/2)]})]}),it.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[it.jsx("div",{className:"text-sm text-blue-200",children:"Dexterity"}),it.jsx("div",{className:"text-2xl font-bold",children:(null==f?void 0:f.dexterity)||0}),it.jsxs("div",{className:"text-xs text-green-400",children:["+",Math.floor((((null==f?void 0:f.dexterity)||0)-10)/2)]})]}),it.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[it.jsx("div",{className:"text-sm text-blue-200",children:"Intelligence"}),it.jsx("div",{className:"text-2xl font-bold",children:(null==f?void 0:f.intelligence)||0}),it.jsxs("div",{className:"text-xs text-green-400",children:["+",Math.floor((((null==f?void 0:f.intelligence)||0)-10)/2)]})]}),it.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[it.jsx("div",{className:"text-sm text-blue-200",children:"Charisma"}),it.jsx("div",{className:"text-2xl font-bold",children:(null==f?void 0:f.charisma)||0}),it.jsxs("div",{className:"text-xs text-green-400",children:["+",Math.floor((((null==f?void 0:f.charisma)||0)-10)/2)]})]})]})]}),it.jsxs("div",{className:"bg-white/10 rounded-xl p-6 border border-white/20",children:[it.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center space-x-2",children:[it.jsx(ie,{size:20,className:"text-red-400"}),it.jsx("span",{children:"Combat Stats"})]}),it.jsxs("div",{className:"space-y-3",children:[it.jsxs("div",{className:"flex justify-between items-center",children:[it.jsx("span",{className:"text-blue-200",children:"Attack Bonus"}),it.jsxs("span",{className:"text-white font-semibold",children:["+",(null==f?void 0:f.attack)||0]})]}),it.jsxs("div",{className:"flex justify-between items-center",children:[it.jsx("span",{className:"text-blue-200",children:"Defense"}),it.jsx("span",{className:"text-white font-semibold",children:(null==f?void 0:f.defense)||0})]}),it.jsxs("div",{className:"flex justify-between items-center",children:[it.jsx("span",{className:"text-blue-200",children:"Magic Power"}),it.jsxs("span",{className:"text-white font-semibold",children:["+",(null==f?void 0:f.magic)||0]})]}),it.jsxs("div",{className:"flex justify-between items-center",children:[it.jsx("span",{className:"text-blue-200",children:"Critical Chance"}),it.jsxs("span",{className:"text-white font-semibold",children:[(null==f?void 0:f.crit)||0,"%"]})]})]})]})]}),it.jsxs("div",{className:"bg-white/10 rounded-xl p-6 mb-6 border border-white/20",children:[it.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center space-x-2",children:[it.jsx(Ye,{size:20,className:"text-yellow-400"}),it.jsx("span",{children:"Equipment"})]}),it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(null==(i=e.equipment)?void 0:i.weapon)&&it.jsx("div",{className:"bg-black/20 rounded-lg p-4 border border-white/10",children:it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("div",{className:"text-2xl",children:y("weapon")}),it.jsxs("div",{className:"flex-1",children:[it.jsx("div",{className:`font-semibold ${v(e.equipment.weapon.name)}`,children:e.equipment.weapon.name}),it.jsx("div",{className:"text-sm text-blue-200",children:"Weapon"}),e.equipment.weapon.stats&&it.jsxs("div",{className:"text-xs text-green-400 mt-1",children:["+",e.equipment.weapon.stats.attack||0," Attack"]})]})]})}),(null==(o=e.equipment)?void 0:o.armor)&&it.jsx("div",{className:"bg-black/20 rounded-lg p-4 border border-white/10",children:it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("div",{className:"text-2xl",children:y("armor")}),it.jsxs("div",{className:"flex-1",children:[it.jsx("div",{className:`font-semibold ${v(e.equipment.armor.name)}`,children:e.equipment.armor.name}),it.jsx("div",{className:"text-sm text-blue-200",children:"Armor"}),e.equipment.armor.stats&&it.jsxs("div",{className:"text-xs text-green-400 mt-1",children:["+",e.equipment.armor.stats.defense||0," Defense"]})]})]})})]})]}),e.unlockedSkills&&e.unlockedSkills.length>0&&it.jsxs("div",{className:"bg-white/10 rounded-xl p-6 border border-white/20",children:[it.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center space-x-2",children:[it.jsx(X,{size:20,className:"text-purple-400"}),it.jsx("span",{children:"Unlocked Skills"})]}),it.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.unlockedSkills.map(e=>it.jsxs("div",{className:"bg-black/20 rounded-lg p-4 border border-white/10",children:[it.jsxs("div",{className:"text-sm text-purple-400 mb-1",children:["Level ",e," Skill"]}),it.jsx("div",{className:"text-lg font-semibold",children:"Skill Name"}),it.jsx("div",{className:"text-sm text-blue-200",children:"Skill description would go here"})]},e))})]}),p&&it.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",children:it.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 max-w-md w-full mx-4",children:[it.jsx("h3",{className:"text-xl font-bold mb-4",children:"Upload Character Portrait"}),it.jsx("p",{className:"text-blue-200 mb-4",children:"Choose an image to represent your character"}),it.jsx("input",{ref:g,type:"file",accept:"image/*",onChange:e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s&&a){const e=new FileReader;e.onload=e=>{var t;a({portrait:null==(t=e.target)?void 0:t.result})},e.readAsDataURL(s),x(!1)}},className:"hidden"}),it.jsxs("div",{className:"flex space-x-3",children:[it.jsxs("button",{onClick:()=>{var e;return null==(e=g.current)?void 0:e.click()},className:"flex-1 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg transition-colors flex items-center justify-center space-x-2",children:[it.jsx(Ge,{size:16}),it.jsx("span",{children:"Choose File"})]}),it.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors",children:"Cancel"})]})]})})]})},tl=({user:e,onClose:t,onCampaignCreated:a})=>{cs();const[n,r]=s.useState("simple"),[i,o]=s.useState(null),[l,c]=s.useState(""),[d,h]=s.useState(!0),[u,m]=s.useState(6),[p,x]=s.useState({dmStyle:"balanced",descriptionStyle:"immersive",difficulty:"medium",combatIntensity:"moderate",puzzleComplexity:"medium",roleplayDepth:"deep"}),[g,f]=s.useState({xpGain:"standard",lootRarity:"balanced",deathPenalty:"moderate",savePoints:"frequent",fastTravel:!0,crafting:!1}),[b,y]=s.useState({weatherSystem:!0,dayNightCycle:!0,npcSchedules:!0,dynamicEvents:!0,worldPersistence:!0}),v=()=>{o(null),c(""),h(!0),m(6),r("simple"),x({dmStyle:"balanced",descriptionStyle:"immersive",difficulty:"medium",combatIntensity:"moderate",puzzleComplexity:"medium",roleplayDepth:"deep"}),f({xpGain:"standard",lootRarity:"balanced",deathPenalty:"moderate",savePoints:"frequent",fastTravel:!0,crafting:!1}),y({weatherSystem:!0,dayNightCycle:!0,npcSchedules:!0,dynamicEvents:!0,worldPersistence:!0})};return it.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4",children:it.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[it.jsx("div",{className:"p-6 border-b border-slate-700/50",children:it.jsxs("div",{className:"flex justify-between items-center",children:[it.jsx("h2",{className:"text-2xl font-bold text-white",children:"Create New Campaign"}),it.jsx("button",{onClick:()=>{v(),t()},className:"text-slate-400 hover:text-white",children:"✕"})]})}),it.jsxs("div",{className:"p-6 space-y-6",children:[it.jsxs("div",{className:"flex space-x-4",children:[it.jsx("button",{onClick:()=>r("simple"),className:"px-4 py-2 rounded-lg font-medium transition-colors "+("simple"===n?"bg-green-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:"🚀 Quick Start"}),it.jsx("button",{onClick:()=>r("advanced"),className:"px-4 py-2 rounded-lg font-medium transition-colors "+("advanced"===n?"bg-purple-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:"⚙️ Advanced Setup"})]}),it.jsxs("div",{children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Choose Your Adventure"}),it.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{id:"fantasy-epic",name:"The Lost Crown of Eldoria",category:"Fantasy",icon:"👑",difficulty:"Medium",duration:"20-30 hours",description:"A classic fantasy epic where players must recover the stolen crown and restore peace to the kingdom.",setting:"Medieval fantasy kingdom with magic and dragons",themes:["Quest","Politics","Magic","Combat"],features:["Multiple endings","Faction system","Magic schools","Dragon encounters"],aiPrompt:"You are a wise and experienced Dungeon Master running a classic fantasy epic. The world is rich with magic, political intrigue, and ancient secrets. Focus on immersive storytelling, meaningful choices, and epic battles.",recommendedLevel:"1-10"},{id:"sci-fi-exploration",name:"Stellar Drift: The Void Between",category:"Sci-Fi",icon:"🚀",difficulty:"Hard",duration:"25-35 hours",description:"Explore the vast reaches of space, discover alien civilizations, and uncover the mystery of the cosmic void.",setting:"Far-future space exploration with advanced technology",themes:["Exploration","Diplomacy","Technology","Mystery"],features:["Space combat","Alien races","Tech upgrades","Multiple planets"],aiPrompt:"You are a master of science fiction storytelling, creating a vast universe filled with wonder and danger. Focus on exploration, technological advancement, and the unknown.",recommendedLevel:"1-15"},{id:"mystery-detective",name:"Shadows of the Old City",category:"Mystery",icon:"🔍",difficulty:"Medium",duration:"15-25 hours",description:"Solve a series of connected murders in a noir-style city filled with corruption and secrets.",setting:"Gritty urban environment with supernatural elements",themes:["Investigation","Corruption","Supernatural","Social"],features:["Clue system","Multiple suspects","Moral choices","Hidden areas"],aiPrompt:"You are a master of mystery and intrigue, creating complex plots with multiple layers. Focus on investigation, character development, and moral ambiguity.",recommendedLevel:"1-8"},{id:"horror-survival",name:"The Haunting of Blackwood Manor",category:"Horror",icon:"👻",difficulty:"Hard",duration:"10-20 hours",description:"Survive a night in a haunted mansion while uncovering the dark history of the Blackwood family.",setting:"Gothic mansion with supernatural horrors",themes:["Survival","Horror","Investigation","Psychological"],features:["Sanity system","Limited resources","Multiple endings","Hidden lore"],aiPrompt:"You are a master of horror and suspense, creating an atmosphere of dread and tension. Focus on psychological horror, resource management, and survival.",recommendedLevel:"1-6"},{id:"post-apocalyptic",name:"Wasteland Wanderers",category:"Post-Apocalyptic",icon:"🌆",difficulty:"Medium",duration:"20-30 hours",description:"Navigate a dangerous post-apocalyptic world, build settlements, and fight for survival.",setting:"Post-nuclear wasteland with scattered communities",themes:["Survival","Community","Exploration","Conflict"],features:["Base building","Faction wars","Scavenging","Radiation system"],aiPrompt:"You are a master of post-apocalyptic storytelling, creating a harsh but hopeful world. Focus on survival, community building, and moral choices.",recommendedLevel:"1-12"},{id:"steampunk-adventure",name:"Clockwork Revolution",category:"Steampunk",icon:"⚙️",difficulty:"Medium",duration:"18-28 hours",description:"Join a revolution against the oppressive clockwork empire in a world of steam and brass.",setting:"Victorian-era city with advanced steam technology",themes:["Revolution","Technology","Social","Adventure"],features:["Steam-powered gadgets","Underground resistance","Social classes","Political intrigue"],aiPrompt:"You are a master of steampunk aesthetics and revolutionary storytelling. Focus on social justice, technological wonder, and political intrigue.",recommendedLevel:"1-10"},{id:"western-frontier",name:"The Lawless Frontier",category:"Western",icon:"🤠",difficulty:"Easy",duration:"12-20 hours",description:"Become a legendary gunslinger in the untamed American frontier.",setting:"Wild West with supernatural elements",themes:["Justice","Freedom","Adventure","Supernatural"],features:["Gunfights","Horse riding","Ghost towns","Native spirits"],aiPrompt:"You are a master of Western storytelling, creating a world of freedom, danger, and adventure. Focus on justice, personal freedom, and the frontier spirit.",recommendedLevel:"1-8"},{id:"cyberpunk-heist",name:"Neon Dreams",category:"Cyberpunk",icon:"🌃",difficulty:"Hard",duration:"15-25 hours",description:"Pull off the ultimate heist in a neon-lit cyberpunk city controlled by megacorporations.",setting:"Futuristic city with cybernetic enhancements",themes:["Heist","Corruption","Technology","Identity"],features:["Cybernetics","Hacking","Corporate espionage","Multiple approaches"],aiPrompt:"You are a master of cyberpunk aesthetics and heist storytelling. Focus on corporate corruption, technological advancement, and high-stakes action.",recommendedLevel:"1-10"}].map(e=>it.jsxs("div",{onClick:()=>o(e),className:"p-4 rounded-lg border-2 cursor-pointer transition-all "+((null==i?void 0:i.id)===e.id?"border-blue-500 bg-blue-900/20":"border-slate-600 bg-slate-700/30 hover:border-slate-500 hover:bg-slate-700/50"),children:[it.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[it.jsx("span",{className:"text-2xl",children:e.icon}),it.jsxs("div",{children:[it.jsx("h4",{className:"text-white font-medium",children:e.name}),it.jsx("p",{className:"text-slate-400 text-sm",children:e.category})]})]}),it.jsx("p",{className:"text-slate-300 text-sm mb-3",children:e.description}),it.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[it.jsxs("span",{children:["Difficulty: ",e.difficulty]}),it.jsx("span",{children:e.duration})]})]},e.id))})]}),it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Campaign Type"}),it.jsxs("div",{className:"space-y-2",children:[it.jsxs("label",{className:"flex items-center space-x-2",children:[it.jsx("input",{type:"radio",checked:d,onChange:()=>h(!0),className:"text-blue-600"}),it.jsx("span",{className:"text-white",children:"Multiplayer Campaign"})]}),it.jsxs("label",{className:"flex items-center space-x-2",children:[it.jsx("input",{type:"radio",checked:!d,onChange:()=>h(!1),className:"text-blue-600"}),it.jsx("span",{className:"text-white",children:"Solo Adventure"})]})]})]}),d&&it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Max Players"}),it.jsxs("select",{value:u,onChange:e=>m(Number(e.target.value)),className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400",children:[it.jsx("option",{value:2,children:"2 Players"}),it.jsx("option",{value:3,children:"3 Players"}),it.jsx("option",{value:4,children:"4 Players"}),it.jsx("option",{value:5,children:"5 Players"}),it.jsx("option",{value:6,children:"6 Players"})]})]})]}),it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Custom Instructions (Optional)"}),it.jsx("textarea",{value:l,onChange:e=>c(e.target.value),placeholder:"Add any specific instructions or modifications to your adventure...",rows:3,className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400"})]}),"advanced"===n&&it.jsxs("div",{className:"space-y-6",children:[it.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[it.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"🤖 AI Dungeon Master Settings"}),it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"DM Style"}),it.jsxs("select",{value:p.dmStyle,onChange:e=>x(t=>({...t,dmStyle:e.target.value})),className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400",children:[it.jsx("option",{value:"balanced",children:"Balanced"}),it.jsx("option",{value:"narrative",children:"Narrative-Focused"}),it.jsx("option",{value:"combat",children:"Combat-Heavy"}),it.jsx("option",{value:"puzzle",children:"Puzzle-Master"}),it.jsx("option",{value:"roleplay",children:"Roleplay-Intensive"})]})]}),it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Description Style"}),it.jsxs("select",{value:p.descriptionStyle,onChange:e=>x(t=>({...t,descriptionStyle:e.target.value})),className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400",children:[it.jsx("option",{value:"immersive",children:"Immersive & Detailed"}),it.jsx("option",{value:"concise",children:"Concise & Fast"}),it.jsx("option",{value:"atmospheric",children:"Atmospheric & Moody"}),it.jsx("option",{value:"cinematic",children:"Cinematic & Dynamic"})]})]}),it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Difficulty"}),it.jsxs("select",{value:p.difficulty,onChange:e=>x(t=>({...t,difficulty:e.target.value})),className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400",children:[it.jsx("option",{value:"easy",children:"Easy"}),it.jsx("option",{value:"medium",children:"Medium"}),it.jsx("option",{value:"hard",children:"Hard"}),it.jsx("option",{value:"brutal",children:"Brutal"})]})]}),it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Combat Intensity"}),it.jsxs("select",{value:p.combatIntensity,onChange:e=>x(t=>({...t,combatIntensity:e.target.value})),className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400",children:[it.jsx("option",{value:"light",children:"Light"}),it.jsx("option",{value:"moderate",children:"Moderate"}),it.jsx("option",{value:"intense",children:"Intense"}),it.jsx("option",{value:"deadly",children:"Deadly"})]})]})]})]}),it.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[it.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"🎮 Gameplay Rules"}),it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"XP Gain"}),it.jsxs("select",{value:g.xpGain,onChange:e=>f(t=>({...t,xpGain:e.target.value})),className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400",children:[it.jsx("option",{value:"slow",children:"Slow & Steady"}),it.jsx("option",{value:"standard",children:"Standard"}),it.jsx("option",{value:"fast",children:"Fast Progression"}),it.jsx("option",{value:"epic",children:"Epic Advancement"})]})]}),it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Loot Rarity"}),it.jsxs("select",{value:g.lootRarity,onChange:e=>f(t=>({...t,lootRarity:e.target.value})),className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400",children:[it.jsx("option",{value:"scarce",children:"Scarce"}),it.jsx("option",{value:"balanced",children:"Balanced"}),it.jsx("option",{value:"generous",children:"Generous"}),it.jsx("option",{value:"legendary",children:"Legendary"})]})]}),it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Death Penalty"}),it.jsxs("select",{value:g.deathPenalty,onChange:e=>f(t=>({...t,deathPenalty:e.target.value})),className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400",children:[it.jsx("option",{value:"none",children:"No Penalty"}),it.jsx("option",{value:"light",children:"Light"}),it.jsx("option",{value:"moderate",children:"Moderate"}),it.jsx("option",{value:"severe",children:"Severe"})]})]}),it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Save Points"}),it.jsxs("select",{value:g.savePoints,onChange:e=>f(t=>({...t,savePoints:e.target.value})),className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400",children:[it.jsx("option",{value:"frequent",children:"Frequent"}),it.jsx("option",{value:"moderate",children:"Moderate"}),it.jsx("option",{value:"rare",children:"Rare"}),it.jsx("option",{value:"checkpoint",children:"Checkpoint Only"})]})]})]})]}),it.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[it.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"🌍 World Environment"}),it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[it.jsxs("label",{className:"flex items-center space-x-2",children:[it.jsx("input",{type:"checkbox",checked:b.weatherSystem,onChange:e=>y(t=>({...t,weatherSystem:e.target.checked})),className:"text-blue-600"}),it.jsx("span",{className:"text-white",children:"Dynamic Weather System"})]}),it.jsxs("label",{className:"flex items-center space-x-2",children:[it.jsx("input",{type:"checkbox",checked:b.dayNightCycle,onChange:e=>y(t=>({...t,dayNightCycle:e.target.checked})),className:"text-blue-600"}),it.jsx("span",{className:"text-white",children:"Day/Night Cycle"})]}),it.jsxs("label",{className:"flex items-center space-x-2",children:[it.jsx("input",{type:"checkbox",checked:b.npcSchedules,onChange:e=>y(t=>({...t,npcSchedules:e.target.checked})),className:"text-blue-600"}),it.jsx("span",{className:"text-white",children:"NPC Schedules"})]}),it.jsxs("label",{className:"flex items-center space-x-2",children:[it.jsx("input",{type:"checkbox",checked:b.dynamicEvents,onChange:e=>y(t=>({...t,dynamicEvents:e.target.checked})),className:"text-blue-600"}),it.jsx("span",{className:"text-white",children:"Dynamic Events"})]}),it.jsxs("label",{className:"flex items-center space-x-2",children:[it.jsx("input",{type:"checkbox",checked:b.worldPersistence,onChange:e=>y(t=>({...t,worldPersistence:e.target.checked})),className:"text-blue-600"}),it.jsx("span",{className:"text-white",children:"World Persistence"})]})]})]})]}),it.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-slate-700/50",children:[it.jsx("button",{onClick:()=>{v(),t()},className:"px-6 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:"Cancel"}),it.jsx("button",{onClick:async()=>{try{const e={theme:(null==i?void 0:i.name)||"Custom Adventure",background:(null==i?void 0:i.id)||"custom",customPrompt:l||(null==i?void 0:i.aiPrompt)||"",maxPlayers:d?u:1,players:[],aiSettings:p,gameplaySettings:g,environmentSettings:b,adventureType:(null==i?void 0:i.id)||"custom"},{gameId:s,code:n}=await Qs.createGameSession(e);a(s,n),t()}catch(e){alert("Failed to create campaign. Please try again.")}},disabled:!i,className:"px-6 py-2 bg-green-600 hover:bg-green-700 disabled:bg-slate-600 text-white rounded-lg transition-colors",children:"Create Campaign"})]})]})]})})};s.lazy(()=>dt(()=>Promise.resolve().then(()=>Ri),void 0)),s.lazy(()=>dt(()=>import("./TopBar-1b72c02b.js"),["assets/TopBar-1b72c02b.js","assets/ui-vendor-c80f9872.js","assets/react-vendor-132e4a4f.js","assets/firebase-auth-7a9d2df2.js","assets/firebase-core-a7cb50f5.js","assets/firebase-firestore-e3da4556.js","assets/firebase-database-b022e4c6.js","assets/firebase-functions-7c25f05b.js"]));const sl=s.lazy(()=>dt(()=>import("./WelcomeOverlay-37e27f3f.js"),["assets/WelcomeOverlay-37e27f3f.js","assets/react-vendor-132e4a4f.js","assets/ui-vendor-c80f9872.js","assets/firebase-auth-7a9d2df2.js","assets/firebase-core-a7cb50f5.js","assets/firebase-firestore-e3da4556.js","assets/firebase-database-b022e4c6.js","assets/firebase-functions-7c25f05b.js"])),al=s.lazy(()=>dt(()=>import("./CombatSystem-b07a6d3c.js"),["assets/CombatSystem-b07a6d3c.js","assets/react-vendor-132e4a4f.js","assets/ui-vendor-c80f9872.js","assets/firebase-auth-7a9d2df2.js","assets/firebase-core-a7cb50f5.js","assets/firebase-firestore-e3da4556.js","assets/firebase-database-b022e4c6.js","assets/firebase-functions-7c25f05b.js"])),nl=s.lazy(()=>dt(()=>import("./RightDrawer-79b9b070.js"),["assets/RightDrawer-79b9b070.js","assets/react-vendor-132e4a4f.js","assets/ui-vendor-c80f9872.js","assets/firebase-auth-7a9d2df2.js","assets/firebase-core-a7cb50f5.js","assets/firebase-firestore-e3da4556.js","assets/firebase-database-b022e4c6.js","assets/firebase-functions-7c25f05b.js"])),rl=s.lazy(()=>dt(()=>import("./FloatingActionButton-2e0a0b20.js"),["assets/FloatingActionButton-2e0a0b20.js","assets/react-vendor-132e4a4f.js","assets/ui-vendor-c80f9872.js","assets/firebase-auth-7a9d2df2.js","assets/firebase-core-a7cb50f5.js","assets/firebase-firestore-e3da4556.js","assets/firebase-database-b022e4c6.js","assets/firebase-functions-7c25f05b.js"])),il=s.lazy(()=>dt(()=>import("./SimpleHelp-1d9b1009.js"),["assets/SimpleHelp-1d9b1009.js","assets/react-vendor-132e4a4f.js","assets/ui-vendor-c80f9872.js","assets/firebase-auth-7a9d2df2.js","assets/firebase-core-a7cb50f5.js","assets/firebase-firestore-e3da4556.js","assets/firebase-database-b022e4c6.js","assets/firebase-functions-7c25f05b.js"])),ol=s.lazy(()=>dt(()=>import("./HelpSystem-92f93ce6.js"),["assets/HelpSystem-92f93ce6.js","assets/react-vendor-132e4a4f.js","assets/ui-vendor-c80f9872.js","assets/firebase-auth-7a9d2df2.js","assets/firebase-core-a7cb50f5.js","assets/firebase-firestore-e3da4556.js","assets/firebase-database-b022e4c6.js","assets/firebase-functions-7c25f05b.js"])),ll=s.lazy(()=>dt(()=>import("./DMCenter-0befd5af.js"),["assets/DMCenter-0befd5af.js","assets/react-vendor-132e4a4f.js","assets/ui-vendor-c80f9872.js","assets/firebase-auth-7a9d2df2.js","assets/firebase-core-a7cb50f5.js","assets/firebase-firestore-e3da4556.js","assets/firebase-database-b022e4c6.js","assets/firebase-functions-7c25f05b.js"])),cl=()=>it.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-950 via-indigo-950 to-purple-950 flex items-center justify-center",children:it.jsxs("div",{className:"text-center space-y-4",children:[it.jsxs("div",{className:"relative",children:[it.jsx("div",{className:"w-16 h-16 border-4 border-blue-300/30 border-t-blue-400 rounded-full animate-spin mx-auto"}),it.jsx("div",{className:"w-12 h-12 border-4 border-purple-300/30 border-t-purple-400 rounded-full animate-spin absolute top-2 left-1/2 transform -translate-x-1/2 -rotate-45",style:{animationDuration:"1.5s"}})]}),it.jsxs("div",{className:"space-y-2",children:[it.jsx("h3",{className:"text-white font-semibold text-lg",children:"Loading MythSeeker"}),it.jsx("p",{className:"text-blue-200 text-sm",children:"Preparing your adventure..."})]}),it.jsxs("div",{className:"flex justify-center space-x-1",children:[it.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce"}),it.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),it.jsx("div",{className:"w-2 h-2 bg-indigo-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})}),dl=({initialScreen:e="welcome"})=>{const t=i.useMemo(()=>new Jo,[]);s.useState(null);const[a,n]=s.useState([]),[r,o]=s.useState(!1),[l,c]=s.useState(!1),[d,h]=s.useState("welcome"),[u,m]=s.useState(null),[p,x]=s.useState([]),[g,f]=s.useState(!0),[b,y]=s.useState(!1);s.useState(!1),s.useState("dashboard"),s.useState("gameplay");const[v,w]=s.useState(!1);s.useState(!1);const[j,N]=s.useState(!1),[S,k]=s.useState(e),[C,E]=s.useState(""),[P,I]=s.useState(null),[T,A]=s.useState(null),[M,D]=s.useState([]),[R,_]=s.useState([]),[L,O]=s.useState(""),[$,U]=s.useState(!1),[z,F]=s.useState("default");s.useState({});const[W,H]=s.useState(null),[Y,G]=s.useState("");s.useState(null),s.useState(null);const[B,q]=s.useState(null);s.useState([]),s.useState(null),s.useState(null),s.useState(null),s.useState(null),s.useState({});const[J,V]=s.useState({locations:{},npcs:{},factions:{},events:[],weather:"clear",timeOfDay:"day",currentLocation:null,playerReputation:{},discoveredSecrets:[],activeQuests:[],completedQuests:[],worldEvents:[]});s.useState({ruleSystem:"dnd5e",contentLibrary:{encounters:[],npcs:[],locations:[],plotHooks:[],customRules:[]},campaignTemplates:[],dmTools:{initiativeTracker:[],sessionNotes:"",playerAnalytics:{}}}),s.useState(!1),s.useState([]);const[K,Q]=s.useState([]);s.useState(!1);const X=s.useRef(null),Z=s.useRef(null),[te,se]=s.useState(!1),[ae,ne]=s.useState({players:[],isHost:!1,lastSync:null}),[re,ie]=s.useState("chat");s.useState(0);const[oe,le]=s.useState({playerActions:[],npcInteractions:{},combatHistory:[],explorationHistory:[],playerPreferences:{},storyThreads:[],consequences:[]}),[ce,de]=s.useState(400),he=()=>!JSON.parse(localStorage.getItem("mythseeker_skipped_intros")||"[]").includes("welcomeOverlay"),ue=(e,t)=>{if(["characterCreated","campaignCreated","campaignJoined","levelUp","achievementUnlocked","firstMessage","combatStarted","questCompleted","itemFound","npcInteraction","explorationMilestone"].includes(e)&&!["error","info","warning","success","goodbye","characterLoaded","campaignDeleted","ftueSkipped"].includes(e)){if(JSON.parse(localStorage.getItem("mythseeker_skipped_intros")||"[]").includes(e))return;const s=((e,t)=>{const s=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,a={characterCreated:{message:"Character created successfully!",type:"success"},campaignCreated:{message:"Campaign created successfully!",type:"success"},campaignPaused:{message:"Campaign paused",type:"info"},campaignResumed:{message:"Campaign resumed",type:"success"},welcomeBack:{message:"Welcome back to your adventure!",type:"success"},ftueSkipped:{message:"Tutorial skipped",type:"info"},npcInteraction:{message:(null==t?void 0:t.npcName)?`${t.npcName} is ${t.disposition} (${t.emotionalSummary})`:"NPC interaction recorded",type:"info"}}[e]||{message:"Action completed",type:"success"};return{id:s,message:a.message,type:a.type}})(e,t);["characterCreated","campaignCreated","firstMessage","combatStarted"].includes(e)&&(s.showIntroControls=!0,s.onSkipIntro=()=>{},s.onDontShowAgain=()=>{const t=JSON.parse(localStorage.getItem("mythseeker_skipped_intros")||"[]");t.includes(e)||(t.push(e),localStorage.setItem("mythseeker_skipped_intros",JSON.stringify(t)))}),n(e=>[...e,s]),setTimeout(()=>me(s.id),5e3)}},me=e=>{n(t=>t.filter(t=>t.id!==e))};s.useEffect(()=>{W||H(Date.now().toString(36)+Math.random().toString(36).substr(2))},[W]),s.useEffect(()=>{qo.trackSessionStart(),qo.trackDeviceInfo(),qo.trackPageView("welcome","MythSeeker - Welcome");const e=performance.now(),t=()=>{const t=performance.now()-e;qo.trackPerformance("app_load_time",t)};"complete"===document.readyState?t():window.addEventListener("load",t);const s=()=>{const t=Date.now()-e;qo.trackSessionEnd(t)};window.addEventListener("beforeunload",s);const a=Qs.onAuthStateChange(async e=>{var t;if(e)try{await new Promise(e=>setTimeout(e,500)),qo.trackUserAction("user_authenticated",{user_id:e.uid,display_name:e.displayName}),qo.setUserId(e.uid),qo.setUserProperties({user_type:e.displayName?"authenticated":"anonymous",account_created:(null==(t=e.metadata)?void 0:t.creationTime)||"unknown"});let a=0,n=null;for(;a<3&&!n;)try{n=await Qs.getUserProfile(e.uid);break}catch(s){a++,a<3&&await new Promise(e=>setTimeout(e,1e3*a))}if(n){m(n),E(n.displayName),y(!0);let t=[];for(a=0;a<3;)try{t=await Qs.getUserCharacters(e.uid);break}catch(s){a++,a<3&&await new Promise(e=>setTimeout(e,1e3*a))}x(t),qo.trackUserAction("profile_loaded",{characters_count:t.length,has_characters:t.length>0}),"/"===location.pathname&&(t.length>0?(k("dashboard"),xe("/dashboard"),qo.trackPageView("dashboard","MythSeeker - Dashboard"),he()&&o(!0)):(k("welcome"),xe("/"),qo.trackPageView("welcome","MythSeeker - Welcome")))}else k("welcome"),qo.trackPageView("welcome","MythSeeker - Welcome")}catch(a){const e=JSON.parse(localStorage.getItem("mythseeker_characters")||"[]");e.length>0?(x(e),k("character-select"),qo.trackPageView("character-select","MythSeeker - Character Selection")):(k("welcome"),qo.trackPageView("welcome","MythSeeker - Welcome")),m(null),y(!1)}else{qo.trackUserAction("user_signed_out");const e=JSON.parse(localStorage.getItem("mythseeker_characters")||"[]");e.length>0?(x(e),k("character-select"),qo.trackPageView("character-select","MythSeeker - Character Selection")):(k("welcome"),qo.trackPageView("welcome","MythSeeker - Welcome")),m(null),y(!1)}f(!1)});return()=>{window.removeEventListener("load",t),window.removeEventListener("beforeunload",s),a()}},[]),s.useEffect(()=>{(async()=>{try{await Qs.handleRedirectSignIn()}catch(e){ue("error",{message:"Failed to sign in. Please try again."})}})()},[]),s.useEffect(()=>{"undefined"==typeof window||window.claude||(window.claude={complete:e=>sa.complete(e)})},[]);const pe=async()=>{try{f(!0),await Qs.signInWithGoogle()}catch(e){const t=e;"auth/popup-blocked"===t.code?ue("error",{message:"Popup was blocked. Trying alternative sign-in method..."}):"auth/popup-closed-by-user"===t.code?(ue("info",{message:"Sign-in was cancelled."}),f(!1)):("auth/cancelled-popup-request"===t.code||ue("error",{message:"Failed to sign in. Please try again."}),f(!1))}};s.useEffect(()=>{const e=()=>{N(window.innerWidth<1024)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),s.useEffect(()=>{if(null==T?void 0:T.id){const e=Li.subscribeToCampaign(T.id,e=>{A(e),_(e.messages||[]),ne({players:e.players||[],isHost:Li.isHost(e),lastSync:new Date}),se(!0)}),t=Li.startHeartbeat(T.id);return()=>{e(),t()}}},[null==T?void 0:T.id]),s.useEffect(()=>{var e;null==(e=X.current)||e.scrollIntoView({behavior:"smooth"})},[R]),s.useEffect(()=>{!$&&Z.current&&Z.current.focus()},[$]);const xe=cs(),ge=async e=>{if(null==e?void 0:e.id)try{const s=JSON.parse(localStorage.getItem("mythseeker_campaigns")||"[]"),a=s.findIndex(t=>t.id===e.id);if(a>=0?s[a]=e:s.push(e),localStorage.setItem("mythseeker_campaigns",JSON.stringify(s)),D(t=>t.map(t=>t.id===e.id?e:t)),e.isMultiplayer&&b&&u)try{await Li.updateCampaignState(e.id,{messages:e.messages||[],systemMessages:e.systemMessages||[],started:e.started,worldState:e.worldState,currentEnvironment:e.currentEnvironment,combatState:e.combatState,lastActivity:new Date})}catch(t){}}catch(s){try{const t=JSON.parse(localStorage.getItem("mythseeker_campaigns")||"[]"),s=t.findIndex(t=>t.id===e.id);s>=0?t[s]=e:t.push(e),localStorage.setItem("mythseeker_campaigns",JSON.stringify(t))}catch(a){}}},fe=async()=>{try{const t=JSON.parse(localStorage.getItem("mythseeker_campaigns")||"[]"),s=t.map(e=>({...e,status:e.status||(e.started?"active":void 0)}));if(D(s),b&&u)try{const e=await Qs.getUserCampaigns(u.uid),s=t.map(t=>e.find(e=>e.id===t.id)||t);e.forEach(e=>{s.find(t=>t.id===e.id)||s.push(e)}),D(s),localStorage.setItem("mythseeker_campaigns",JSON.stringify(s))}catch(e){}}catch(t){D([])}};s.useEffect(()=>{if(T&&T.started){const e=setTimeout(()=>{ge(T)},3e4);return()=>clearTimeout(e)}},[T]),s.useEffect(()=>{fe()},[P,b]),s.useEffect(()=>{const e=JSON.parse(localStorage.getItem("mythseeker_campaigns")||"[]");e.length>0&&D(e)},[]),s.useEffect(()=>{if(T&&R.length>0){const e={...T,messages:R};ge(e)}},[R]);const be=[{name:"Warrior",icon:"⚔️",stats:{strength:16,dexterity:12,intelligence:10,charisma:8},actionPoints:{move:6,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Power Strike",description:"Deal +50% damage on next attack",cost:"Action",type:"attack",range:1},3:{name:"Shield Wall",description:"Reduce all damage by 3 for 3 turns",cost:"Action",type:"defense",range:0},5:{name:"Berserker Rage",description:"Double damage but take +50% damage for 3 turns",cost:"Bonus Action",type:"buff",range:0},7:{name:"Intimidating Shout",description:"Fear nearby enemies for 2 turns",cost:"Action",type:"control",range:3,aoe:!0},10:{name:"Legendary Strike",description:"Guaranteed critical hit",cost:"Action",type:"attack",range:1}}},{name:"Rogue",icon:"🗡️",stats:{strength:10,dexterity:16,intelligence:12,charisma:8},actionPoints:{move:8,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Sneak Attack",description:"Deal double damage if target is unaware",cost:"Free",type:"attack",range:1},3:{name:"Shadow Step",description:"Teleport behind enemy and gain advantage",cost:"Movement",type:"movement",range:6},5:{name:"Poison Blade",description:"Next 3 attacks apply poison (3 damage/turn)",cost:"Bonus Action",type:"buff",range:0},7:{name:"Smoke Bomb",description:"Become invisible for 2 turns",cost:"Action",type:"stealth",range:0,aoe:!0,radius:2},10:{name:"Assassinate",description:"Instant kill if target below 25% health",cost:"Action",type:"attack",range:1}}},{name:"Mage",icon:"🔮",stats:{strength:8,dexterity:10,intelligence:16,charisma:12},actionPoints:{move:5,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Magic Missile",description:"Deal 1d4+1 force damage, never misses",cost:"1 Spell Slot",type:"attack",range:8},3:{name:"Shield Spell",description:"Gain +5 AC until start of next turn",cost:"Reaction",type:"defense",range:0},5:{name:"Fireball",description:"Deal 3d6 fire damage in large area",cost:"1 Spell Slot",type:"aoe",range:10,radius:3},7:{name:"Counterspell",description:"Cancel enemy spell or ability",cost:"Reaction",type:"control",range:8},10:{name:"Meteor Storm",description:"Devastate entire battlefield",cost:"2 Spell Slots",type:"aoe",range:15,radius:5}}},{name:"Cleric",icon:"⚡",stats:{strength:12,dexterity:8,intelligence:12,charisma:16},actionPoints:{move:5,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Healing Word",description:"Restore 1d4+CHA mod HP to ally",cost:"1 Spell Slot",type:"heal",range:8},3:{name:"Turn Undead",description:"Force undead creatures to flee",cost:"Action",type:"control",range:6,aoe:!0},5:{name:"Sacred Flame",description:"Divine damage that ignores armor",cost:"1 Spell Slot",type:"attack",range:8},7:{name:"Mass Healing",description:"Heal all allies for 2d4+CHA",cost:"2 Spell Slots",type:"heal",range:6,aoe:!0},10:{name:"Divine Intervention",description:"Call upon divine aid in dire situations",cost:"3 Spell Slots",type:"special",range:0}}},{name:"Ranger",icon:"🏹",stats:{strength:14,dexterity:14,intelligence:10,charisma:8},actionPoints:{move:7,action:1,bonus:1,reaction:1},reach:10,skills:{1:{name:"Hunter's Mark",description:"Mark target for +1d6 damage on attacks",cost:"Bonus Action",type:"buff",range:10},3:{name:"Multi-Shot",description:"Attack up to 3 enemies with ranged weapon",cost:"Action",type:"attack",range:10},5:{name:"Animal Companion",description:"Summon beast ally for entire combat",cost:"Action",type:"summon",range:3},7:{name:"Explosive Shot",description:"Ranged attack that damages nearby enemies",cost:"Action",type:"aoe",range:10,radius:2},10:{name:"Rain of Arrows",description:"Attack all enemies in large area",cost:"Action",type:"aoe",range:12,radius:4}}},{name:"Bard",icon:"🎵",stats:{strength:8,dexterity:12,intelligence:10,charisma:16},actionPoints:{move:6,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Inspiration",description:"Give ally advantage on next roll",cost:"Bonus Action",type:"support",range:6},3:{name:"Cutting Words",description:"Reduce enemy attack/damage by 1d6",cost:"Reaction",type:"debuff",range:6},5:{name:"Song of Rest",description:"Party heals +1d6 HP during short rest",cost:"Short Rest",type:"heal",range:0},7:{name:"Mass Suggestion",description:"Control multiple enemies for 1 turn",cost:"Action",type:"control",range:8,aoe:!0},10:{name:"Power Word Kill",description:"Instantly kill enemy below 100 HP",cost:"Action",type:"attack",range:8}}},{name:"Druid",icon:"🌿",stats:{strength:10,dexterity:12,intelligence:14,charisma:10},actionPoints:{move:6,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Wild Shape",description:"Transform into a beast for 1 hour",cost:"Action",type:"transform",range:0},3:{name:"Entangle",description:"Restrain enemies with magical vines",cost:"1 Spell Slot",type:"control",range:8,aoe:!0},5:{name:"Call Lightning",description:"Summon lightning storm for area damage",cost:"1 Spell Slot",type:"aoe",range:10,radius:3},7:{name:"Conjure Animals",description:"Summon 4 beasts to fight for you",cost:"2 Spell Slots",type:"summon",range:8},10:{name:"Storm of Vengeance",description:"Create devastating storm over large area",cost:"3 Spell Slots",type:"aoe",range:15,radius:6}}},{name:"Monk",icon:"🥋",stats:{strength:12,dexterity:16,intelligence:10,charisma:8},actionPoints:{move:8,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Flurry of Blows",description:"Make 2 unarmed strikes as bonus action",cost:"Bonus Action",type:"attack",range:1},3:{name:"Patient Defense",description:"Take dodge action as bonus action",cost:"Bonus Action",type:"defense",range:0},5:{name:"Step of the Wind",description:"Dash and disengage as bonus action",cost:"Bonus Action",type:"movement",range:0},7:{name:"Stunning Strike",description:"Stun enemy on successful hit",cost:"1 Ki Point",type:"control",range:1},10:{name:"Quivering Palm",description:"Set up instant death strike",cost:"Action",type:"attack",range:1}}},{name:"Barbarian",icon:"🪓",stats:{strength:16,dexterity:14,intelligence:8,charisma:10},actionPoints:{move:7,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Rage",description:"Gain resistance to damage and +2 to attacks",cost:"Bonus Action",type:"buff",range:0},3:{name:"Reckless Attack",description:"Gain advantage but enemies get advantage on you",cost:"Free",type:"attack",range:1},5:{name:"Danger Sense",description:"Advantage on Dexterity saves vs visible effects",cost:"Passive",type:"defense",range:0},7:{name:"Brutal Critical",description:"Add extra damage die on critical hits",cost:"Passive",type:"attack",range:1},10:{name:"Relentless Rage",description:"Stay conscious when reduced to 0 HP",cost:"Passive",type:"defense",range:0}}},{name:"Sorcerer",icon:"✨",stats:{strength:8,dexterity:10,intelligence:12,charisma:16},actionPoints:{move:5,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Metamagic",description:"Modify spells with sorcery points",cost:"Sorcery Points",type:"enhance",range:0},3:{name:"Twin Spell",description:"Cast single-target spell on two targets",cost:"1 Sorcery Point",type:"enhance",range:0},5:{name:"Quickened Spell",description:"Cast spell as bonus action",cost:"2 Sorcery Points",type:"enhance",range:0},7:{name:"Heightened Spell",description:"Enemy has disadvantage on spell save",cost:"3 Sorcery Points",type:"enhance",range:0},10:{name:"Wish",description:"Cast any spell of 8th level or lower",cost:"9th Level Spell Slot",type:"special",range:0}}},{name:"Warlock",icon:"👹",stats:{strength:10,dexterity:12,intelligence:10,charisma:16},actionPoints:{move:6,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Eldritch Blast",description:"Ranged spell attack with multiple beams",cost:"Action",type:"attack",range:8},3:{name:"Hex",description:"Curse target for extra damage and disadvantage",cost:"1 Spell Slot",type:"debuff",range:8},5:{name:"Misty Step",description:"Teleport up to 30 feet as bonus action",cost:"1 Spell Slot",type:"movement",range:0},7:{name:"Hunger of Hadar",description:"Create area of darkness and damage",cost:"1 Spell Slot",type:"aoe",range:10,radius:3},10:{name:"Finger of Death",description:"Deal massive damage and potentially kill",cost:"1 Spell Slot",type:"attack",range:8}}},{name:"Artificer",icon:"⚙️",stats:{strength:10,dexterity:12,intelligence:16,charisma:8},actionPoints:{move:6,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Infuse Item",description:"Create magical items and enhancements",cost:"Long Rest",type:"craft",range:0},3:{name:"Arcane Armament",description:"Use Intelligence for weapon attacks",cost:"Passive",type:"enhance",range:0},5:{name:"Flash of Genius",description:"Add Intelligence modifier to ally's roll",cost:"Reaction",type:"support",range:6},7:{name:"Spell-Storing Item",description:"Store spell in item for later use",cost:"Long Rest",type:"craft",range:0},10:{name:"Soul of Artifice",description:"Gain resistance to all damage",cost:"Passive",type:"defense",range:0}}},{name:"Necromancer",icon:"💀",stats:{strength:8,dexterity:10,intelligence:16,charisma:12},actionPoints:{move:5,action:1,bonus:1,reaction:1},reach:1,skills:{1:{name:"Animate Dead",description:"Raise skeleton or zombie under your control",cost:"1 Spell Slot",type:"summon",range:8},3:{name:"Vampiric Touch",description:"Drain life from target to heal yourself",cost:"1 Spell Slot",type:"attack",range:1},5:{name:"Create Undead",description:"Create more powerful undead servants",cost:"2 Spell Slots",type:"summon",range:8},7:{name:"Finger of Death",description:"Kill target and raise as zombie",cost:"1 Spell Slot",type:"attack",range:8},10:{name:"Power Word Kill",description:"Instantly kill creature with 100 HP or less",cost:"1 Spell Slot",type:"attack",range:8}}}],ye=[{name:"Classic Fantasy",description:"Dragons, magic, and heroic quests in a medieval world",icon:"🏰",bg:"fantasy"},{name:"Sci-Fi Adventure",description:"Space exploration, alien encounters, and futuristic technology",icon:"🚀",bg:"scifi"},{name:"Horror Mystery",description:"Dark secrets, supernatural threats, and psychological tension",icon:"👻",bg:"horror"},{name:"Urban Fantasy",description:"Magic hidden in the modern world, supernatural creatures in cities",icon:"🌃",bg:"urban"},{name:"Post-Apocalyptic",description:"Surviving in a world after civilization has collapsed",icon:"☢️",bg:"apocalypse"},{name:"Pirate Adventure",description:"High seas, treasure hunting, and swashbuckling action",icon:"🏴‍☠️",bg:"pirate"}],we=e=>{const t=be.find(t=>t.name===e.class);t?((async e=>{if(!u){const t={id:Date.now().toString(),userId:"local",name:e.name,class:e.class,level:1,experience:0,health:100,maxHealth:100,mana:50,maxMana:50,gold:100,inventory:{"Healing Potion":3,"Iron Ore":2,Herb:5},equipment:{weapon:{name:"Iron Sword",type:"weapon"},armor:{name:"Leather Armor",type:"armor"}},stats:e.baseStats,skills:e.skills||{},achievements:[],createdAt:Date.now(),lastPlayed:Date.now(),totalPlayTime:0},s=JSON.parse(localStorage.getItem("mythseeker_characters")||"[]");return s.push(t),localStorage.setItem("mythseeker_characters",JSON.stringify(s)),ue("characterCreated",{character:e}),x(e=>[t,...e]),I(t),void k("lobby")}const t={userId:u.uid,name:e.name,class:e.class,level:1,experience:0,health:100,maxHealth:100,mana:50,maxMana:50,gold:100,inventory:{"Healing Potion":3,"Iron Ore":2,Herb:5},equipment:{weapon:{name:"Iron Sword",type:"weapon"},armor:{name:"Leather Armor",type:"armor"}},stats:e.baseStats,skills:e.skills||{},achievements:[],createdAt:Date.now(),lastPlayed:Date.now(),totalPlayTime:0};try{const s=await Qs.saveCharacter(t),a={...t,id:s};x(e=>[a,...e]),I(a),ue("characterCreated",{character:e}),k("lobby")}catch(s){const a={...t,id:Date.now().toString(),userId:u.uid},n=JSON.parse(localStorage.getItem("mythseeker_characters")||"[]");n.push(a),localStorage.setItem("mythseeker_characters",JSON.stringify(n)),x(e=>[a,...e]),I(a),ue("characterCreated",{character:e}),ue("warning",{message:"Character saved locally. Will sync when connection is restored."}),k("lobby")}})({...e,baseStats:t.stats,skills:t.skills,health:100,maxHealth:100,mana:50,maxMana:50,level:1,experience:0,gold:100,inventory:{"Healing Potion":3,"Iron Ore":2,Herb:5},equipment:{weapon:{name:"Iron Sword",type:"weapon"},armor:{name:"Leather Armor",type:"armor"}},unlockedSkills:[1],id:W,playerId:W}),he()&&o(!0)):ue("error",{message:"Invalid character class"})},je=async e=>{var t;if(e&&e.id){U(!0);try{const s=ye.find(t=>t.name===e.theme)||ye[0],a=`Begin the adventure. The party consists of: ${(null==(t=e.players)?void 0:t.map(e=>{var t,s;return`${(null==(t=e.character)?void 0:t.name)||"Unknown"} the ${(null==(s=e.character)?void 0:s.class)||"Adventurer"}`}).join(", "))||"the party"}. Setting: ${s.description}. Present an immersive opening scene with 3 action choices.`,n=await ia.processPlayerInput({message:a,playerId:W,campaignId:e.id,character:P,timestamp:new Date}),r={id:Date.now(),type:"dm",content:n.narrative_text+(n.npc_dialogue?`\n\n${n.npc_dialogue}`:""),choices:n.choices||["Explore","Investigate","Ask questions"],timestamp:new Date,atmosphere:n.mood_adjustment||{mood:"dynamic",tension:"medium"}};n.game_state_updates&&De(n.game_state_updates),_([r]);const i={...e,started:!0,status:"active"};A(i),D(t=>t.map(t=>t.id===e.id?i:t)),k("game"),xe(`/campaigns/${e.id}`)}catch(s){ue("error",{message:"Failed to start campaign. Please try again."})}U(!1)}else ue("error",{message:"Campaign data is invalid"})},[ke,Ce]=s.useState(null),Ee=i.useMemo(()=>new Ui(10,6e4),[]),Pe=async()=>{const e=(e=>{if(!e||0===e.trim().length)return{isValid:!1,error:"Message cannot be empty"};const t=Oi(e.trim());return t.length>500?{isValid:!1,error:"Message must be 500 characters or less"}:(e=>{const t=e.toLowerCase();return $i.some(e=>t.includes(e))})(t)?{isValid:!1,error:"Message contains inappropriate content"}:{isValid:!0}})(L);if(!e.isValid)return void Ce(e.error||"Invalid message");const t=W||"anonymous";if(!Ee.isAllowed(t)){const e=Ee.getTimeUntilReset(t);return void Ce(`Please wait ${Math.ceil(e/1e3)} seconds before sending another message`)}if(Ce(null),$)return;let s=P;s||(s={id:"default-character",name:C||"Adventurer",health:20,maxHealth:20,mana:10,maxMana:10,experience:0,level:1,baseStats:{strength:10,dexterity:10,intelligence:10,charisma:10},skills:{},inventory:{}},I(s));const a=Oi(L),n={id:Date.now(),type:"player",content:a,character:s.name,playerId:W,playerName:C,timestamp:new Date},r=[...R,n];_(r),O(""),U(!0);try{const e=await ia.processPlayerInput({message:a,playerId:W,campaignId:(null==T?void 0:T.id)||"single-player",character:s,timestamp:new Date}),t={narrative:e.narrative_text,choices:e.follow_up_prompts||["Explore","Investigate","Ask questions"],atmosphere:{mood:"dynamic",tension:"medium",environmentalDetails:"The world responds to your actions"}};e.npc_dialogue&&(t.narrative+=`\n\n${e.npc_dialogue}`),e.system_actions&&e.system_actions.length>0&&e.system_actions.forEach(e=>{if("dice_roll"===e.type){const e=((e=20)=>Math.floor(Math.random()*e)+1)(20);t.narrative+=`\n\n[Roll: ${e}]`}}),t.worldStateUpdates&&De(t.worldStateUpdates),t.environment&&F(t.environment),t.characterUpdates&&t.characterUpdates.forEach(e=>{e.playerId===W&&(I(t=>{var s,a;return t?{...t,experience:t.experience+(e.xpGain||0),health:Math.max(1,Math.min(t.maxHealth,t.health+((null==(s=e.statChanges)?void 0:s.health)||0))),mana:Math.max(0,Math.min(t.maxMana,t.mana+((null==(a=e.statChanges)?void 0:a.mana)||0))),inventory:{...t.inventory,...e.newItems}}:null}),e.reputationChanges&&V(t=>({...t,playerReputation:{...t.playerReputation,...e.reputationChanges}})))});const n={id:Date.now()+1,type:"dm",content:t.narrative,choices:t.choices,timestamp:new Date,atmosphere:t.atmosphere,worldStateUpdates:t.worldStateUpdates};_(e=>[...e,n]),t.combatEncounter&&Te(t.combatEncounter.enemies)}catch(i){const e={id:Date.now()+1,type:"dm",content:"The story continues to unfold... (AI temporarily unavailable)",timestamp:new Date};_(t=>[...t,e])}U(!1)},Ie=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Pe())},Te=e=>{var s,a,n,r;if(!P)return;const i=[{id:P.id||W||"player",name:P.name,type:"player",character:P,position:{x:0,y:0},health:P.health,maxHealth:P.maxHealth,mana:P.mana,maxMana:P.maxMana,actionPoints:P.actionPoints||{move:6,action:1,bonus:1,reaction:1},currentActionPoints:{move:6,action:1,bonus:1,reaction:1},stats:{strength:(null==(s=P.baseStats)?void 0:s.strength)||10,dexterity:(null==(a=P.baseStats)?void 0:a.dexterity)||10,intelligence:(null==(n=P.baseStats)?void 0:n.intelligence)||10,charisma:(null==(r=P.baseStats)?void 0:r.charisma)||10,armorClass:10},statusEffects:[],isActive:!1,hasActed:!1,reach:1,skills:P.skills||{}},...e.map((e,t)=>({id:`enemy-${t}`,name:e.name||`Enemy ${t+1}`,type:"enemy",position:{x:0,y:0},health:e.health||25,maxHealth:e.health||25,actionPoints:{move:4,action:1,bonus:0,reaction:1},currentActionPoints:{move:4,action:1,bonus:0,reaction:1},stats:{strength:e.strength||12,dexterity:e.dexterity||10,intelligence:e.intelligence||8,charisma:e.charisma||8,armorClass:e.armorClass||12},statusEffects:[],isActive:!1,hasActed:!1,reach:1,skills:{}}))],o=t.startCombat(i);q(o),k("combat")},Ae=e=>{const s=t.executeAction(e);if(s.success&&s.newState){q(s.newState);const e=t.checkCombatEnd();e.ended&&("players"===e.winner?(alert("Victory! You have defeated your enemies!"),I(e=>e?{...e,experience:e.experience+50,health:Math.min(e.maxHealth,e.health+20)}:null)):(alert("Defeat! Your party has been defeated..."),I(e=>e?{...e,health:Math.max(1,e.health-10)}:null)),t.endCombat(),q(null),k("game"))}else alert(s.message)},Me=()=>{t.endCombat(),q(null),k("game")},De=e=>{e&&(V(t=>{const s={...t};return e.newLocation&&(s.currentLocation=e.newLocation),e.newNPCs&&e.newNPCs.forEach(e=>{const t=s.npcs[e.name];if(t){const a=na.updateEmotionalState(t,e.emotionalImpact||{});s.npcs[e.name]={...a,...e,lastSeen:new Date,interactionCount:(t.interactionCount||0)+1,knownSecrets:[...t.knownSecrets||[],...e.knownSecrets||[]],currentLocation:s.currentLocation}}else{const t=na.createNPC({...e,id:Date.now().toString(),firstEncounter:new Date,lastSeen:new Date,interactionCount:1,relationship:0,knownSecrets:[],currentLocation:s.currentLocation});s.npcs[e.name]=t}}),e.factionChanges&&e.factionChanges.forEach(e=>{s.factions[e.faction]||(s.factions[e.faction]={name:e.faction,influence:10,goals:[],members:[]}),e.change.includes("influence")&&(s.factions[e.faction].influence+=5)}),e.questUpdates&&e.questUpdates.forEach(e=>{const t=s.activeQuests.findIndex(t=>t.title===e.quest);t>=0&&(s.activeQuests[t]={...s.activeQuests[t],progress:e.progress,currentObjective:e.newObjective})}),s}),le(t=>({...t,playerActions:[...t.playerActions,{description:`Player action: ${L}`,timestamp:new Date,location:J.currentLocation}],consequences:[...t.consequences,...e.consequences||[]]})))},Re=({campaign:e,messages:t,inputMessage:a,setInputMessage:n,sendMessage:r,handleKeyPress:i,isAIThinking:o,messagesEndRef:l,onStartCombat:c,worldState:d,aiMemory:h,inputRef:u})=>{const[m,p]=s.useState(!1),[x,g]=s.useState(!1),[f,b]=s.useState(!1),[y,v]=s.useState(null),[w,j]=s.useState("all"),[N,S]=s.useState(!1),[k,C]=s.useState(!0),E=s.useRef(null);s.useEffect(()=>{!o&&u.current&&u.current.focus()},[o,u]);const I=t.filter(e=>"all"===w||e.type===w);return s.useEffect(()=>{const e=E.current;if(!e)return;const t=()=>{const{scrollTop:t,scrollHeight:s,clientHeight:a}=e;g(!(s-t-a<100))};return e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[]),it.jsxs("div",{className:"h-full flex flex-col transition-all duration-500 "+(N?"fixed inset-0 z-50":""),children:[it.jsxs("div",{className:"relative bg-gradient-to-r from-slate-900/95 via-purple-900/95 to-slate-900/95 backdrop-blur-lg border-b border-purple-500/30",children:[it.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-purple-900/20 via-transparent to-transparent"}),it.jsxs("div",{className:"relative flex items-center justify-between p-4",children:[it.jsxs("div",{className:"flex items-center space-x-4",children:[it.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-blue-600 rounded-xl flex items-center justify-center text-white font-bold text-xl shadow-lg",children:"🗺️"}),it.jsxs("div",{children:[it.jsx("h2",{className:"text-xl font-bold text-white",children:(null==e?void 0:e.theme)||"Adventure"}),it.jsxs("div",{className:"flex items-center space-x-4 text-sm text-purple-200",children:[it.jsx("span",{children:"•"}),it.jsxs("span",{children:[I.length," messages"]}),it.jsx("span",{children:"•"}),it.jsx("span",{className:"text-green-400",children:"Active Campaign"}),(null==d?void 0:d.currentLocation)&&it.jsxs(it.Fragment,{children:[it.jsx("span",{children:"•"}),it.jsx("span",{className:"text-yellow-400",children:d.currentLocation})]})]})]})]}),it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsxs("select",{value:w,onChange:e=>j(e.target.value),className:"px-3 py-1.5 bg-white/10 border border-white/20 rounded-lg text-white text-sm focus:outline-none focus:border-purple-400",children:[it.jsx("option",{value:"all",children:"All Messages"}),it.jsx("option",{value:"dm",children:"DM Only"}),it.jsx("option",{value:"player",children:"Player Only"}),it.jsx("option",{value:"system",children:"System Only"})]}),it.jsx("button",{onClick:()=>p(!m),className:"p-2 rounded-lg transition-all "+(m?"bg-purple-600 text-white":"bg-white/10 text-purple-200 hover:bg-white/20"),title:"Quick Actions",children:"⚡"}),it.jsx("button",{onClick:()=>b(!0),className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-purple-200",title:"Roll Dice",children:"🎲"}),it.jsx("button",{onClick:()=>C(!k),className:"p-2 rounded-lg transition-all "+(k?"bg-green-600 text-white":"bg-white/10 text-purple-200 hover:bg-white/20"),title:"Atmospheric Sounds",children:"🔊"}),it.jsx("button",{onClick:()=>S(!N),className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-purple-200",title:"Toggle Fullscreen",children:N?"🗗":"🗖"})]})]})]}),m&&it.jsx("div",{className:"bg-gradient-to-r from-purple-900/30 to-blue-900/30 border-b border-purple-500/30 backdrop-blur-sm",children:it.jsxs("div",{className:"p-4",children:[it.jsxs("h3",{className:"text-white font-semibold mb-3 flex items-center space-x-2",children:[it.jsx("span",{children:"⚡"}),it.jsx("span",{children:"Quick Actions"})]}),it.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:["I examine my surroundings carefully for clues","I search for hidden passages or secret doors","I listen carefully for any sounds or voices","I check my equipment and inventory","I try to communicate with any nearby NPCs","I cast a detection spell","I move stealthily forward","I prepare for combat"].map((e,t)=>it.jsx("button",{onClick:()=>(e=>{n(e),p(!1),setTimeout(()=>r(),100)})(e),className:"text-left p-3 bg-white/10 hover:bg-white/20 rounded-lg border border-white/20 transition-all text-sm text-purple-100 hover:text-white transform hover:scale-105",disabled:o,children:e},t))})]})}),it.jsxs("div",{ref:E,className:"flex-1 overflow-y-auto bg-gradient-to-br from-slate-950/90 via-purple-950/90 to-slate-950/90 relative",children:[it.jsxs("div",{className:"absolute inset-0 opacity-5",children:[it.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-purple-500 rounded-full filter blur-3xl"}),it.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-48 h-48 bg-blue-500 rounded-full filter blur-3xl"})]}),it.jsxs("div",{className:"relative p-6 space-y-6",children:[I.map((e,t)=>{var s,a,i;return it.jsx("div",{className:"group relative transform transition-all duration-300 hover:scale-[1.01] "+("player"===e.type?"ml-8":"dm"===e.type?"mr-8":""),children:it.jsx("div",{className:"relative p-6 rounded-2xl backdrop-blur-sm border shadow-xl "+("player"===e.type?"bg-gradient-to-br from-blue-600/20 to-cyan-600/20 border-blue-400/30 shadow-blue-500/10":"dm"===e.type?"bg-gradient-to-br from-purple-600/20 to-pink-600/20 border-purple-400/30 shadow-purple-500/10":"bg-gradient-to-br from-gray-600/20 to-slate-600/20 border-gray-400/30 shadow-gray-500/10"),children:it.jsxs("div",{className:"flex items-start space-x-4 mb-4",children:[it.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-xl flex items-center justify-center text-white font-bold shadow-lg "+("player"===e.type?"bg-gradient-to-br from-blue-500 to-cyan-600":"dm"===e.type?"bg-gradient-to-br from-purple-500 to-pink-600":"bg-gradient-to-br from-gray-500 to-slate-600"),children:"player"===e.type?(null==(s=null==P?void 0:P.name)?void 0:s.charAt(0))||"P":"dm"===e.type?"🎭":"⚙️"}),it.jsxs("div",{className:"flex-1 min-w-0",children:[it.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[it.jsx("span",{className:"font-bold text-white text-lg",children:"player"===e.type?(null==P?void 0:P.name)||"You":"dm"===e.type?"Dungeon Master":e.playerName||"System"}),it.jsx("span",{className:"text-xs text-gray-400 bg-black/30 px-2 py-1 rounded-full",children:new Date(e.timestamp).toLocaleTimeString()}),(null==(a=e.atmosphere)?void 0:a.mood)&&it.jsx("span",{className:"text-xs px-3 py-1 rounded-full font-medium "+("tense"===e.atmosphere.mood?"bg-red-500/30 text-red-300 border border-red-500/50":"mysterious"===e.atmosphere.mood?"bg-purple-500/30 text-purple-300 border border-purple-500/50":"peaceful"===e.atmosphere.mood?"bg-green-500/30 text-green-300 border border-green-500/50":"bg-blue-500/30 text-blue-300 border border-blue-500/50"),children:e.atmosphere.mood})]}),it.jsx("div",{className:"text-gray-100 leading-relaxed text-lg",dangerouslySetInnerHTML:{__html:(i=e.content,i?i.replace(/\*\*(.*?)\*\*/g,'<strong class="text-yellow-300">$1</strong>').replace(/\*(.*?)\*/g,'<em class="text-blue-300">$1</em>').replace(/"(.*?)"/g,'<span class="text-green-300">"$1"</span>'):"")}}),e.choices&&e.choices.length>0&&it.jsxs("div",{className:"mt-6 space-y-3",children:[it.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-300",children:[it.jsx("span",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),it.jsx("span",{className:"font-medium",children:"Choose your path:"})]}),it.jsx("div",{className:"grid gap-3",children:e.choices.map((e,t)=>it.jsx("button",{onClick:()=>{n(e),setTimeout(()=>r(),100)},className:"group text-left p-4 bg-gradient-to-r from-white/10 to-white/5 hover:from-white/20 hover:to-white/10 rounded-xl border border-white/20 hover:border-white/40 transition-all duration-300 transform hover:scale-105 hover:shadow-lg",disabled:o,children:it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("span",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-blue-600 rounded-lg flex items-center justify-center text-sm font-bold text-white group-hover:scale-110 transition-transform",children:t+1}),it.jsx("span",{className:"text-gray-200 group-hover:text-white transition-colors font-medium",children:e})]})},t))})]}),e.atmosphere&&it.jsxs("div",{className:"mt-4 p-3 bg-black/20 rounded-xl border border-white/10",children:[it.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Atmosphere"}),it.jsxs("div",{className:"text-sm text-gray-300",children:["🌡️ ",e.atmosphere.mood," • 🌤️ ",e.atmosphere.lighting||"Normal"," • 🔊 ",e.atmosphere.sounds||"Quiet"]})]})]})]})})},e.id||t)}),o&&it.jsx("div",{className:"group transform transition-all duration-300",children:it.jsx("div",{className:"relative p-6 rounded-2xl bg-gradient-to-br from-purple-600/20 to-pink-600/20 border border-purple-400/30 backdrop-blur-sm shadow-xl",children:it.jsxs("div",{className:"flex items-center space-x-4",children:[it.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center text-white shadow-lg",children:"🎭"}),it.jsxs("div",{className:"flex-1",children:[it.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[it.jsx("span",{className:"font-bold text-white text-lg",children:"Dungeon Master"}),it.jsxs("div",{className:"flex space-x-1",children:[it.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"}),it.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),it.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]})]}),it.jsx("div",{className:"text-purple-200 text-lg italic",children:"The Dungeon Master weaves the threads of fate..."})]})]})})}),it.jsx("div",{ref:l})]})]}),x&&it.jsx("div",{className:"absolute bottom-24 right-6 z-10",children:it.jsx("button",{onClick:()=>{var e;return null==(e=l.current)?void 0:e.scrollIntoView({behavior:"smooth"})},className:"p-3 bg-gradient-to-br from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 rounded-full text-white shadow-lg transition-all transform hover:scale-110",children:"↓"})}),it.jsx("div",{className:"bg-gradient-to-r from-slate-900/95 via-purple-900/95 to-slate-900/95 backdrop-blur-lg border-t border-purple-500/30 p-6",children:it.jsxs("div",{className:"flex space-x-4",children:[it.jsxs("div",{className:"flex-1 relative",children:[it.jsx("input",{ref:u,type:"text",value:a,onChange:e=>n(e.target.value),onKeyDown:i,placeholder:"What do you do? (Be specific and creative!)",className:"w-full px-6 py-4 bg-white/10 text-white placeholder-purple-200 rounded-2xl border border-white/20 focus:outline-none focus:border-purple-400 focus:ring-2 focus:ring-purple-400/50 transition-all text-lg backdrop-blur-sm",disabled:o,maxLength:500}),a.length>0&&it.jsxs("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-sm text-gray-400 bg-black/30 px-2 py-1 rounded-full",children:[a.length,"/500"]})]}),it.jsx("button",{onClick:r,disabled:o||!a.trim(),className:"px-8 py-4 bg-gradient-to-br from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed rounded-2xl transition-all text-white font-bold text-lg shadow-lg transform hover:scale-105 disabled:transform-none",children:o?"⏳":"🚀"})]})}),f&&it.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50",children:it.jsxs("div",{className:"bg-gradient-to-br from-purple-900/90 to-blue-900/90 backdrop-blur-lg rounded-2xl p-8 border border-purple-400/30 shadow-2xl max-w-md w-full mx-4",children:[it.jsx("h3",{className:"text-2xl font-bold mb-6 text-white text-center",children:"🎲 Dice Roller"}),it.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[4,6,8,10,12,20].map(e=>it.jsxs("button",{onClick:()=>(e=>{const t=Math.floor(Math.random()*e)+1;v(t),n(`I roll a d${e} and get ${t}`),setTimeout(()=>v(null),3e3)})(e),className:"p-4 bg-white/10 hover:bg-white/20 rounded-xl transition-all text-white font-bold text-lg transform hover:scale-105 border border-white/20 hover:border-white/40",children:["d",e]},e))}),y&&it.jsxs("div",{className:"text-center mb-6 p-4 bg-gradient-to-br from-yellow-500/20 to-orange-500/20 rounded-xl border border-yellow-400/30",children:[it.jsxs("div",{className:"text-3xl font-bold text-yellow-400 mb-2",children:["🎯 ",y]}),it.jsx("div",{className:"text-yellow-200",children:"Great roll!"})]}),it.jsx("button",{onClick:()=>b(!1),className:"w-full px-6 py-3 bg-gradient-to-br from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 rounded-xl transition-all text-white font-bold",children:"Close"})]})})]})};return"welcome"===S?it.jsx("div",{className:`min-h-screen bg-gradient-to-br ${{default:"from-purple-900 via-blue-900 to-indigo-900",fantasy:"from-emerald-900 via-green-800 to-teal-900",dungeon:"from-gray-900 via-slate-800 to-stone-900",forest:"from-green-900 via-emerald-800 to-lime-900",tavern:"from-amber-900 via-orange-800 to-yellow-900",scifi:"from-cyan-900 via-blue-800 to-indigo-900",horror:"from-red-900 via-purple-900 to-black",urban:"from-slate-900 via-gray-800 to-zinc-900",apocalypse:"from-orange-900 via-red-800 to-yellow-900",pirate:"from-blue-900 via-teal-800 to-cyan-900"}[z]} flex items-center justify-center p-4 transition-all duration-1000`,children:it.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-3xl p-8 max-w-md w-full border border-white/20",children:[it.jsxs("div",{className:"text-center mb-8",children:[it.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"⚔️ AI Dungeon Master"}),it.jsx("p",{className:"text-blue-200",children:"Advanced RPG with real consequences"}),it.jsxs("div",{className:"flex justify-center space-x-4 mt-4 text-sm",children:[it.jsxs("div",{className:"flex items-center space-x-1 text-yellow-400",children:[it.jsx(Se,{size:16}),it.jsx("span",{children:"Tactical Combat"})]}),it.jsxs("div",{className:"flex items-center space-x-1 text-green-400",children:[it.jsx(ee,{size:16}),it.jsx("span",{children:"Character Growth"})]}),it.jsxs("div",{className:"flex items-center space-x-1 text-purple-400",children:[it.jsx(Ne,{size:16}),it.jsx("span",{children:"Living World"})]})]}),it.jsx(Ci,{content:"Interactive tutorial and help guide",ariaLabel:"Help tutorial",children:it.jsxs("button",{onClick:()=>{c(!0),h("welcome")},className:"mt-4 px-4 py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-all flex items-center space-x-2 mx-auto","aria-label":"Open interactive tutorial and help guide",children:[it.jsx(Le,{size:16}),it.jsx("span",{children:"Interactive Tutorial"})]})})]}),g?it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto mb-4"}),it.jsx("p",{className:"text-blue-200",children:"Loading..."})]}):b?it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{className:"text-center mb-4",children:[it.jsxs("p",{className:"text-white",children:["Welcome back, ",null==u?void 0:u.displayName,"!"]}),it.jsx(Ci,{content:"Continue your adventure with existing characters",ariaLabel:"Continue adventure",children:it.jsx("button",{onClick:async()=>{try{if(await fe(),M&&M.length>0){const e=M.find(e=>"active"===e.status)||M[0];e?(A(e),k("game"),xe("/game",{state:{campaignId:e.id}})):(k("character-select"),xe("/characters"))}else k("character-select"),xe("/characters")}catch(e){k("character-select"),xe("/characters")}},className:"w-full px-6 py-3 bg-gradient-to-r from-green-600 to-blue-600 text-white rounded-xl font-semibold hover:from-green-700 hover:to-blue-700 transition-all","aria-label":"Continue your adventure with existing characters",children:"Continue Adventure"})})]}),it.jsx(Ci,{content:"Sign out of your account",ariaLabel:"Sign out",children:it.jsx("button",{onClick:async()=>{try{await Qs.signOut(),I(null),A(null),x([]),m(null),y(!1),k("welcome"),ue("goodbye",{message:"See you next time, adventurer!"})}catch(e){}},className:"w-full px-6 py-3 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-all","aria-label":"Sign out of your account",children:"Sign Out"})})]}):it.jsxs("div",{className:"space-y-4",children:[it.jsx(Ci,{content:"Sign in with your Google account to save progress",ariaLabel:"Sign in with Google",children:it.jsxs("button",{onClick:pe,disabled:g,className:"w-full px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center space-x-2","aria-label":"Sign in with your Google account to save progress","aria-describedby":"signin-description",children:[it.jsx(ve,{size:20}),it.jsx("span",{children:"Sign in with Google"})]})}),it.jsx("div",{id:"signin-description",className:"sr-only",children:"Sign in to save your progress and access multiplayer features"}),it.jsxs("div",{className:"text-center",children:[it.jsx("p",{className:"text-blue-200 text-sm mb-3",children:"Or join an existing campaign:"}),it.jsxs("div",{className:"flex space-x-2",children:[it.jsx("input",{type:"text",placeholder:"Campaign Code",value:Y,onChange:e=>G(e.target.value.toUpperCase()),className:"flex-1 px-3 py-2 rounded-lg bg-white/20 text-white placeholder-blue-200 border border-white/30 focus:outline-none focus:border-blue-400 text-center","aria-label":"Enter campaign code to join existing game",maxLength:6}),it.jsx(Ci,{content:"Join an existing campaign using the 6-character code",ariaLabel:"Join campaign",children:it.jsx("button",{onClick:()=>{C.trim()&&Y.trim()&&(P?alert("Join campaign feature coming soon!"):k("character"))},disabled:!C.trim()||!Y.trim(),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-all","aria-label":"Join campaign with entered code",children:"Join"})})]})]})]})]})}):("character-select"===S&&p.forEach((e,t)=>{}),it.jsxs("div",{className:"h-full overflow-hidden",children:[it.jsxs(Ei,{children:[it.jsx(Pi,{messages:a,onDismiss:me}),r&&it.jsx(s.Suspense,{fallback:it.jsx(cl,{}),children:it.jsx(sl,{character:P,onStart:async()=>{try{const e={id:`tutorial_${Date.now()}`,name:"Apprentice",class:"Mage",level:1,health:16,maxHealth:16,mana:20,maxMana:20,experience:0,gold:25,inventory:{Staff:1,Spellbook:1,"Mana Potion":2},baseStats:{strength:8,dexterity:12,intelligence:16,charisma:14},skills:["Arcana","Investigation"],backstory:"A young apprentice learning the ways of magic and adventure.",totalPlayTime:0,lastPlayed:new Date,achievements:[]};I(e);const t={id:`tutorial_campaign_${Date.now()}`,name:"Learning Adventure",theme:"Fantasy",description:"A guided tutorial to learn MythSeeker mechanics",isMultiplayer:!1,started:!1,status:"active",isTutorial:!0,players:[{id:W,name:(null==u?void 0:u.displayName)||"Player",character:e}],customPrompt:"You are a patient, educational DM teaching a new player. This is a tutorial campaign designed to teach MythSeeker mechanics through play.\n\nTUTORIAL OBJECTIVES:\n1. Teach basic movement and exploration\n2. Introduce NPC interaction and dialogue\n3. Demonstrate simple combat mechanics\n4. Show inventory and character management\n5. Explain quest and objective systems\n\nGUIDELINES:\n- Be encouraging and supportive\n- Explain mechanics naturally through story\n- Provide clear choices that teach different systems\n- Keep challenges easy and educational\n- Celebrate player successes\n- Use simple, clear language\n- Reference the tutorial nature when helpful\n\nStart with a welcoming scene that introduces the magical academy setting and the player's role as an apprentice.",createdAt:new Date,lastActivity:new Date};await je(t),ue("success",{message:"Tutorial started! Learn the ropes of MythSeeker!"})}catch(e){ue("error",{message:"Failed to start tutorial. Please try again."})}},onDismiss:()=>{o(!1)}})}),it.jsx("div",{className:"h-full overflow-hidden",children:it.jsx("main",{className:"h-full overflow-hidden",children:it.jsx("div",{className:"h-full",children:it.jsx("div",{className:"h-full overflow-hidden",children:(()=>{switch(S){case"character":return b?it.jsxs("div",{className:"h-full p-6",children:[it.jsxs("div",{className:"flex justify-between items-center mb-6",children:[it.jsx("h2",{className:"text-3xl font-bold text-white",children:"Create Your Hero"}),it.jsx("button",{onClick:()=>k("character-select"),className:"px-4 py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-all",children:"← Back to Characters"})]}),it.jsx(hl,{playerName:(null==u?void 0:u.displayName)||"",classes:be,onCreateCharacter:we,joinCode:Y})]}):it.jsx("div",{className:"h-full flex items-center justify-center p-4",children:it.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-3xl p-8 max-w-md w-full border border-white/20 text-center",children:[it.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Authentication Required"}),it.jsx("p",{className:"text-blue-200 mb-6",children:"Please sign in to create a character"}),it.jsx("button",{onClick:pe,className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all",children:"Sign in with Google"})]})});case"waiting":return it.jsx(ul,{campaign:T,onStart:je,onBack:()=>k("lobby")});case"game":return it.jsx(Re,{campaign:T,messages:R,inputMessage:L,setInputMessage:O,sendMessage:Pe,handleKeyPress:Ie,isAIThinking:$,messagesEndRef:X,onStartCombat:Te,worldState:J,aiMemory:oe,inputRef:Z});case"combat":return B&&it.jsx(s.Suspense,{fallback:it.jsx(cl,{}),children:it.jsx(al,{combatants:B.combatants,battleMap:B.battleMap,currentTurn:B.currentTurn,activeCombatantId:B.turnOrder[B.currentCombatantIndex],onAction:Ae,onEndCombat:Me,isPlayerTurn:t.isPlayerTurn()})});case"world":return it.jsxs("div",{className:"h-full p-6",children:[it.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"World Map & Exploration"}),it.jsxs("div",{className:"bg-white/10 rounded-lg p-6 border border-white/20",children:[it.jsx("p",{className:"text-blue-200 mb-4",children:"Interactive world map coming soon!"}),it.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[it.jsxs("div",{className:"bg-black/20 rounded-lg p-4",children:[it.jsx("h3",{className:"text-white font-semibold mb-2",children:"Current Location"}),it.jsx("p",{className:"text-blue-200",children:(null==J?void 0:J.currentLocation)||"Unknown"})]}),it.jsxs("div",{className:"bg-black/20 rounded-lg p-4",children:[it.jsx("h3",{className:"text-white font-semibold mb-2",children:"Weather"}),it.jsx("p",{className:"text-blue-200",children:(null==J?void 0:J.weather)||"Clear"})]})]})]})]});case"characters":case"character-select":return it.jsxs("div",{className:"h-full p-6",children:[it.jsxs("div",{className:"flex justify-between items-center mb-6",children:[it.jsxs("div",{children:[it.jsx("h2",{className:"text-3xl font-bold text-white",children:"Choose Your Character"}),it.jsxs("p",{className:"text-blue-200",children:["Welcome back, ",null==u?void 0:u.displayName,"!"]})]}),it.jsxs("div",{className:"flex space-x-3",children:[it.jsx("button",{onClick:()=>k("dashboard"),className:"px-4 py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-all",children:"← Back to Dashboard"}),it.jsx("button",{onClick:()=>k("character"),className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-semibold hover:from-blue-700 hover:to-purple-700 transition-all",children:"Create New Character"})]})]}),0===p.length?it.jsxs("div",{className:"text-center py-12",children:[it.jsx("div",{className:"text-6xl mb-4",children:"🏰"}),it.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Characters Yet"}),it.jsx("p",{className:"text-blue-200 mb-6",children:"Create your first character to begin your adventure!"}),it.jsx("button",{onClick:()=>k("character"),className:"px-6 py-3 bg-gradient-to-r from-green-600 to-blue-600 text-white rounded-xl font-semibold hover:from-green-700 hover:to-blue-700 transition-all",children:"Create Your First Character"})]}):it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[p.map(e=>it.jsx("div",{className:"bg-white/10 rounded-xl p-6 border border-white/20 hover:border-blue-400 hover:bg-white/20 cursor-pointer transition-all",onClick:()=>(async e=>{try{const t=JSON.parse(localStorage.getItem("mythseeker_characters")||"[]").find(t=>t.id===e);if(t)return I(t),void ue("characterLoaded",{character:t.name});if(u){const t=await Qs.getCharacter(e);t?(I(t),ue("characterLoaded",{character:t.name})):ue("error",{message:"Character not found in database"})}else ue("error",{message:"Character not found"})}catch(t){ue("error",{message:`Failed to load character: ${t.message||"Unknown error"}`})}})(e.id),children:it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"text-4xl mb-3",children:"Warrior"===e.class?"⚔️":"Rogue"===e.class?"🗡️":"Mage"===e.class?"🔮":"Cleric"===e.class?"⚡":"Ranger"===e.class?"🏹":"🎵"}),it.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:e.name}),it.jsxs("p",{className:"text-blue-200 mb-3",children:["Level ",e.level," ",e.class]}),it.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-blue-200",children:[it.jsxs("div",{children:["HP: ",e.health,"/",e.maxHealth]}),it.jsxs("div",{children:["XP: ",e.experience]}),it.jsxs("div",{children:["Gold: ",e.gold]}),it.jsxs("div",{children:["Play Time: ",Math.floor(e.totalPlayTime/6e4),"m"]})]}),it.jsxs("div",{className:"mt-3 text-xs text-green-400",children:["Last played: ",new Date(e.lastPlayed).toLocaleDateString()]})]})},e.id)),it.jsx("div",{onClick:()=>k("character"),className:"bg-gradient-to-br from-green-500/20 to-blue-500/20 rounded-xl p-6 border-2 border-dashed border-white/30 hover:border-white/50 hover:from-green-500/30 hover:to-blue-500/30 cursor-pointer transition-all",children:it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"text-4xl mb-3",children:"✨"}),it.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Create New Character"}),it.jsx("p",{className:"text-blue-200",children:"Start a new adventure with a fresh hero"})]})})]})]});case"profile":return b?it.jsxs("div",{className:"h-full p-6",children:[it.jsxs("div",{className:"flex justify-between items-center mb-6",children:[it.jsx("h2",{className:"text-3xl font-bold text-white",children:"Player Profile"}),it.jsx("button",{onClick:()=>k("dashboard"),className:"px-4 py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-all",children:"← Back to Dashboard"})]}),it.jsx("div",{className:"h-[calc(100vh-200px)]",children:it.jsx(Xs,{})})]}):it.jsx("div",{className:"h-full flex items-center justify-center p-4",children:it.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-3xl p-8 max-w-md w-full border border-white/20 text-center",children:[it.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Authentication Required"}),it.jsx("p",{className:"text-blue-200 mb-6",children:"Please sign in to view your profile"}),it.jsx("button",{onClick:pe,className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-semibold hover:from-blue-700 hover:to-purple-700 transition-all",children:"Sign in with Google"})]})});default:return null}})()})})})}),"dm-center"!==S&&it.jsx(s.Suspense,{fallback:it.jsx(cl,{}),children:it.jsx(nl,{isOpen:v,onClose:()=>w(!1),activeTab:re,onTabChange:ie,isMobile:j,campaign:T,messages:R,players:ae.players,worldState:J,achievements:K,onSendMessage:async e=>{if(e.trim()&&(null==T?void 0:T.id))try{await Li.sendMessage(T.id,{type:"player",content:e,character:null==P?void 0:P.name,playerId:W,playerName:C}),ue("messageSent")}catch(t){}},onUpdateSettings:e=>{},drawerWidth:ce,setDrawerWidth:de,minWidth:320,maxWidth:600})})]}),it.jsx(s.Suspense,{fallback:it.jsx(cl,{}),children:it.jsx(il,{isOpen:l,onClose:()=>c(!1)})}),it.jsx(s.Suspense,{fallback:it.jsx(cl,{}),children:it.jsx(ol,{isOpen:l,onClose:()=>c(!1),currentScreen:d,onAction:(e,t)=>{switch(e){case"close":c(!1);break;case"navigate":h(t.screen)}qo.trackUserAction("help_action",{action:e,data:t})}})})]}))},hl=({playerName:e,classes:t,onCreateCharacter:a,joinCode:n})=>{const[r,i]=s.useState(null),[o,l]=s.useState(e),[c,d]=s.useState(""),[h,u]=s.useState(null),[m,p]=s.useState({}),[x,g]=s.useState(!1),[f,b]=s.useState(1),[y,v]=s.useState(!1),w=["fuck","shit","bitch","asshole","bastard","dick","cunt","piss","cock","fag","slut","whore"],j=e=>{if(!e)return!1;const t=e.toLowerCase();return w.some(e=>t.includes(e))},N=()=>{let e=0;return o.trim()&&(e+=40),r&&(e+=40),c.trim()&&(e+=20),e},S=h||r,k=o.trim().length>0&&!m.name,C=null!==r&&!m.class,E=0===c.length||!m.backstory&&c.trim().length>0;return it.jsxs("div",{className:"space-y-6 character-creation",children:[it.jsxs("div",{className:"bg-white/10 rounded-xl p-4 mb-6",children:[it.jsxs("div",{className:"flex items-center justify-between mb-3",children:[it.jsx("h3",{className:"text-white font-semibold",children:"Character Creation Progress"}),it.jsxs("span",{className:"text-blue-300 text-sm",children:[N(),"% Complete"]})]}),it.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mb-4",children:it.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${N()}%`}})}),it.jsxs("div",{className:"flex items-center justify-between text-sm",children:[it.jsxs("div",{className:"flex items-center space-x-2 "+(k?"text-green-400":o.trim()?"text-yellow-400":"text-gray-400"),children:[it.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold "+(k?"bg-green-500":o.trim()?"bg-yellow-500":"bg-gray-500"),children:k?"✓":"1"}),it.jsx("span",{children:"Name"})]}),it.jsxs("div",{className:"flex items-center space-x-2 "+(C?"text-green-400":r?"text-yellow-400":"text-gray-400"),children:[it.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold "+(C?"bg-green-500":r?"bg-yellow-500":"bg-gray-500"),children:C?"✓":"2"}),it.jsx("span",{children:"Class"})]}),it.jsxs("div",{className:"flex items-center space-x-2 "+(E?"text-green-400":c.trim()?"text-yellow-400":"text-gray-400"),children:[it.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold "+(E?"bg-green-500":c.trim()?"bg-yellow-500":"bg-gray-500"),children:E?"✓":"3"}),it.jsx("span",{children:"Story"})]})]})]}),y&&it.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center",children:it.jsxs("div",{className:"bg-gradient-to-br from-purple-900/90 to-blue-900/90 rounded-2xl p-8 max-w-md mx-4 text-center border border-purple-500/50",children:[it.jsx("div",{className:"text-6xl mb-4 animate-bounce",children:null==r?void 0:r.icon}),it.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Character Created!"}),it.jsxs("p",{className:"text-purple-200 mb-4",children:[o," the ",null==r?void 0:r.name," is ready for adventure!"]}),it.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-purple-300/30 border-t-purple-400 rounded-full mx-auto"})]})}),it.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-8",children:[it.jsxs("div",{className:"space-y-4 lg:space-y-6",children:[it.jsxs("div",{className:"transition-all duration-300 "+(1===f?"ring-2 ring-blue-400 rounded-xl p-4":""),children:[it.jsxs("label",{className:"block text-white font-semibold mb-2 lg:mb-3 text-sm lg:text-base flex items-center space-x-2",children:[it.jsx("span",{className:"bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold",children:"1"}),it.jsx("span",{children:"Character Name"}),k&&it.jsx("span",{className:"text-green-400",children:"✓"})]}),it.jsx("input",{type:"text",placeholder:"Enter your hero's name...",value:o,onChange:e=>{l(e.target.value),1===f&&e.target.value.trim()&&setTimeout(()=>b(2),500)},onFocus:()=>b(1),className:"w-full px-3 lg:px-4 py-2 lg:py-3 rounded-xl bg-white/20 text-white placeholder-blue-200 border transition-all duration-300 focus:outline-none text-sm lg:text-base "+(m.name?"border-red-400 focus:border-red-400":k?"border-green-400 focus:border-green-400":"border-white/30 focus:border-blue-400")}),m.name&&it.jsx("div",{className:"text-red-400 text-xs mt-1 animate-pulse",children:m.name}),k&&!m.name&&it.jsxs("div",{className:"text-green-400 text-xs mt-1 flex items-center space-x-1",children:[it.jsx("span",{children:"✓"}),it.jsx("span",{children:"Great name choice!"})]})]}),it.jsxs("div",{className:"transition-all duration-300 "+(2===f?"ring-2 ring-blue-400 rounded-xl p-4":""),children:[it.jsxs("label",{className:"block text-white font-semibold mb-2 lg:mb-3 text-sm lg:text-base flex items-center space-x-2",children:[it.jsx("span",{className:"bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold",children:"2"}),it.jsx("span",{children:"Choose Your Class"}),C&&it.jsx("span",{className:"text-green-400",children:"✓"})]}),it.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-4 class-grid",children:t&&t.length>0?t.map(e=>it.jsx("div",{onClick:()=>{i(e),2===f&&setTimeout(()=>b(3),500)},onFocus:()=>b(2),onMouseEnter:()=>u(e),onMouseLeave:()=>u(null),className:"class-card p-3 lg:p-4 rounded-xl border-2 cursor-pointer transition-all duration-300 transform "+((null==r?void 0:r.name)===e.name?"border-green-400 bg-green-500/30 shadow-lg scale-105 selected":(null==h?void 0:h.name)===e.name?"border-blue-400 bg-blue-500/20 shadow-md scale-102":"border-white/30 bg-white/10 hover:border-white/50 hover:scale-102"),children:it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"text-2xl lg:text-3xl mb-2 transition-transform duration-300 hover:scale-110",children:e.icon}),it.jsx("h3",{className:"text-white font-semibold text-sm lg:text-base mb-2",children:e.name}),it.jsxs("div",{className:"text-xs text-blue-200 space-y-1 mb-2",children:[it.jsxs("div",{className:"flex justify-between",children:[it.jsxs("span",{children:["STR: ",e.stats.strength]}),it.jsx("span",{className:"text-yellow-300",children:"Attack Power"})]}),it.jsxs("div",{className:"flex justify-between",children:[it.jsxs("span",{children:["DEX: ",e.stats.dexterity]}),it.jsx("span",{className:"text-green-300",children:"Agility"})]}),it.jsxs("div",{className:"flex justify-between",children:[it.jsxs("span",{children:["INT: ",e.stats.intelligence]}),it.jsx("span",{className:"text-purple-300",children:"Magic"})]}),it.jsxs("div",{className:"flex justify-between",children:[it.jsxs("span",{children:["CHA: ",e.stats.charisma]}),it.jsx("span",{className:"text-pink-300",children:"Social"})]})]}),(null==r?void 0:r.name)===e.name&&it.jsxs("div",{className:"flex items-center justify-center space-x-1 text-green-400 text-xs animate-pulse",children:[it.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),it.jsx("span",{children:"Selected"})]})]})},e.name)):it.jsxs("div",{className:"col-span-2 text-center py-8 text-gray-400",children:[it.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-300/30 border-t-blue-400 rounded-full mx-auto mb-4"}),it.jsx("p",{children:"Loading character classes..."})]})}),m.class&&it.jsx("div",{className:"text-red-400 text-xs mt-1 animate-pulse",children:m.class}),C&&!m.class&&it.jsxs("div",{className:"text-green-400 text-xs mt-1 flex items-center space-x-1",children:[it.jsx("span",{children:"✓"}),it.jsxs("span",{children:["Excellent choice! ",r.name," is a powerful class."]})]})]}),it.jsxs("div",{className:"transition-all duration-300 "+(3===f?"ring-2 ring-blue-400 rounded-xl p-4":""),children:[it.jsxs("label",{className:"block text-white font-semibold mb-2 lg:mb-3 text-sm lg:text-base flex items-center space-x-2",children:[it.jsx("span",{className:"bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold",children:"3"}),it.jsx("span",{children:"Character Backstory"}),it.jsx("span",{className:"text-blue-300 text-xs",children:"(Optional)"}),E&&it.jsx("span",{className:"text-green-400",children:"✓"})]}),it.jsx("div",{className:"mb-3 flex flex-wrap gap-2",children:["What is your character's greatest fear?","Where did they grow up?","What brought them to adventure?","Who is their closest friend?","What do they value most?"].map((e,t)=>it.jsx("button",{onClick:()=>{d(t=>t?`${t}\n\n${e}`:e),b(3)},className:"px-2 py-1 bg-blue-600/30 text-blue-200 text-xs rounded hover:bg-blue-600/50 transition-all transform hover:scale-105",children:e},t))}),it.jsx("textarea",{value:c,onChange:e=>{d(e.target.value),b(3)},onFocus:()=>b(3),placeholder:"Describe your character's background, motivations, and personality... (Click prompts above for inspiration)",className:"w-full px-3 lg:px-4 py-2 lg:py-3 rounded-xl bg-white/20 text-white placeholder-blue-200 border transition-all duration-300 focus:outline-none h-24 lg:h-32 resize-none text-sm lg:text-base "+(m.backstory?"border-red-400 focus:border-red-400":E&&c.trim()?"border-green-400 focus:border-green-400":"border-white/30 focus:border-blue-400")}),m.backstory&&it.jsx("div",{className:"text-red-400 text-xs mt-1 animate-pulse",children:m.backstory}),E&&c.trim()&&!m.backstory&&it.jsxs("div",{className:"text-green-400 text-xs mt-1 flex items-center space-x-1",children:[it.jsx("span",{children:"✓"}),it.jsx("span",{children:"Great backstory! This will enhance your roleplay experience."})]})]}),it.jsx("button",{onClick:()=>{(()=>{g(!0);const e={};return o.trim()?o.length>50?e.name="Character name must be 50 characters or less.":j(o)&&(e.name="Please choose a more appropriate name."):e.name="Character name is required.",r||(e.class="Character class is required."),c.length>0&&j(c)?e.backstory="Please remove inappropriate language from the backstory.":c.length>500&&(e.backstory="Backstory must be 500 characters or less."),p(e),setTimeout(()=>g(!1),500),0===Object.keys(e).length})()&&(v(!0),setTimeout(()=>{a({name:o.trim(),class:r.name,backstory:c.trim()})},1500))},disabled:!r||!o.trim()||x,className:"w-full px-4 lg:px-6 py-3 rounded-xl font-semibold transition-all duration-300 text-sm lg:text-base transform "+(r&&o.trim()&&!x?"bg-gradient-to-r from-green-600 to-blue-600 text-white hover:from-green-700 hover:to-blue-700 shadow-lg hover:scale-105 hover:shadow-xl":"bg-gray-600 text-gray-300 cursor-not-allowed opacity-50"),children:x?it.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[it.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white/30 border-t-white rounded-full"}),it.jsx("span",{children:"Validating..."})]}):r&&o.trim()?`Create ${o} the ${r.name}`:"Complete required fields to create character"})]}),it.jsxs("div",{className:"bg-white/10 rounded-xl p-4 lg:p-6 transition-all duration-300",children:[it.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:S?`Class Preview: ${S.name}`:"Select a Class"}),S?it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[it.jsx("div",{className:"text-4xl animate-pulse",children:S.icon}),it.jsxs("div",{children:[it.jsx("h4",{className:"text-lg font-semibold text-white",children:S.name}),it.jsx("p",{className:"text-blue-200 text-sm",children:"Master of tactical combat"})]})]}),o.trim()&&it.jsxs("div",{className:"bg-gradient-to-r from-purple-900/50 to-blue-900/50 rounded-lg p-4 border border-purple-500/30",children:[it.jsxs("h5",{className:"text-white font-semibold mb-2 flex items-center space-x-2",children:[it.jsx("span",{children:"✨"}),it.jsx("span",{children:"Character Preview"})]}),it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:"text-3xl mb-2",children:S.icon}),it.jsx("p",{className:"text-lg font-bold text-white",children:o}),it.jsxs("p",{className:"text-blue-300",children:["Level 1 ",S.name]}),it.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-xs",children:[it.jsx("div",{className:"bg-red-500/20 rounded px-2 py-1",children:it.jsx("span",{className:"text-red-300",children:"❤️ Health: 100"})}),it.jsx("div",{className:"bg-blue-500/20 rounded px-2 py-1",children:it.jsx("span",{className:"text-blue-300",children:"✨ Mana: 50"})})]})]})]}),it.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[it.jsx("h5",{className:"text-white font-semibold mb-2",children:"Class Description"}),it.jsxs("p",{className:"text-blue-200 text-sm leading-relaxed",children:["Warrior"===S.name&&"A mighty warrior skilled in close combat, wielding powerful weapons and wearing heavy armor. Your strength and endurance make you the frontline defender of your party.","Rogue"===S.name&&"A stealthy rogue who excels at sneaking, lockpicking, and dealing devastating sneak attacks. Your agility and cunning allow you to strike from the shadows.","Mage"===S.name&&"A powerful spellcaster who harnesses the arcane arts to cast devastating spells. Your intelligence and magical prowess make you a force to be reckoned with.","Cleric"===S.name&&"A divine spellcaster who channels the power of the gods to heal allies and smite enemies. Your faith and charisma make you an invaluable support.","Ranger"===S.name&&"A skilled hunter and tracker who excels at ranged combat and wilderness survival. Your dexterity and knowledge of nature make you a versatile adventurer.","Bard"===S.name&&"A charismatic performer who uses music and magic to inspire allies and charm enemies. Your creativity and social skills make you the heart of any party."]})]}),it.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[it.jsx("h5",{className:"text-white font-semibold mb-2",children:"Starting Equipment"}),it.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsx("span",{className:"text-yellow-400",children:"⚔️"}),it.jsx("span",{className:"text-blue-200",children:"Iron Sword"})]}),it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsx("span",{className:"text-brown-400",children:"🛡️"}),it.jsx("span",{className:"text-blue-200",children:"Leather Armor"})]}),it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsx("span",{className:"text-red-400",children:"🧪"}),it.jsx("span",{className:"text-blue-200",children:"3x Healing Potions"})]}),it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsx("span",{className:"text-yellow-400",children:"💰"}),it.jsx("span",{className:"text-blue-200",children:"100 Gold Pieces"})]})]})]}),it.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[it.jsx("h5",{className:"text-white font-semibold mb-2",children:"Class Abilities"}),it.jsx("div",{className:"space-y-2 text-sm",children:S.skills&&Object.entries(S.skills).slice(0,3).map(([e,t])=>it.jsxs("div",{className:"flex justify-between items-center",children:[it.jsx("span",{className:"text-blue-200 capitalize",children:e.replace(/([A-Z])/g," $1").trim()}),it.jsx("div",{className:"flex items-center space-x-1",children:[...Array(5)].map((e,s)=>it.jsx("div",{className:"w-2 h-2 rounded-full "+(s<t?"bg-yellow-400":"bg-gray-600")},s))})]},e))})]})]}):it.jsxs("div",{className:"text-center text-blue-200 py-8",children:[it.jsx("div",{className:"text-4xl mb-4 opacity-50",children:"🎭"}),it.jsx("p",{children:"Select a class to see detailed information"})]})]})]})]})},ul=({campaign:e,onStart:t,onBack:a})=>{var n,r,i;const[o,l]=s.useState(0),[c,d]=s.useState(1);s.useEffect(()=>{if(null==e?void 0:e.players){const t=e.players.filter(e=>"ready"===e.status).length;l(t),d(e.players.length)}},[e]);const h=(null==(r=null==(n=null==e?void 0:e.players)?void 0:n[0])?void 0:r.isHost)||!1;return it.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 text-white p-6",children:it.jsxs("div",{className:"w-full",children:[it.jsxs("div",{className:"text-center mb-8",children:[it.jsx("h2",{className:"text-4xl font-bold mb-4",children:"Campaign Lobby"}),it.jsxs("div",{className:"bg-white/10 rounded-lg p-4 inline-block",children:[it.jsx("p",{className:"text-lg mb-2",children:"Campaign Code:"}),it.jsx("div",{className:"font-mono text-3xl bg-white/20 px-6 py-3 rounded-lg border border-white/30",children:(null==e?void 0:e.code)||"LOADING"}),it.jsx("p",{className:"text-blue-200 text-sm mt-2",children:"Share this code with other players"})]})]}),it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[it.jsxs("div",{className:"bg-white/10 rounded-lg p-6 border border-white/20",children:[it.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Campaign Details"}),it.jsxs("div",{className:"space-y-2",children:[it.jsxs("p",{children:[it.jsx("span",{className:"text-blue-200",children:"Theme:"})," ",(null==e?void 0:e.theme)||"Unknown"]}),it.jsxs("p",{children:[it.jsx("span",{className:"text-blue-200",children:"Max Players:"})," ",(null==e?void 0:e.maxPlayers)||6]}),it.jsxs("p",{children:[it.jsx("span",{className:"text-blue-200",children:"Type:"})," ",(null==e?void 0:e.isMultiplayer)?"Multiplayer":"Solo"]}),(null==e?void 0:e.customPrompt)&&it.jsxs("p",{children:[it.jsx("span",{className:"text-blue-200",children:"Custom Story:"})," ",e.customPrompt]})]})]}),it.jsxs("div",{className:"bg-white/10 rounded-lg p-6 border border-white/20",children:[it.jsxs("h3",{className:"text-xl font-semibold mb-4",children:["Players (",c,"/",(null==e?void 0:e.maxPlayers)||6,")"]}),it.jsx("div",{className:"space-y-3",children:(null==(i=null==e?void 0:e.players)?void 0:i.map((e,t)=>{var s,a;return it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("div",{className:"w-3 h-3 rounded-full "+("ready"===e.status?"bg-green-400":"bg-yellow-400")}),it.jsxs("div",{className:"flex-1",children:[it.jsx("p",{className:"font-medium",children:(null==(s=e.character)?void 0:s.name)||e.name}),it.jsxs("p",{className:"text-sm text-blue-200",children:[(null==(a=e.character)?void 0:a.class)||"Unknown Class"," ",e.isHost?"(Host)":""]})]}),it.jsx("div",{className:"px-3 py-1 rounded-full text-xs "+("ready"===e.status?"bg-green-600 text-white":"bg-yellow-600 text-white"),children:"ready"===e.status?"Ready":"Not Ready"})]},e.id||t)}))||it.jsx("div",{className:"text-center text-blue-200 py-4",children:it.jsx("p",{children:"Loading players..."})})})]})]}),it.jsx("div",{className:"bg-gradient-to-r from-orange-600/20 to-yellow-600/20 rounded-lg p-6 border border-orange-400/30 mb-6",children:it.jsxs("div",{className:"flex items-start space-x-4",children:[it.jsx("div",{className:"text-3xl",children:"🎯"}),it.jsxs("div",{className:"flex-1",children:[it.jsx("h3",{className:"text-xl font-semibold text-orange-200 mb-2",children:"Turn-Based Multiplayer"}),it.jsx("p",{className:"text-orange-100 mb-3",children:"You can start this multiplayer campaign solo! Other players can join during the game when it's their turn. Perfect for turn-based gameplay where friends hop in and out as needed."}),it.jsxs("div",{className:"flex items-center space-x-2 text-sm text-orange-200",children:[it.jsx("span",{children:"✨"}),it.jsx("span",{children:"Players can join mid-game using the campaign code"})]})]})]})}),it.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[h&&it.jsxs("button",{onClick:()=>{t(e)},className:"flex-1 px-8 py-4 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white rounded-xl font-bold text-lg transition-all transform hover:scale-105 shadow-lg",children:["🚀 Start Adventure",1===c?" Solo":` (${o}/${c} Ready)`]}),!h&&it.jsx("div",{className:"flex-1 px-8 py-4 bg-blue-600/50 text-white rounded-xl font-bold text-lg text-center",children:"Waiting for host to start..."}),it.jsx("button",{onClick:a,className:"px-8 py-4 bg-gray-600 hover:bg-gray-700 text-white rounded-xl font-bold text-lg transition-all",children:"← Back to Lobby"})]}),it.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 gap-4",children:[it.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[it.jsx("h4",{className:"font-semibold mb-2",children:"💡 For Hosts"}),it.jsx("p",{className:"text-sm text-blue-200",children:"You can start the campaign anytime! Other players can join later using the campaign code, making it perfect for flexible scheduling."})]}),it.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[it.jsx("h4",{className:"font-semibold mb-2",children:"🎮 For Players"}),it.jsx("p",{className:"text-sm text-blue-200",children:"Even if the campaign has started, you can still join! Just use the campaign code and jump in when it's your turn or during a break in the action."})]})]})]})})};function ml(){const[e,t]=s.useState(null),[a,n]=s.useState(!1);s.useEffect(()=>{const e=m(Vs,e=>{t(e),n(!0)});return()=>e()},[]);return a?e?it.jsxs(Ws,{children:[it.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only absolute top-2 left-2 bg-blue-700 text-white px-4 py-2 rounded z-50",children:"Skip to main content"}),it.jsx(Ei,{children:it.jsxs(Ns,{children:[it.jsx(ws,{path:"/",element:it.jsx(vs,{to:"/dashboard",replace:!0})}),it.jsx(ws,{path:"/dashboard",element:it.jsx(pl,{user:e})}),it.jsx(ws,{path:"/game/*",element:it.jsx(xl,{user:e})}),it.jsx(ws,{path:"/automated-games",element:it.jsx(_i,{user:e})}),it.jsx(ws,{path:"/characters",element:it.jsx(gl,{user:e})}),it.jsx(ws,{path:"/characters/create",element:it.jsx(fl,{user:e})}),it.jsx(ws,{path:"/campaigns",element:it.jsx(bl,{user:e})}),it.jsx(ws,{path:"/campaigns/:id",element:it.jsx(yl,{user:e})}),it.jsx(ws,{path:"/campaigns/:id/waiting",element:it.jsx(vl,{user:e})}),it.jsx(ws,{path:"/party",element:it.jsx(wl,{user:e})}),it.jsx(ws,{path:"/world",element:it.jsx(jl,{user:e})}),it.jsx(ws,{path:"/combat",element:it.jsx(Nl,{user:e})}),it.jsx(ws,{path:"/magic",element:it.jsx(Sl,{user:e})}),it.jsx(ws,{path:"/dm-center",element:it.jsx(kl,{user:e})}),it.jsx(ws,{path:"/profile",element:it.jsx(Cl,{user:e})}),it.jsx(ws,{path:"/achievements",element:it.jsx(El,{user:e})}),it.jsx(ws,{path:"/settings",element:it.jsx(Pl,{user:e})}),it.jsx(ws,{path:"/help",element:it.jsx(Il,{user:e})}),it.jsx(ws,{path:"*",element:it.jsx(vs,{to:"/dashboard",replace:!0})})]})})]}):it.jsx(Vo,{onOpenAuth:async()=>{try{await Qs.signInWithGoogle()}catch(e){}}}):it.jsx(cl,{})}const pl=({user:e})=>{const t=cs(),[a,n]=s.useState([]),[r,i]=s.useState([]),[o,l]=s.useState(!1),[c,d]=s.useState(!1),[h,u]=s.useState(!1);return s.useEffect(()=>{const e=()=>{u(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),s.useEffect(()=>{(async()=>{try{const t=await Qs.getUserCampaigns(e.uid),s=await Qs.getUserCharacters(e.uid);n(t||[]),i(s||[])}catch(t){}})()},[e.uid]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 md:pb-0 pb-20",children:it.jsx(Ko,{user:e,campaigns:a,characters:r,onNavigate:e=>{t(e)},onCreateCampaign:()=>{t("/campaigns")},onCreateCharacter:()=>{t("/characters/create")},onJoinCampaign:()=>{t("/campaigns")},onResumeCampaign:e=>{t(`/campaigns/${e}`)},onOpenDiceRoller:()=>{l(!0)},onOpenProfile:()=>{t("/profile")},onOpenSettings:()=>{t("/settings")},onOpenAchievements:()=>{t("/achievements")},onOpenHelp:()=>{t("/help")}})}),it.jsx(rl,{onToggleDrawer:()=>d(!c),isDrawerOpen:c,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:h,hasNotifications:!1,notificationCount:0}),o&&it.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80",children:it.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[it.jsxs("div",{className:"flex justify-between items-center mb-4",children:[it.jsx("h2",{className:"text-2xl font-bold text-white",children:"Dice Roller"}),it.jsx("button",{onClick:()=>l(!1),className:"text-slate-400 hover:text-white",children:"✕"})]}),it.jsx(Xo,{isOpen:o,onClose:e=>{l(!1),e&&e.length},onRollComplete:e=>{}})]})})]})},xl=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto md:pb-0 pb-20",children:it.jsx(dl,{initialScreen:"game"})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},gl=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(Tl,{user:e})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},fl=({user:e})=>it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(dl,{initialScreen:"character"})})]}),bl=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(Al,{user:e})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},yl=({user:e})=>it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(dl,{initialScreen:"game"})})]}),vl=({user:e})=>it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(dl,{initialScreen:"waiting"})})]}),wl=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(Ml,{user:e})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},jl=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(dl,{initialScreen:"world"})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},Nl=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(dl,{initialScreen:"combat"})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},Sl=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(dl,{initialScreen:"magic"})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},kl=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(Dl,{user:e})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},Cl=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(Rl,{user:e})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},El=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(_l,{user:e})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},Pl=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(Ll,{user:e})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},Il=({user:e})=>{const t=cs(),[a,n]=s.useState(!1),[r,i]=s.useState(!1);return s.useEffect(()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),it.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsx(Zo,{user:e,onSignOut:()=>{}}),it.jsx("div",{className:"flex-1 overflow-auto",children:it.jsx(Ol,{user:e})}),it.jsx(rl,{onToggleDrawer:()=>n(!a),isDrawerOpen:a,onQuickAction:e=>{switch(e){case"chat":t("/game");break;case"party":t("/party");break;case"inventory":case"character":t("/characters");break;case"map":t("/world");break;case"settings":t("/settings")}},isMobile:r,hasNotifications:!1,notificationCount:0})]})},Tl=({user:e})=>{const t=cs(),[a,n]=s.useState([]),[r,i]=s.useState(!0),[o,l]=s.useState(!1),[c,d]=s.useState(null),[h,u]=s.useState(!1);s.useEffect(()=>{(async()=>{try{const t=await Qs.getUserCharacters(e.uid);n(t||[])}catch(t){const e=JSON.parse(localStorage.getItem("mythseeker_characters")||"[]");n(e)}finally{i(!1)}})()},[e.uid]);return r?it.jsx("div",{className:"flex-1 flex items-center justify-center",children:it.jsxs("div",{className:"text-center space-y-4",children:[it.jsx("div",{className:"w-8 h-8 border-4 border-blue-300/30 border-t-blue-400 rounded-full animate-spin mx-auto"}),it.jsx("p",{className:"text-blue-200",children:"Loading characters..."})]})}):o?it.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:it.jsxs("div",{className:"max-w-4xl mx-auto",children:[it.jsxs("div",{className:"mb-6",children:[it.jsxs("button",{onClick:()=>l(!1),className:"text-blue-400 hover:text-blue-300 flex items-center space-x-2 mb-4",children:[it.jsx(Be,{className:"w-4 h-4"}),it.jsx("span",{children:"Back to Characters"})]}),it.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Create Character"}),it.jsx("p",{className:"text-blue-200",children:"Forge your hero and begin your adventure"})]}),it.jsx(hl,{playerName:(null==e?void 0:e.displayName)||"Adventurer",classes:[{name:"Warrior",description:"Mighty fighter with heavy armor and weapons",icon:"⚔️",stats:{strength:16,dexterity:12,intelligence:10,charisma:8}},{name:"Rogue",description:"Stealthy assassin and thief",icon:"🗡️",stats:{strength:10,dexterity:16,intelligence:12,charisma:8}},{name:"Mage",description:"Powerful spellcaster with arcane magic",icon:"🔮",stats:{strength:8,dexterity:10,intelligence:16,charisma:12}},{name:"Cleric",description:"Divine healer and protector",icon:"⚡",stats:{strength:12,dexterity:8,intelligence:12,charisma:16}},{name:"Ranger",description:"Skilled archer and wilderness expert",icon:"🏹",stats:{strength:14,dexterity:14,intelligence:10,charisma:8}},{name:"Bard",description:"Charismatic performer who uses music and magic",icon:"🎵",stats:{strength:8,dexterity:12,intelligence:10,charisma:16}},{name:"Druid",description:"Nature-wielding shapeshifter and spellcaster",icon:"🌿",stats:{strength:10,dexterity:12,intelligence:14,charisma:10}},{name:"Monk",description:"Martial artist with supernatural abilities",icon:"🥋",stats:{strength:12,dexterity:16,intelligence:10,charisma:8}},{name:"Barbarian",description:"Fierce warrior who channels primal rage",icon:"🪓",stats:{strength:16,dexterity:14,intelligence:8,charisma:10}},{name:"Sorcerer",description:"Natural-born spellcaster with innate magic",icon:"✨",stats:{strength:8,dexterity:10,intelligence:12,charisma:16}},{name:"Warlock",description:"Pact-bound spellcaster with otherworldly powers",icon:"👹",stats:{strength:10,dexterity:12,intelligence:10,charisma:16}},{name:"Artificer",description:"Magical inventor and technological innovator",icon:"⚙️",stats:{strength:10,dexterity:12,intelligence:16,charisma:8}},{name:"Necromancer",description:"Master of death magic and undead minions",icon:"💀",stats:{strength:8,dexterity:10,intelligence:16,charisma:12}},{name:"Paladin",description:"Holy warrior with divine powers",icon:"🛡️",stats:{strength:14,dexterity:10,intelligence:8,charisma:14}}],onCreateCharacter:t=>{const s={...t,id:Date.now().toString(),createdAt:(new Date).toISOString(),lastPlayed:(new Date).toISOString(),experience:0,level:1,health:100,maxHealth:100,mana:50,maxMana:50,inventory:[],equipment:{},spells:[],abilities:[],status:"active"};if(n(e=>[...e,s]),l(!1),e)Qs.saveCharacter(e.uid,s);else{const e=JSON.parse(localStorage.getItem("mythseeker_characters")||"[]");e.push(s),localStorage.setItem("mythseeker_characters",JSON.stringify(e))}},joinCode:""})]})}):h&&c?it.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:it.jsxs("div",{className:"max-w-4xl mx-auto",children:[it.jsxs("div",{className:"mb-6",children:[it.jsxs("button",{onClick:()=>u(!1),className:"text-blue-400 hover:text-blue-300 flex items-center space-x-2 mb-4",children:[it.jsx(Be,{className:"w-4 h-4"}),it.jsx("span",{children:"Back to Characters"})]}),it.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Character Sheet"}),it.jsx("p",{className:"text-blue-200",children:"Manage your character's details and progression"})]}),it.jsx(el,{character:c,onSave:e=>{n(t=>t.map(t=>t.id===e.id?e:t)),u(!1)},onClose:()=>u(!1)})]})}):it.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:it.jsxs("div",{className:"max-w-6xl mx-auto",children:[it.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[it.jsxs("div",{children:[it.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Characters"}),it.jsx("p",{className:"text-blue-200",children:"Manage your heroes and companions"})]}),it.jsxs("button",{onClick:()=>l(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors flex items-center space-x-2",children:[it.jsx(Pe,{className:"w-5 h-5"}),it.jsx("span",{children:"Create Character"})]})]}),0===a.length?it.jsxs("div",{className:"text-center py-12",children:[it.jsx("div",{className:"w-24 h-24 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-4",children:it.jsx(ve,{className:"w-12 h-12 text-slate-400"})}),it.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Characters Yet"}),it.jsx("p",{className:"text-blue-200 mb-6",children:"Create your first character to begin your adventure"}),it.jsx("button",{onClick:()=>l(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Create Character"})]}):it.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(s=>{var a;return it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50 hover:border-blue-500/50 transition-colors",children:[it.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[it.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:it.jsx("span",{className:"text-white font-bold text-lg",children:null==(a=s.name)?void 0:a.charAt(0)})}),it.jsxs("div",{className:"flex-1",children:[it.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),it.jsx("p",{className:"text-blue-200 text-sm",children:s.class})]}),it.jsx("button",{onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this character? This action cannot be undone."))if(n(e=>e.filter(e=>e.id!==t)),e)try{await Qs.deleteCharacter(e.uid,t)}catch(s){}else{const e=JSON.parse(localStorage.getItem("mythseeker_characters")||"[]").filter(e=>e.id!==t);localStorage.setItem("mythseeker_characters",JSON.stringify(e))}})(s.id),className:"text-slate-400 hover:text-red-400 transition-colors p-1",title:"Delete character",children:it.jsx(qe,{className:"w-4 h-4"})})]}),it.jsxs("div",{className:"space-y-2 text-sm mb-4",children:[it.jsxs("div",{className:"flex justify-between",children:[it.jsx("span",{className:"text-slate-400",children:"Level"}),it.jsx("span",{className:"text-white",children:s.level||1})]}),it.jsxs("div",{className:"flex justify-between",children:[it.jsx("span",{className:"text-slate-400",children:"XP"}),it.jsx("span",{className:"text-white",children:s.experience||0})]}),it.jsxs("div",{className:"flex justify-between",children:[it.jsx("span",{className:"text-slate-400",children:"Health"}),it.jsxs("span",{className:"text-white",children:[s.health||100,"/",s.maxHealth||100]})]}),it.jsxs("div",{className:"flex justify-between",children:[it.jsx("span",{className:"text-slate-400",children:"Last Played"}),it.jsx("span",{className:"text-white text-xs",children:s.lastPlayed?new Date(s.lastPlayed).toLocaleDateString():"Never"})]})]}),it.jsxs("div",{className:"flex space-x-2",children:[it.jsx("button",{onClick:()=>(e=>{d(e),t("/campaigns")})(s),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded text-sm font-medium transition-colors",children:"Play"}),it.jsx("button",{onClick:()=>(e=>{d(e),u(!0)})(s),className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white px-3 py-2 rounded text-sm font-medium transition-colors",children:"Edit"})]})]},s.id)})})]})})},Al=({user:e})=>{const t=cs(),[a,n]=s.useState([]),[r,i]=s.useState(!0),[o,l]=s.useState(!1),[c,d]=s.useState(!1);s.useState(null);const[h,u]=s.useState(""),m=[{name:"Classic Fantasy",description:"Dragons, magic, and heroic quests in a medieval world",icon:"🏰",bg:"fantasy"},{name:"Sci-Fi Adventure",description:"Space exploration, alien encounters, and futuristic technology",icon:"🚀",bg:"scifi"},{name:"Horror Mystery",description:"Dark secrets, supernatural threats, and psychological tension",icon:"👻",bg:"horror"},{name:"Urban Fantasy",description:"Magic hidden in the modern world, supernatural creatures in cities",icon:"🌃",bg:"urban"},{name:"Post-Apocalyptic",description:"Surviving in a world after civilization has collapsed",icon:"☢️",bg:"apocalypse"},{name:"Pirate Adventure",description:"High seas, treasure hunting, and swashbuckling action",icon:"🏴‍☠️",bg:"pirate"}];s.useEffect(()=>{p()},[]);const p=async()=>{try{i(!0);const t=(await Qs.getUserCampaigns(e.uid)).map(e=>({id:e.id,theme:e.theme,description:`${e.theme} campaign`,status:e.started?"active":"paused",players:e.players||[],joinCode:e.code,createdAt:e.createdAt,customPrompt:e.customPrompt||""}));n(t||[])}catch(t){}finally{i(!1)}},x=e=>{switch(e.status){case"active":return"🟢";case"paused":return"🟡";case"completed":return"🏁";default:return"⚪"}},g=e=>{switch(e.status){case"active":return"text-green-400";case"paused":return"text-yellow-400";case"completed":return"text-blue-400";default:return"text-gray-400"}},f={total:a.length,active:a.filter(e=>"active"===e.status).length,paused:a.filter(e=>"paused"===e.status).length,completed:a.filter(e=>"completed"===e.status).length};return r?it.jsx("div",{className:"flex-1 flex items-center justify-center",children:it.jsxs("div",{className:"text-center space-y-4",children:[it.jsx("div",{className:"w-12 h-12 border-4 border-blue-300/30 border-t-blue-400 rounded-full animate-spin mx-auto"}),it.jsx("p",{className:"text-blue-200",children:"Loading campaigns..."})]})}):it.jsxs("div",{className:"flex-1 overflow-auto bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[it.jsxs("div",{className:"p-6 space-y-6",children:[it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Campaigns"}),it.jsx("p",{className:"text-blue-200",children:"Manage your adventures and join new campaigns"})]}),it.jsxs("div",{className:"flex space-x-3",children:[it.jsxs("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center space-x-2 transition-colors",children:[it.jsx("span",{children:"🔗"}),it.jsx("span",{children:"Join Campaign"})]}),it.jsxs("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center space-x-2 transition-colors",children:[it.jsx("span",{children:"➕"}),it.jsx("span",{children:"Create Campaign"})]})]})]}),it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[it.jsx("div",{className:"bg-blue-900/50 backdrop-blur-sm rounded-lg p-4 border border-blue-700/50",children:it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("p",{className:"text-blue-200 text-sm",children:"Total Campaigns"}),it.jsx("p",{className:"text-2xl font-bold text-white",children:f.total})]}),it.jsx("div",{className:"text-3xl",children:"📚"})]})}),it.jsx("div",{className:"bg-green-900/50 backdrop-blur-sm rounded-lg p-4 border border-green-700/50",children:it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("p",{className:"text-green-200 text-sm",children:"Active"}),it.jsx("p",{className:"text-2xl font-bold text-white",children:f.active})]}),it.jsx("div",{className:"text-3xl",children:"🟢"})]})}),it.jsx("div",{className:"bg-yellow-900/50 backdrop-blur-sm rounded-lg p-4 border border-yellow-700/50",children:it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("p",{className:"text-yellow-200 text-sm",children:"Paused"}),it.jsx("p",{className:"text-2xl font-bold text-white",children:f.paused})]}),it.jsx("div",{className:"text-3xl",children:"🟡"})]})}),it.jsx("div",{className:"bg-purple-900/50 backdrop-blur-sm rounded-lg p-4 border border-purple-700/50",children:it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("p",{className:"text-purple-200 text-sm",children:"Completed"}),it.jsx("p",{className:"text-2xl font-bold text-white",children:f.completed})]}),it.jsx("div",{className:"text-3xl",children:"🏁"})]})})]}),it.jsxs("div",{className:"space-y-4",children:[it.jsx("h2",{className:"text-xl font-semibold text-white",children:"Your Campaigns"}),0===a.length?it.jsxs("div",{className:"text-center py-12",children:[it.jsx("div",{className:"text-6xl mb-4",children:"📚"}),it.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No campaigns yet"}),it.jsx("p",{className:"text-blue-200 mb-6",children:"Create your first campaign or join an existing one to start your adventure!"}),it.jsxs("div",{className:"flex justify-center space-x-4",children:[it.jsxs("button",{onClick:()=>l(!0),className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center space-x-2 transition-colors",children:[it.jsx("span",{children:"➕"}),it.jsx("span",{children:"Create Campaign"})]}),it.jsxs("button",{onClick:()=>d(!0),className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center space-x-2 transition-colors",children:[it.jsx("span",{children:"🔗"}),it.jsx("span",{children:"Join Campaign"})]})]})]}):it.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:a.map(e=>{var s,a;return it.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-lg p-6 border border-slate-700/50 hover:border-blue-500/50 transition-all hover:shadow-lg hover:shadow-blue-500/20",children:[it.jsxs("div",{className:"flex items-start justify-between mb-4",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("span",{className:"text-2xl",children:(null==(s=m.find(t=>t.name===e.theme))?void 0:s.icon)||"📚"}),it.jsxs("div",{children:[it.jsx("h3",{className:"text-lg font-semibold text-white",children:e.theme}),it.jsx("p",{className:"text-sm text-blue-200",children:e.description})]})]}),it.jsx("div",{className:`text-lg ${g(e)}`,children:x(e)})]}),it.jsxs("div",{className:"space-y-3 mb-4",children:[it.jsxs("div",{className:"flex items-center justify-between text-sm",children:[it.jsx("span",{className:"text-gray-300",children:"Status:"}),it.jsx("span",{className:`font-medium ${g(e)}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),it.jsxs("div",{className:"flex items-center justify-between text-sm",children:[it.jsx("span",{className:"text-gray-300",children:"Players:"}),it.jsx("span",{className:"text-white",children:(null==(a=e.players)?void 0:a.length)||1})]}),it.jsxs("div",{className:"flex items-center justify-between text-sm",children:[it.jsx("span",{className:"text-gray-300",children:"Join Code:"}),it.jsx("span",{className:"text-white font-mono",children:e.joinCode})]}),it.jsxs("div",{className:"flex items-center justify-between text-sm",children:[it.jsx("span",{className:"text-gray-300",children:"Created:"}),it.jsx("span",{className:"text-white",children:new Date(e.createdAt).toLocaleDateString()})]})]}),it.jsxs("div",{className:"flex space-x-2",children:["active"===e.status&&it.jsx("button",{onClick:()=>window.location.href=`/campaigns/${e.id}`,className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm transition-colors",children:"Continue"}),"paused"===e.status&&it.jsx("button",{onClick:()=>(async e=>{try{t("/game",{state:{campaignId:e}})}catch(s){}})(e.id),className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded text-sm transition-colors",children:"Resume"}),"active"===e.status&&it.jsx("button",{onClick:()=>(async e=>{try{n(t=>t.map(t=>t.id===e?{...t,status:"paused"}:t))}catch(t){}})(e.id),className:"px-3 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded text-sm transition-colors",children:"Pause"}),it.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this campaign? This action cannot be undone."))try{n(t=>t.filter(t=>t.id!==e))}catch(t){}})(e.id),className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded text-sm transition-colors",children:"Delete"})]})]},e.id)})})]})]}),o&&it.jsx(tl,{user:e,onClose:()=>l(!1),onCampaignCreated:async(e,s)=>{await p(),l(!1),t("/game",{state:{campaignId:e,joinCode:s}})}}),c&&it.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:it.jsxs("div",{className:"bg-slate-800 rounded-lg p-6 w-full max-w-md space-y-4",children:[it.jsx("h3",{className:"text-xl font-semibold text-white",children:"Join Campaign"}),it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-blue-200 mb-2",children:"Campaign Join Code"}),it.jsx("input",{type:"text",value:h,onChange:e=>u(e.target.value.toUpperCase()),placeholder:"Enter 6-character code",className:"w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",maxLength:6})]}),it.jsxs("div",{className:"flex space-x-3",children:[it.jsx("button",{onClick:()=>d(!1),className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors",children:"Cancel"}),it.jsx("button",{onClick:async()=>{if(h.trim())try{const s=await Qs.getUserCharacters(e.uid);if(!s||0===s.length)return alert("You need to create a character first before joining a campaign."),void t("/characters");const{gameId:a,gameData:n}=await Qs.joinGameSession(h.trim(),s[0].id);await p(),d(!1),u(""),t("/game",{state:{campaignId:a,joinCode:h.trim()}})}catch(s){alert("Failed to join campaign. Please check the join code and try again.")}},disabled:!h.trim(),className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white rounded transition-colors",children:"Join Campaign"})]})]})})]})},Ml=({user:e})=>{var t,a,n,r;const i=cs(),[o,l]=s.useState([]),[c,d]=s.useState([]),[h,u]=s.useState(!0),[m,p]=s.useState(!1),[x,g]=s.useState(!1),[f,b]=s.useState(""),[y,v]=s.useState(""),[w,j]=s.useState(null),[N,S]=s.useState(!1);s.useEffect(()=>{(async()=>{try{const t=JSON.parse(localStorage.getItem(`mythseeker_party_${e.uid}`)||"[]");l(t);const s=JSON.parse(localStorage.getItem(`mythseeker_invites_${e.uid}`)||"[]");d(s)}catch(t){}finally{u(!1)}})()},[e.uid]);const k=()=>{(()=>{const e=Math.random().toString(36).substr(2,6).toUpperCase();b(e)})(),p(!0)},C=t=>{const s=o.filter(e=>e.id!==t);l(s),localStorage.setItem(`mythseeker_party_${e.uid}`,JSON.stringify(s))},E=e=>{switch(null==e?void 0:e.toLowerCase()){case"warrior":return"⚔️";case"rogue":return"🗡️";case"mage":return"🔮";case"cleric":return"⚡";case"ranger":return"🏹";case"bard":return"🎵";default:return"👤"}};return h?it.jsx("div",{className:"flex-1 flex items-center justify-center",children:it.jsxs("div",{className:"text-center space-y-4",children:[it.jsx("div",{className:"w-8 h-8 border-4 border-blue-300/30 border-t-blue-400 rounded-full animate-spin mx-auto"}),it.jsx("p",{className:"text-blue-200",children:"Loading party data..."})]})}):it.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[it.jsxs("div",{className:"max-w-6xl mx-auto",children:[it.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[it.jsxs("div",{children:[it.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Party"}),it.jsx("p",{className:"text-blue-200",children:"Manage your adventuring companions and friends"})]}),it.jsxs("div",{className:"flex space-x-3",children:[it.jsx("button",{onClick:()=>g(!0),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Join Party"}),it.jsx("button",{onClick:k,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Invite Friend"})]})]}),it.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[it.jsx("div",{className:"lg:col-span-2",children:it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50",children:[it.jsxs("div",{className:"flex justify-between items-center mb-6",children:[it.jsxs("h3",{className:"text-xl font-semibold text-white",children:["Party Members (",o.length,")"]}),it.jsx("button",{onClick:k,className:"bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm transition-colors",children:"+ Add Member"})]}),0===o.length?it.jsxs("div",{className:"text-center py-12",children:[it.jsx("div",{className:"w-16 h-16 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-4",children:it.jsx(te,{className:"w-8 h-8 text-slate-400"})}),it.jsx("p",{className:"text-blue-200 mb-2",children:"No party members yet"}),it.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Invite friends to start your adventuring party"}),it.jsx("button",{onClick:k,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded font-medium transition-colors",children:"Invite First Member"})]}):it.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map(e=>{var t,s,a,n;return it.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4 hover:bg-slate-700/50 transition-colors",children:[it.jsxs("div",{className:"flex items-start justify-between mb-3",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:it.jsx("span",{className:"text-white text-lg",children:E(null==(t=e.character)?void 0:t.class)})}),it.jsxs("div",{children:[it.jsx("h4",{className:"text-white font-medium",children:e.name}),it.jsxs("p",{className:"text-blue-200 text-sm",children:[null==(s=e.character)?void 0:s.name," • Level ",null==(a=e.character)?void 0:a.level," ",null==(n=e.character)?void 0:n.class]})]})]}),it.jsxs("div",{className:"flex items-center space-x-2",children:[it.jsx("div",{className:"w-2 h-2 rounded-full "+(e.isOnline?"bg-green-400":"bg-slate-400")}),it.jsx("button",{onClick:()=>{j(e),S(!0)},className:"text-slate-400 hover:text-white",children:it.jsx(Je,{className:"w-4 h-4"})})]})]}),e.notes&&it.jsxs("p",{className:"text-slate-300 text-sm mb-3 italic",children:['"',e.notes,'"']}),it.jsxs("div",{className:"flex justify-between items-center text-xs text-slate-400",children:[it.jsxs("span",{children:["Joined ",new Date(e.joinedAt).toLocaleDateString()]}),it.jsx("button",{onClick:()=>C(e.id),className:"text-red-400 hover:text-red-300 transition-colors",children:"Remove"})]})]},e.id)})})]})}),it.jsxs("div",{className:"space-y-6",children:[it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Pending Invites"}),c.length>0?it.jsx("div",{className:"space-y-3",children:c.map(t=>it.jsxs("div",{className:"p-3 bg-slate-700/30 rounded",children:[it.jsxs("div",{className:"flex justify-between items-start mb-2",children:[it.jsxs("div",{children:[it.jsx("p",{className:"text-white font-medium",children:t.hostName}),it.jsx("p",{className:"text-blue-200 text-sm",children:t.partyName})]}),it.jsx("span",{className:"text-slate-400 text-xs",children:new Date(t.timestamp).toLocaleDateString()})]}),it.jsxs("div",{className:"flex space-x-2",children:[it.jsx("button",{onClick:()=>(e=>{v(e.code),g(!0)})(t),className:"flex-1 bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm transition-colors",children:"Accept"}),it.jsx("button",{onClick:()=>(t=>{const s=c.filter(e=>e.id!==t);d(s),localStorage.setItem(`mythseeker_invites_${e.uid}`,JSON.stringify(s))})(t.id),className:"flex-1 bg-slate-600 hover:bg-slate-500 text-white px-3 py-1 rounded text-sm transition-colors",children:"Decline"})]})]},t.id))}):it.jsx("div",{className:"text-center py-4",children:it.jsx("p",{className:"text-slate-400 text-sm",children:"No pending invites"})})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Party Stats"}),it.jsxs("div",{className:"space-y-3",children:[it.jsxs("div",{className:"flex justify-between",children:[it.jsx("span",{className:"text-slate-300",children:"Total Members"}),it.jsx("span",{className:"text-white font-semibold",children:o.length})]}),it.jsxs("div",{className:"flex justify-between",children:[it.jsx("span",{className:"text-slate-300",children:"Online Now"}),it.jsx("span",{className:"text-white font-semibold",children:o.filter(e=>e.isOnline).length})]}),it.jsxs("div",{className:"flex justify-between",children:[it.jsx("span",{className:"text-slate-300",children:"Average Level"}),it.jsx("span",{className:"text-white font-semibold",children:o.length>0?Math.round(o.reduce((e,t)=>{var s;return e+((null==(s=t.character)?void 0:s.level)||1)},0)/o.length):0})]})]})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),it.jsxs("div",{className:"space-y-3",children:[it.jsxs("button",{onClick:()=>i("/game"),className:"w-full flex items-center justify-between p-3 bg-slate-700/30 rounded-lg hover:bg-slate-700/50 transition-colors",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx(ie,{className:"w-4 h-4 text-green-400"}),it.jsx("span",{className:"text-sm",children:"Start Adventure"})]}),it.jsx(ge,{className:"w-4 h-4 text-slate-400"})]}),it.jsxs("button",{onClick:()=>i("/characters"),className:"w-full flex items-center justify-between p-3 bg-slate-700/30 rounded-lg hover:bg-slate-700/50 transition-colors",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx(ve,{className:"w-4 h-4 text-blue-400"}),it.jsx("span",{className:"text-sm",children:"Manage Characters"})]}),it.jsx(ge,{className:"w-4 h-4 text-slate-400"})]}),it.jsxs("button",{onClick:()=>i("/campaigns"),className:"w-full flex items-center justify-between p-3 bg-slate-700/30 rounded-lg hover:bg-slate-700/50 transition-colors",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx(be,{className:"w-4 h-4 text-purple-400"}),it.jsx("span",{className:"text-sm",children:"View Campaigns"})]}),it.jsx(ge,{className:"w-4 h-4 text-slate-400"})]})]})]})]})]})]}),m&&it.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80",children:it.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full mx-4",children:[it.jsxs("div",{className:"flex justify-between items-center mb-4",children:[it.jsx("h2",{className:"text-xl font-bold text-white",children:"Invite Friend"}),it.jsx("button",{onClick:()=>p(!1),className:"text-slate-400 hover:text-white",children:"✕"})]}),it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Invite Code"}),it.jsxs("div",{className:"flex space-x-2",children:[it.jsx("input",{type:"text",value:f,readOnly:!0,className:"flex-1 px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600"}),it.jsx("button",{onClick:()=>{navigator.clipboard.writeText(f),alert("Invite code copied to clipboard!")},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Copy"})]}),it.jsx("p",{className:"text-slate-400 text-xs mt-2",children:"Share this code with your friend to invite them to your party"})]}),it.jsx("div",{className:"flex space-x-3",children:it.jsx("button",{onClick:()=>p(!1),className:"flex-1 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:"Close"})})]})]})}),x&&it.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80",children:it.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full mx-4",children:[it.jsxs("div",{className:"flex justify-between items-center mb-4",children:[it.jsx("h2",{className:"text-xl font-bold text-white",children:"Join Party"}),it.jsx("button",{onClick:()=>g(!1),className:"text-slate-400 hover:text-white",children:"✕"})]}),it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Invite Code"}),it.jsx("input",{type:"text",value:y,onChange:e=>v(e.target.value.toUpperCase()),placeholder:"Enter 6-character code",maxLength:6,className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400"})]}),it.jsxs("div",{className:"flex space-x-3",children:[it.jsx("button",{onClick:()=>g(!1),className:"flex-1 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:"Cancel"}),it.jsx("button",{onClick:async()=>{if(y.trim())try{const t={id:Date.now().toString(),name:e.displayName||"Adventurer",email:e.email,character:{name:"Your Character",class:"Adventurer",level:1},joinedAt:(new Date).toISOString(),notes:"",isOnline:!0},s=[...o,t];l(s),localStorage.setItem(`mythseeker_party_${e.uid}`,JSON.stringify(s)),g(!1),v(""),alert("Successfully joined the party!")}catch(t){alert("Failed to join party. Please check the code and try again.")}},disabled:!y.trim(),className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-slate-600 text-white rounded-lg transition-colors",children:"Join Party"})]})]})]})}),N&&w&&it.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80",children:it.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full mx-4",children:[it.jsxs("div",{className:"flex justify-between items-center mb-4",children:[it.jsx("h2",{className:"text-xl font-bold text-white",children:"Party Member"}),it.jsx("button",{onClick:()=>S(!1),className:"text-slate-400 hover:text-white",children:"✕"})]}),it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:it.jsx("span",{className:"text-white text-xl",children:E(null==(t=w.character)?void 0:t.class)})}),it.jsxs("div",{children:[it.jsx("h3",{className:"text-white font-medium",children:w.name}),it.jsxs("p",{className:"text-blue-200 text-sm",children:[null==(a=w.character)?void 0:a.name," • Level ",null==(n=w.character)?void 0:n.level," ",null==(r=w.character)?void 0:r.class]})]})]}),it.jsxs("div",{children:[it.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notes"}),it.jsx("textarea",{value:w.notes||"",onChange:t=>((t,s)=>{const a=o.map(e=>e.id===t?{...e,notes:s}:e);l(a),localStorage.setItem(`mythseeker_party_${e.uid}`,JSON.stringify(a))})(w.id,t.target.value),placeholder:"Add notes about this party member...",rows:3,className:"w-full px-3 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:outline-none focus:border-blue-400"})]}),it.jsxs("div",{className:"text-sm text-slate-400",children:[it.jsxs("p",{children:["Joined: ",new Date(w.joinedAt).toLocaleDateString()]}),it.jsxs("p",{children:["Status: ",w.isOnline?"Online":"Offline"]})]}),it.jsxs("div",{className:"flex space-x-3",children:[it.jsx("button",{onClick:()=>S(!1),className:"flex-1 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:"Close"}),it.jsx("button",{onClick:()=>{C(w.id),S(!1)},className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Remove from Party"})]})]})]})})]})},Dl=({user:e})=>{cs();const[t,a]=s.useState({aiSettings:{dmStyle:"balanced",difficulty:6,descriptionLength:"detailed",improvisationLevel:7,npcComplexity:"detailed",conflictFrequency:5,continuityStrictness:"moderate",worldReactivity:8},dmPersona:{tone:"friendly",humor_level:"medium",descriptiveness:"moderate",challenge_level:"moderate",narrative_focus:"balanced",improvisation_style:"moderate"},aiTraining:{learningEnabled:!0,feedbackCollection:!0,personalityAdaptation:!0,memoryRetention:30,contextWindow:10,longTermMemory:!0,emotionalMemory:!0,crossCampaignLearning:!1}}),[n,r]=s.useState(null),[i,o]=s.useState(!0);return s.useEffect(()=>{(async()=>{try{const t=await Qs.getUserCampaigns(e.uid);t&&t.length>0&&r(t[0]);const s=localStorage.getItem(`mythseeker_dmcenter_${e.uid}`);s&&a(JSON.parse(s))}catch(t){}finally{o(!1)}})()},[e.uid]),i?it.jsx("div",{className:"flex-1 flex items-center justify-center",children:it.jsxs("div",{className:"text-center space-y-4",children:[it.jsx("div",{className:"w-8 h-8 border-4 border-blue-300/30 border-t-blue-400 rounded-full animate-spin mx-auto"}),it.jsx("p",{className:"text-blue-200",children:"Loading DM Center..."})]})}):it.jsx("div",{className:"flex-1 overflow-y-auto",children:it.jsx(ll,{dmCenterData:t,onUpdateDMCenter:t=>{a(t),localStorage.setItem(`mythseeker_dmcenter_${e.uid}`,JSON.stringify(t))},currentCampaign:n})})},Rl=({user:e})=>{var t;return it.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:it.jsxs("div",{className:"max-w-4xl mx-auto",children:[it.jsxs("div",{className:"mb-8",children:[it.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Profile"}),it.jsx("p",{className:"text-blue-200",children:"Your account settings and preferences"})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50",children:[it.jsxs("div",{className:"flex items-center space-x-6 mb-8",children:[it.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center",children:(null==e?void 0:e.photoURL)?it.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-20 h-20 rounded-full"}):it.jsx(ve,{className:"w-10 h-10 text-white"})}),it.jsxs("div",{children:[it.jsx("h2",{className:"text-2xl font-bold text-white",children:(null==e?void 0:e.displayName)||"Adventurer"}),it.jsx("p",{className:"text-blue-200",children:null==e?void 0:e.email}),it.jsxs("p",{className:"text-slate-400 text-sm",children:["Member since ",(null==(t=null==e?void 0:e.metadata)?void 0:t.creationTime)?new Date(e.metadata.creationTime).toLocaleDateString():"Unknown"]})]})]}),it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[it.jsxs("div",{children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Account Settings"}),it.jsxs("div",{className:"space-y-3",children:[it.jsx("button",{className:"w-full text-left p-3 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition-colors",children:it.jsx("span",{className:"text-white",children:"Edit Profile"})}),it.jsx("button",{className:"w-full text-left p-3 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition-colors",children:it.jsx("span",{className:"text-white",children:"Change Password"})}),it.jsx("button",{className:"w-full text-left p-3 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition-colors",children:it.jsx("span",{className:"text-white",children:"Privacy Settings"})})]})]}),it.jsxs("div",{children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Game Statistics"}),it.jsxs("div",{className:"space-y-3",children:[it.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg",children:[it.jsx("span",{className:"text-slate-400 text-sm",children:"Campaigns Played"}),it.jsx("p",{className:"text-white font-semibold",children:"0"})]}),it.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg",children:[it.jsx("span",{className:"text-slate-400 text-sm",children:"Characters Created"}),it.jsx("p",{className:"text-white font-semibold",children:"0"})]}),it.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg",children:[it.jsx("span",{className:"text-slate-400 text-sm",children:"Total Play Time"}),it.jsx("p",{className:"text-white font-semibold",children:"0 hours"})]})]})]})]})]})]})})},_l=({user:e})=>{const[t,a]=s.useState([]),[n,r]=s.useState([]),[i,o]=s.useState([]),[l,c]=s.useState({}),[d,h]=s.useState(!0);s.useEffect(()=>{(async()=>{try{const t=await Qs.getUserCharacters(e.uid);a(t||[]);const s=await Qs.getUserCampaigns(e.uid);r(s||[]);const n=JSON.parse(localStorage.getItem("mythseeker_game_stats")||"{}");c(n);const i=JSON.parse(localStorage.getItem("mythseeker_achievements")||"[]");o(i)}catch(t){}finally{h(!1)}})()},[e.uid]);const u=[{id:"first_character",title:"First Steps",description:"Create your first character",icon:it.jsx(ve,{className:"w-8 h-8"}),color:"from-blue-500 to-cyan-500"},{id:"first_campaign",title:"Adventure Begins",description:"Start your first campaign",icon:it.jsx(be,{className:"w-8 h-8"}),color:"from-green-500 to-emerald-500"},{id:"first_combat_win",title:"Warrior",description:"Win your first combat",icon:it.jsx(ie,{className:"w-8 h-8"}),color:"from-red-500 to-pink-500"},{id:"character_level_5",title:"Experienced Hero",description:"Reach level 5 with any character",icon:it.jsx(ee,{className:"w-8 h-8"}),color:"from-purple-500 to-indigo-500"},{id:"complete_campaign",title:"Storyteller",description:"Complete a campaign",icon:it.jsx(ae,{className:"w-8 h-8"}),color:"from-yellow-500 to-orange-500"},{id:"multiplayer_party",title:"Party Leader",description:"Play in a multiplayer campaign",icon:it.jsx(te,{className:"w-8 h-8"}),color:"from-indigo-500 to-purple-500"}];return d?it.jsx("div",{className:"flex-1 flex items-center justify-center",children:it.jsxs("div",{className:"text-center space-y-4",children:[it.jsx("div",{className:"w-8 h-8 border-4 border-blue-300/30 border-t-blue-400 rounded-full animate-spin mx-auto"}),it.jsx("p",{className:"text-blue-200",children:"Loading achievements..."})]})}):it.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:it.jsxs("div",{className:"max-w-6xl mx-auto",children:[it.jsxs("div",{className:"mb-8",children:[it.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Achievements"}),it.jsx("p",{className:"text-blue-200",children:"Track your progress and accomplishments"})]}),it.jsxs("div",{className:"mb-8 grid grid-cols-1 md:grid-cols-4 gap-4",children:[it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700/50 text-center",children:[it.jsx("div",{className:"text-2xl font-bold text-white",children:i.length}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Achievements Unlocked"})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700/50 text-center",children:[it.jsx("div",{className:"text-2xl font-bold text-white",children:t.length}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Characters Created"})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700/50 text-center",children:[it.jsx("div",{className:"text-2xl font-bold text-white",children:n.length}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Campaigns Started"})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700/50 text-center",children:[it.jsx("div",{className:"text-2xl font-bold text-white",children:l.combatsWon||0}),it.jsx("div",{className:"text-blue-200 text-sm",children:"Combats Won"})]})]}),it.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(e=>{const s=(e=>{switch(e){case"first_character":return t.length>0?100:0;case"first_campaign":return n.length>0?100:0;case"first_combat_win":return l.combatsWon>0?100:0;case"character_level_5":return t.some(e=>e.level>=5)?100:0;case"complete_campaign":return n.some(e=>"completed"===e.status)?100:0;case"multiplayer_party":return n.some(e=>{var t;return e.isMultiplayer&&(null==(t=e.players)?void 0:t.length)>1})?100:0;default:return 0}})(e.id),a=(r=e.id,i.some(e=>e.id===r));var r;return it.jsx("div",{className:"bg-slate-800/50 rounded-lg p-6 border transition-all duration-300 "+(a?"border-yellow-500/50 shadow-lg shadow-yellow-500/20":"border-slate-700/50"),children:it.jsxs("div",{className:"text-center",children:[it.jsx("div",{className:`w-16 h-16 bg-gradient-to-br ${e.color} rounded-full flex items-center justify-center mx-auto mb-4 ${a?"animate-pulse":"opacity-50"}`,children:it.jsx("div",{className:"text-white",children:e.icon})}),it.jsx("h3",{className:"text-lg font-semibold mb-2 "+(a?"text-white":"text-slate-400"),children:e.title}),it.jsx("p",{className:"text-blue-200 text-sm mb-4",children:e.description}),it.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2 mb-2",children:it.jsx("div",{className:"h-2 rounded-full transition-all duration-500 "+(a?"bg-gradient-to-r from-yellow-400 to-orange-500":"bg-blue-600"),style:{width:`${s}%`}})}),it.jsx("p",{className:"text-xs "+(a?"text-yellow-400":"text-slate-400"),children:a?"Unlocked!":`${s}% Complete`})]})},e.id)})}),i.length>0&&it.jsxs("div",{className:"mt-8",children:[it.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Recent Achievements"}),it.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.slice(0,3).map(e=>it.jsx("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-yellow-500/30",children:it.jsxs("div",{className:"flex items-center space-x-3",children:[it.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full flex items-center justify-center",children:it.jsx(ae,{className:"w-5 h-5 text-white"})}),it.jsxs("div",{children:[it.jsx("p",{className:"text-white font-medium",children:e.title}),it.jsx("p",{className:"text-blue-200 text-sm",children:new Date(e.unlockedAt).toLocaleDateString()})]})]})},e.id))})]})]})})},Ll=({user:e})=>{var t,a,n,r,i,o,l,c,d,h,u,m;const[p,x]=s.useState({}),[g,f]=s.useState(!0);s.useEffect(()=>{(()=>{try{const e=JSON.parse(localStorage.getItem("mythseeker_settings")||"{}");x({soundEffects:!0,music:!1,notifications:!0,theme:"dark",fontSize:"medium",autoSave:!0,showTutorials:!0,diceRoller:{soundEnabled:!0,hapticEnabled:!0,shakeToRoll:!0,showHistory:!0},game:{autoRoll:!1,showDamageNumbers:!0,showHealthBars:!0,confirmActions:!0},...e})}catch(e){}finally{f(!1)}})()},[]);const b=(e,t,s)=>{const a={...p,[e]:{...p[e],[t]:s}};x(a),localStorage.setItem("mythseeker_settings",JSON.stringify(a))},y=(e,t)=>{const s={...p,[e]:t};x(s),localStorage.setItem("mythseeker_settings",JSON.stringify(s))};return g?it.jsx("div",{className:"flex-1 flex items-center justify-center",children:it.jsxs("div",{className:"text-center space-y-4",children:[it.jsx("div",{className:"w-8 h-8 border-4 border-blue-300/30 border-t-blue-400 rounded-full animate-spin mx-auto"}),it.jsx("p",{className:"text-blue-200",children:"Loading settings..."})]})}):it.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:it.jsxs("div",{className:"max-w-4xl mx-auto",children:[it.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[it.jsxs("div",{children:[it.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Settings"}),it.jsx("p",{className:"text-blue-200",children:"App preferences and configuration"})]}),it.jsxs("div",{className:"flex space-x-3",children:[it.jsx("button",{onClick:()=>{const e=JSON.stringify(p,null,2),t=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="mythseeker-settings.json",a.click(),URL.revokeObjectURL(s)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Export"}),it.jsxs("label",{className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors cursor-pointer",children:["Import",it.jsx("input",{type:"file",accept:".json",onChange:e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s){const e=new FileReader;e.onload=e=>{var t;try{const s=JSON.parse(null==(t=e.target)?void 0:t.result);x(s),localStorage.setItem("mythseeker_settings",JSON.stringify(s)),alert("Settings imported successfully!")}catch(s){alert("Error importing settings. Please check the file format.")}},e.readAsText(s)}},className:"hidden"})]}),it.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to reset all settings to default?")&&(localStorage.removeItem("mythseeker_settings"),window.location.reload())},className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Reset"})]})]}),it.jsxs("div",{className:"space-y-6",children:[it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Audio Settings"}),it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Sound Effects"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Enable sound effects and audio feedback"})]}),it.jsx("button",{onClick:()=>y("soundEffects",!p.soundEffects),className:"w-12 h-6 rounded-full relative transition-colors "+(p.soundEffects?"bg-blue-600":"bg-slate-600"),children:it.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 transition-transform "+(p.soundEffects?"right-1":"left-1")})})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Music"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Enable background music"})]}),it.jsx("button",{onClick:()=>y("music",!p.music),className:"w-12 h-6 rounded-full relative transition-colors "+(p.music?"bg-blue-600":"bg-slate-600"),children:it.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 transition-transform "+(p.music?"right-1":"left-1")})})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Notifications"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Show toast notifications"})]}),it.jsx("button",{onClick:()=>y("notifications",!p.notifications),className:"w-12 h-6 rounded-full relative transition-colors "+(p.notifications?"bg-blue-600":"bg-slate-600"),children:it.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 transition-transform "+(p.notifications?"right-1":"left-1")})})]})]})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Display Settings"}),it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Theme"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Choose your preferred theme"})]}),it.jsxs("select",{value:p.theme,onChange:e=>y("theme",e.target.value),className:"bg-slate-700 text-white px-3 py-2 rounded border border-slate-600",children:[it.jsx("option",{value:"dark",children:"Dark"}),it.jsx("option",{value:"light",children:"Light"}),it.jsx("option",{value:"auto",children:"Auto"})]})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Font Size"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Adjust text size for readability"})]}),it.jsxs("select",{value:p.fontSize,onChange:e=>y("fontSize",e.target.value),className:"bg-slate-700 text-white px-3 py-2 rounded border border-slate-600",children:[it.jsx("option",{value:"small",children:"Small"}),it.jsx("option",{value:"medium",children:"Medium"}),it.jsx("option",{value:"large",children:"Large"})]})]})]})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Game Settings"}),it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Auto Save"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Automatically save game progress"})]}),it.jsx("button",{onClick:()=>y("autoSave",!p.autoSave),className:"w-12 h-6 rounded-full relative transition-colors "+(p.autoSave?"bg-blue-600":"bg-slate-600"),children:it.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 transition-transform "+(p.autoSave?"right-1":"left-1")})})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Show Tutorials"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Display helpful tutorial tips"})]}),it.jsx("button",{onClick:()=>y("showTutorials",!p.showTutorials),className:"w-12 h-6 rounded-full relative transition-colors "+(p.showTutorials?"bg-blue-600":"bg-slate-600"),children:it.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 transition-transform "+(p.showTutorials?"right-1":"left-1")})})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Show Damage Numbers"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Display damage numbers in combat"})]}),it.jsx("button",{onClick:()=>{var e;return b("game","showDamageNumbers",!(null==(e=p.game)?void 0:e.showDamageNumbers))},className:"w-12 h-6 rounded-full relative transition-colors "+((null==(t=p.game)?void 0:t.showDamageNumbers)?"bg-blue-600":"bg-slate-600"),children:it.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 transition-transform "+((null==(a=p.game)?void 0:a.showDamageNumbers)?"right-1":"left-1")})})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Confirm Actions"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Ask for confirmation before important actions"})]}),it.jsx("button",{onClick:()=>{var e;return b("game","confirmActions",!(null==(e=p.game)?void 0:e.confirmActions))},className:"w-12 h-6 rounded-full relative transition-colors "+((null==(n=p.game)?void 0:n.confirmActions)?"bg-blue-600":"bg-slate-600"),children:it.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 transition-transform "+((null==(r=p.game)?void 0:r.confirmActions)?"right-1":"left-1")})})]})]})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Dice Roller Settings"}),it.jsxs("div",{className:"space-y-4",children:[it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Sound Effects"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Play sounds when rolling dice"})]}),it.jsx("button",{onClick:()=>{var e;return b("diceRoller","soundEnabled",!(null==(e=p.diceRoller)?void 0:e.soundEnabled))},className:"w-12 h-6 rounded-full relative transition-colors "+((null==(i=p.diceRoller)?void 0:i.soundEnabled)?"bg-blue-600":"bg-slate-600"),children:it.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 transition-transform "+((null==(o=p.diceRoller)?void 0:o.soundEnabled)?"right-1":"left-1")})})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Haptic Feedback"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Vibrate device when rolling dice"})]}),it.jsx("button",{onClick:()=>{var e;return b("diceRoller","hapticEnabled",!(null==(e=p.diceRoller)?void 0:e.hapticEnabled))},className:"w-12 h-6 rounded-full relative transition-colors "+((null==(l=p.diceRoller)?void 0:l.hapticEnabled)?"bg-blue-600":"bg-slate-600"),children:it.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 transition-transform "+((null==(c=p.diceRoller)?void 0:c.hapticEnabled)?"right-1":"left-1")})})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Shake to Roll"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Roll dice by shaking your device"})]}),it.jsx("button",{onClick:()=>{var e;return b("diceRoller","shakeToRoll",!(null==(e=p.diceRoller)?void 0:e.shakeToRoll))},className:"w-12 h-6 rounded-full relative transition-colors "+((null==(d=p.diceRoller)?void 0:d.shakeToRoll)?"bg-blue-600":"bg-slate-600"),children:it.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 transition-transform "+((null==(h=p.diceRoller)?void 0:h.shakeToRoll)?"right-1":"left-1")})})]}),it.jsxs("div",{className:"flex items-center justify-between",children:[it.jsxs("div",{children:[it.jsx("span",{className:"text-blue-200",children:"Show History"}),it.jsx("p",{className:"text-slate-400 text-sm",children:"Display roll history in drawer"})]}),it.jsx("button",{onClick:()=>{var e;return b("diceRoller","showHistory",!(null==(e=p.diceRoller)?void 0:e.showHistory))},className:"w-12 h-6 rounded-full relative transition-colors "+((null==(u=p.diceRoller)?void 0:u.showHistory)?"bg-blue-600":"bg-slate-600"),children:it.jsx("div",{className:"w-4 h-4 bg-white rounded-full absolute top-1 transition-transform "+((null==(m=p.diceRoller)?void 0:m.showHistory)?"right-1":"left-1")})})]})]})]})]})]})})},Ol=({user:e})=>it.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:it.jsxs("div",{className:"max-w-4xl mx-auto",children:[it.jsxs("div",{className:"mb-8",children:[it.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Help & Support"}),it.jsx("p",{className:"text-blue-200",children:"Support & documentation"})]}),it.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Getting Started"}),it.jsxs("div",{className:"space-y-3",children:[it.jsx("button",{className:"w-full text-left p-3 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition-colors",children:it.jsx("span",{className:"text-white",children:"Quick Start Guide"})}),it.jsx("button",{className:"w-full text-left p-3 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition-colors",children:it.jsx("span",{className:"text-white",children:"Character Creation"})}),it.jsx("button",{className:"w-full text-left p-3 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition-colors",children:it.jsx("span",{className:"text-white",children:"First Campaign"})})]})]}),it.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700/50",children:[it.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Support"}),it.jsxs("div",{className:"space-y-3",children:[it.jsx("button",{className:"w-full text-left p-3 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition-colors",children:it.jsx("span",{className:"text-white",children:"FAQ"})}),it.jsx("button",{className:"w-full text-left p-3 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition-colors",children:it.jsx("span",{className:"text-white",children:"Contact Support"})}),it.jsx("button",{className:"w-full text-left p-3 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition-colors",children:it.jsx("span",{className:"text-white",children:"Bug Report"})})]})]})]})]})}),$l=console.warn;console.warn=(...e)=>{const t=e[0];"string"==typeof t&&t.includes("Cross-Origin-Opener-Policy")||$l.apply(console,e)},ot.createRoot(document.getElementById("root")).render(it.jsx(i.StrictMode,{children:it.jsx(ml,{})}));export{Ci as T,Xs as U,it as j};
